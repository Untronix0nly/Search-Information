групповая политика это набор правил или настроек соответствии которыми производится настройка рабочей среды приёма передачи windows unix другие операционные системы поддержкой сети групповые политики создаются домене реплицируются рамках домена объект групповой политики состоит из двух физически раздельных составляющих контейнера групповой политики шаблона групповой политики эти два компонента содержат себе все данные параметрах рабочей среды которая включается состав объекта групповой политики продуманное применение объектов gpo объектам каталога active directory позволяет создавать эффективную легко управляемую компьютерную рабочую среду на базе ос windows политики применяются сверху вниз по иерархии каталога active directory создание групповых политик по умолчанию иерархии каталога active directory создаются две групповые политики default domain policy политика домена по умолчанию default domain controller policy политика контроллера домена по умолчанию первая из них назначается домену вторая контейнеру состав которого входит контроллер домена если вы хотите создать свой собственный объект gpo вы должны обладать необходимыми полномочиями по умолчанию правом создания новых gpo обладают группы enterprise administrators администратор предприятия domain administrators администраторы домена применение групповых политик работая групповыми политиками следует учитывать что объекты gpo применяются отношении контейнеров не замыкающих объектов один контейнер может быть связан несколькими объектами gpo объекты gpo связанные одним тем же контейнером применяются отношении этого контейнера том порядке котором они были назначены объект gpo включает себя две составляющие параметры относящиеся компьютеру параметры относящиеся пользователю обработку любой из этих составляющих можно отключить наследование объектов gpo можно блокировать наследование объектов gpo можно форсировать применение объектов gpo можно фильтровать при помощи списков acl разрешение конфликта двух политик представьте что некоторый параметр например logon banner графическая заставка при подключении определён как политике так политике при этом значение параметра заданное политике отличается от значения заданного политике какое значение будет присвоено параметру результате применения обеих этих политик подобной ситуации параметру объекта присваивается значение извлеченное из gpo который находится объекту ближе всего таким образом рассмотренной ситуации параметру logon banner будет присвоено значение извлеченное из политики наследование политик представьте что политика содержит себе значение параметра logon banner то время как политика не определяет этого параметра этом случае если отношении объекта применяются обе эти политики параметру объекта будет присвоено значение из политики однако для контейнера sa не определено ни одной политики все же параметру logon banner этого контейнера будет присвоено значение из политики мало того отношении этого контейнера будут полной мере применены политики так как контейнер sa унаследует эти политики от своих родителей применение нескольких политик отношении одного контейнера представьте что политики которых определяются значения самых разнообразных параметров применены отношении контейнера acct разделе конфигурации компьютера политики членам глобальной группы accounting бухгалтерия разрешается локально подключаться любому компьютеру контейнере acct также во всех подконтейнерах этого контейнера разделе конфигурации компьютера политики права группе accounting бухгалтерия не назначаются списке политик отображаемом на странице group policy групповая политика окне свойств контроллера домена политика располагается самом верху списка выше политики политики указанные этом списке применяются объекту порядке снизу вверх другими словами политики расположенные внизу списка применяются первую очередь после чего применяются политики расположенные выше по списку таким образом при обработке набора политик отношении контейнера acct вначале будет применена политика затем политика следовательно после обработки набора политик параметр прав на локальное подключение системе будет содержать значение из политики таким образом члены глобальной группы accounting бухгалтерия не будут обладать правом локального подключения компьютерам контейнера acct его подконтейнеров чтобы изменить порядок обработки политик следует воспользоваться кнопками up вверх down вниз правом нижнем углу вкладки group policy групповая политика windows позволяет блокировать применение некоторых разделов объекта gpo если политика применяется отношении контейнера не полностью только частично общее время подключения пользователя системе уменьшается чем меньшее количество параметров gpo следует применить отношении того или иного объекта тем быстрее выполняется обработка соответствующей политики отключение обработки некоторых разделов политики можно выполнить отдельно для каждого из объектов gpo для этого следует выполнить следующие действия откройте оснастку active directory users and computers active directory пользователи компьютеры наведите указатель на интересующий вас контейнер откройте окно свойств этого контейнера перейдите на вкладку group policy групповая политика выберите объект gpo который вы намерены модифицировать щелкните на кнопке properties свойства здесь вы можете блокировать применение отношении контейнера параметров политики относящихся конфигурации компьютера или конфигурации пользователя после того как вы указали применение какого из разделов gpo должно быть блокировано на экране появится сообщение том что значения параметров благодаря данной политике будут восстановлены изначальное состояние например если блокировать применение параметров gpo относящихся конфигурации пользователя то конфигурация всех пользователей отношении которых действует данная политика будет восстановлена состояние котором она была до применения данной политики отличие от windows операционная система nt выполняла очистку политик некорректно связи этим nt даже после отмены политики параметры объектов сохраняли значения присвоенные им процессе применения отмененной политики блокирование применения одного из разделов политики настраивается для конкретного объекта gpo действует отношении всех контейнеров для которых назначен этот gpo блокирование наследования политики windows позволяет блокировать наследование политики от родительского объекта например если вы хотите чтобы отношении контейнера it всех его подконтейнеров действовали только политики определённые на уровне it на странице group policy групповая политика свойств объекта it установите флажок block policy inheritance блокировать наследование политики при этом политики не будут применяться отношении контейнеров it workstations it servers блокирование наследования политик нельзя отключить для какой либо одной политики если для какого либо контейнера включено блокирование наследования политик отношении этого контейнера всех его подконтейнеров перестают действовать абсолютно все политики назначенные на более высоких уровнях иерархии каталога active directory этот параметр может быть настроен отдельно для конкретного объекта gpo действует отношении всех контейнеров для которых назначен этот gpo если для объекта gpo установлен флажок no override не отменять значения параметров из соответствующей политики всегда будут обладать большим приоритетом при возникновении конфликтов политик вне зависимости от того на каком уровне иерархии расположены контейнеры которым применяется данный gpo например если вы откроете окно свойств домена shinyapple msft установите флажок no override не отменять для политики объекты расположенные ниже по иерархии active directory всегда будут настроены соответствии со значениями заданными политике при возникновении конфликта политик значениям из будет отдано предпочтение хорошим примером ситуации которой может потребоваться использование данной возможности является применение параметров безопасности если для какого либо контейнера включено блокирование наследования политик политика обладающая свойством no override не отменять все равно будет применена так как параметр no override не отменять обладает большим приоритетом фильтрация политик фильтрация применяемых политик на основе членства объектов группах безопасности является ещё одним методом изменения обычного порядка применения политик отношении объектов active directory фильтрация осуществляется при помощи списков acl access control list каждому объекту gpo ставится соответствие список acl информация из списка acl объекта gpo анализируется системой безопасности вне зависимости от того какому из контейнеров применяется данный gpo политика применяется отношении объекта только том случае если объект обладает отношении gpo разрешениями read чтение apply group policy применение групповой политики если объект пользователь или группа не обладает разрешением apply group policy применение групповой политики политика группы его отношении не применяется отладка процесса обработки политик профилей чтобы журнале которой применяются политики профили следует при помощи редактора реестра добавить ключ software microsoft windowsnt currentversion winlogon значение типа reg_dword которое должно быть равно после этого перезапустите компьютер журнал применения политик профилей будет записан файл systemroot debug usermode userenv log помимо объектов gpo существующих каталоге active directory каждой системе windows существует также локальная политика local policy локальная политика определяет параметры соответствии которыми настраивается рабочая станция система применяет политики определённом порядке сначала применяется локальная политика local policy затем политика узла site policy затем доменная политика domain policy наконец политика контейнера ou organizational unit policy порядок применения политик часто обозначают символов ou если локальная политика конфликтует политикой узла домена или контейнера ou она всегда проигрывает другими словами процессе применения политик локальная политика обладает наименьшим приоритетом все параметры за исключением сценариев подключения начала работы системы отключения завершения работы системы также установки программного обеспечения либо назначенного либо опубликованного обновляются каждые минут переменным смещением плюс минус минут обновление осуществляется по инициативе механизма обновления групповых политик работающего на стороне клиента который следит за тем когда клиент последний раз выполнял обновление начале процесса обновления порядковые номера версий всех действующих политик сравниваются локальными номерами версий если локальный удаленный номера версий не совпадают заново применяется вся политика противном случае никакого обновления не происходит обновление политик действующих отношении контроллеров доменов выполняется каждые пять минут клиенты которые могут использовать групповую политику процессе перехода на использование windows вашей сети наверняка будут присутствовать компьютеры оснащенные более ранними версиями windows чтобы эффективно управлять такой сетью важно понимать отношении каких компьютеров будет действовать групповая политика далее перечисляются операционные системы отношении которых действует групповая политика windows server компьютеры оснащенные операционной системой windows server могут быть либо обычными членами домена active directory либо контроллерами домена групповая политика полной мере применяется обеим разновидностям серверов windows xp professional групповая политика полной мере применяется отношении клиентских компьютеров оснащенных windows professional windows nt workstation server отношении таких компьютеров можно применить только системные политики стиле nt для создания таких политик используется редактор poledit exe при помощи poledit exe администратор может создавать файлы adm windows nt не поддерживает active directory не использует объектов локальной политики поэтому отношении компьютеров оснащенных этой операционной системой групповая политика не применяется windows windows для создания системной политики операционных системах windows windows используется специальный редактор системной политики получившийся результате редактирования файл расширением pol следует скопировать каталог sysvol редакторы системной политики входящие комплект windows windows nt не совместимы windows windows групповая политика windows отношении таких компьютеров не применяется windows nt windows dos групповая политика не применяется сценарии подключения отключения операционная система windows nt позволяет назначить каждому пользователю сценарий содержащий команды которые необходимо выполнить при подключении данного пользователя системе обычно сценарии подключения используются для начальной настройки рабочего окружения помимо сценариев подключения windows поддерживает также сценарии отключения мало того новой операционной системе для каждого компьютера можно назначить сценарии начала завершения работы системы система исполнения сценариев windows scripting host wsh поддерживает исполнение сценариев написанных на таких языках как visual basic или jscript позволяющих напрямую обращаться функциям windows api рассмотрим некоторые возможности связанные использованием сценариев среде windows сценарии определённые рамках объекта такие сценарии поддерживаются точности так же как это было windows nt существуют основном для обеспечения совместимости windows ранних версий клиенты windows windows nt пытаются обнаружить такие сценарии общей папке netlogon сервера если обнаружить сценарий не удалось поиск производится каталоге systemroot system repl lmport scripts расположение сценариев используемое nt общая папка netlogon располагается каталоге sysvol sysvol имя домена scripts автоматически реплицируется службой frs репликация каталога сценариев операционной системы nt должна быть настроена вручную сценарии определённые рамках групповой политики эти сценарии применяются отношении контейнеров ou иными словами чтобы назначить пользователю сценарий подключения или отключения следует сделать пользователя членом контейнера ou для которого определена политика рамках которой назначен сценарий подключения или отключения этот метод является более гибким если вы переводите свою сеть на использование windows вы также должны учитывать некоторые другие особенности связанные со сценариями во многих сетях наряду машинами windows используются компьютеры оснащенные более ранними версиями windows по этой причине рекомендуется выполнять обновление сервера содержащего общую папку netlogon последнюю очередь это связано тем что служба репликации используемая windows frs не совместима со службами репликации nt таким образом обновляя сеть вы должны быть уверены том что абсолютно все клиенты имеют возможность доступа папке netlogon сценариям подключения вне зависимости от того какую операционную систему они используют следует также учитывать что windows nt сценарии подключения работают контексте безопасности пользователя windows это справедливо лишь отчасти windows сценарии имеющие отношение пользователю подключения системе отключения от системы также выполняются контексте безопасности пользователя то время как сценарии имеющие отношение компьютеру начала работы системы завершения работы системы выполняются контексте безопасности localsystem делегирование прав на групповых политик возможность управления объектами gpo можно делегировать другим ответственным лицам делегирование осуществляется при помощи списков acl списки acl объекта gpo позволяют назначить отношении этого объекта разрешения на модификацию этого gpo или на назначение gpo отношении некоторого контейнера таким образом можно запретить создание объектов gpo например создание модификацию gpo можно доверить группе администраторов домена то время как назначение этих gpo могут осуществлять администраторы отдельных контейнеров ou администратор контейнера ou может выбрать наиболее подходящий объект gpo применить этот gpo отношении любого из подконтрольных ему ou однако при этом он не сможет изменить содержимое этого gpo или создать новый gpo управление документами кэшированием на стороне клиента групповая политика позволяет перенаправлять некоторые каталоги таким образом чтобы при обращении ним пользователь на самом деле обращался сетевым каталогам или определённым местам локальной файловой системы набор папок которые можно перенаправить таким образом включает себя application data desktop рабочий стол my documents мои документы my pictures мои рисунки start menu главное меню механизм перенаправления папок является частью технологии intellimirror цель которой обеспечить доступ рабочим файлам информации вне зависимости от того какую рабочую станцию пользователь использует для работы как следствие технология intellimirror обеспечивает сохранность файлов данных случае если рабочая станция пользователя выходит из строя перенаправление каталогов настраивается разделе user configuration конфигурация пользователя windows settings параметры windows folder redirection перенаправление папок объекта групповой политики этом разделе отображаются все ранее перечисленные папки чтобы перенаправить одну из этих папок новое место правой кнопкой мыши щелкните на её имени появившемся меню выберите пункт properties свойства на вкладке target цель вы можете выбрать один из трех вариантов перенаправления папки no administrative policy specified политика не назначена basic базовый перенаправляет папку новое место вне зависимости от того какой группе принадлежит пользователь новое место должно быть указано использованием формата unc при указании нового места можно использовать такие переменные как username таким образом для разных пользователей папка может быть перенаправлена разные каталоги однако все эти каталоги должны располагаться одной той же сетевой папке общего доступа advanced усложненный для разных групп пользователей можно указать разные местоположения папки для разных групп можно указать различные unc имена соответствующие папки могут располагаться на разных серверах ссылки раздел групповой политики на microsoft technet group policy management console бесплатная программа от microsoft для управления групповой политикой категория active directory категория компоненты windows категория windows