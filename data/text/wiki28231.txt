active directory активный каталог ad службы каталогов корпорации microsoft для операционных систем семейства windows server первоначально создавалась как ldap совместимая реализация службы каталогов однако начиная windows server включает возможности интеграции другими службами авторизации выполняя для них интегрирующую объединяющую роль позволяет администраторам использовать групповые политики для обеспечения единообразия настройки рабочей среды разворачивать программное обеспечение на множестве компьютеров через групповые политики или посредством system center configuration manager ранее microsoft systems management server устанавливать обновления операционной системы прикладного серверного программного обеспечения на всех компьютерах сети используя службу обновления windows server хранит данные настройки среды базе данных сети active directory могут быть различного размера от нескольких десятков до нескольких миллионов объектов представление решения состоялось году впервые продукт был выпущен вместе windows server затем развит рамках выпуска windows server впоследствии новые версии продукта вошли windows server windows server windows server переименован active directory domain services ранее служба каталогов называлась nt directory service ntds это название до сих пор можно встретить некоторых исполняемых файлах отличие от версий windows до windows которые использовали основном протокол netbios для сетевого взаимодействия служба active directory интегрирована dns работает только поверх tcp ip для аутентификации по умолчанию используется протокол kerberos если клиент или приложение не поддерживает kerberos аутентификацию используется протокол ntlm для разработчиков программного обеспечения предоставляется программный интерфейс доступа службам active directory adsi устройство объекты active directory имеет иерархическую структуру состоящую из объектов объекты разделяются на три основные категории ресурсы например принтеры службы например электронная почта учётные записи пользователей компьютеров служба предоставляет информацию об объектах позволяет организовывать объекты управлять доступом ним также устанавливает правила безопасности объекты могут быть хранилищами для других объектов группы безопасности распространения объект уникально определяется своим именем имеет набор атрибутов характеристик данных которые он может содержать последние свою очередь зависят от типа объекта атрибуты являются составляющей базой структуры объекта определяются схеме схема определяет какие типы объектов могут существовать сама схема состоит из двух типов объектов объекты классов схемы объекты атрибутов схемы один объект класса схемы определяет один тип объекта active directory например объект пользователь один объект атрибута схемы определяет атрибут который объект может иметь каждый объект атрибута может быть использован нескольких разных объектах классов схемы эти объекты называются объектами схемы или метаданными позволяют изменять дополнять схему когда это необходимо возможно однако каждый объект схемы является частью определений объектов поэтому отключение или изменение этих объектов могут иметь серьёзные последствия так как результате этих действий будет изменена структура каталогов изменение объекта схемы автоматически службе каталогов будучи однажды созданным объект схемы не может быть удалён он может быть только отключён обычно все изменения схемы тщательно планируются контейнер аналогичен объекту том смысле что он также имеет атрибуты принадлежит пространству имён но отличие от объекта контейнер не обозначает ничего конкретного он может содержать группу объектов или другие контейнеры структура верхним уровнем структуры является лес совокупность всех объектов атрибутов правил синтаксиса атрибутов active directory лес содержит одно или несколько деревьев связанных транзитивными отношениями доверия дерево содержит один или несколько доменов также связанных иерархию транзитивными отношениями доверия домены своими структурами имён dns пространствами имён объекты домене могут быть сгруппированы контейнеры подразделения подразделения позволяют создавать иерархию внутри домена упрощают его позволяют моделировать например организационную или географическую структуру организации службе каталогов подразделения могут содержать другие подразделения microsoft рекомендует использовать как можно меньше доменов службе каталогов для политик использовать подразделения часто групповые политики применяются именно подразделениям групповые политики сами являются объектами подразделение является самым низким уровнем на котором могут делегироваться полномочия другим способом деления являются сайты которые являются способом физической не логической группировки на основе сегментов сети сайты подразделяются на имеющие подключения по низкоскоростным каналам например по каналам глобальных сетей помощью виртуальных частных сетей по каналам например через локальную сеть сайт может содержать один или несколько доменов домен может содержать один или несколько сайтов при проектировании службы каталогов важно учитывать сетевой трафик создающийся при синхронизации данных между сайтами ключевым решением при проектировании службы каталогов является решение разделении информационной инфраструктуры на иерархические домены подразделения верхнего уровня типичными моделями используемыми для такого разделения являются модели разделения по функциональным подразделениям компании по географическому положению по ролям информационной инфраструктуре компании часто используются комбинации этих моделей физическая структура репликация физически информация хранится на одном или нескольких равнозначных контроллерах доменов заменивших windows nt основной резервные контроллеры домена хотя для выполнения некоторых операций сохраняется так называемый сервер операций одним главным сервером который может эмулировать главный контроллер домена каждый контроллер домена хранит копию данных предназначенную для чтения записи изменения сделанные на одном контроллере на все контроллеры домена при репликации серверы на которых сама служба active directory не установлена но которые при этом входят домен active directory называются рядовыми серверами репликация каталога выполняется по запросу служба kcc knowledge consistency checker создаёт топологию репликации которая использует сайты определённые системе для управления трафиком внутрисайтовая репликация выполняется часто автоматически помощью средства проверки согласованности уведомлением партнёров по репликации об изменениях репликация между сайтами может быть настроена для каждого канала сайта зависимости от качества канала различная оценка или стоимость может быть назначена каждому каналу например ds isdn трафик репликации будет ограничен передаваться по расписанию соответствии назначенной оценкой канала данные репликации могут транзитом передаваться через несколько сайтов через мосты связи сайтов если оценка низка хотя ad автоматически назначает более низкую оценку для связей сайт сайт чем для транзитных соединений репликация сайт сайт выполняется серверами плацдармами каждом сайте которые затем реплицируют изменения на каждый контроллер домена своего сайта внутридоменная репликация проходит по протоколу rpc междоменная может использовать также протокол smtp если структура active directory содержит несколько доменов для решения задачи поиска объектов используется глобальный каталог контроллер домена содержащий все объекты леса но ограниченным набором атрибутов неполная реплика каталог хранится на указанных серверах глобального каталога обслуживает междоменные запросы возможность операций одним главным компьютером позволяет обрабатывать запросы когда репликация несколькими главными компьютерами недопустима есть пять типов таких операций эмуляция главного контроллера домена pdc эмулятор главный компьютер относительного идентификатора мастер относительных идентификаторов или rid мастер главный компьютер инфраструктуры мастер инфраструктуры главный компьютер схемы мастер схемы главный компьютер именования домена мастер именования доменов первые три роли уникальны рамках домена последние две уникальны рамках всего леса базу active directory можно разделить на три логических хранилища или раздела схема является шаблоном для службы определяет все типы объектов их классы атрибуты синтаксис атрибутов все деревья находятся одном лесу потому что них одна схема конфигурация является структурой леса деревьев active directory домен хранит всю информацию об объектах созданных этом домене первые два хранилища реплицируются на все контроллеры доменов лесу третий раздел полностью реплицируется между репликами контроллеров рамках каждого домена частично на сервера глобального каталога база данных хранилище каталогов windows использует расширяемую подсистему хранения которая позволяет для каждого контроллера домена иметь базу размером до терабайт миллиард объектов теоретическое ограничение практические тесты выполнялись только приблизительно миллионами объектов файл базы называется ntds dit имеет две основные таблицы таблицу данных таблицу связей windows server добавлена ещё одна таблица для обеспечения уникальности экземпляров дескрипторов безопасности именование служба поддерживает следующие форматы именования объектов универсальные имена типа unc url ldap url версия ldap формата именования используется внутри службы каждый объект имеет выделенное имя dn например объект принтера именем hplaser подразделении маркетинг домене foo org будет иметь следующее выделенное имя cn hplaser ou маркетинг dc foo dc org где cn это общее имя ou раздел dc класс объекта домена выделенные имена могут иметь намного больше частей чем четыре части этом примере объектов также есть канонические имена это различающиеся имена записанные обратном порядке без идентификаторов использованием косых черт качестве разделителей foo org маркетинг hplaser чтобы определить объект внутри его контейнера используется относительное выделенное имя cn hplaser каждого объекта также есть глобально уникальный идентификатор guid уникальная неизменная битная строка которая используется active directory для поиска репликации определённые объекты также имеют имя участника пользователя upn соответствии rfc формате объект домен интеграция unix различные уровни взаимодействия active directory могут быть реализованы большинстве unix подобных операционных систем посредством ldap клиентов но такие системы как правило не воспринимают большую часть атрибутов ассоциированных компонентами windows например групповые политики поддержку односторонних доверенностей однако выходом samba появилась возможность использовать групповые политики инструменты windows сторонние поставщики предлагают интеграцию active directory на платформах unix linux mac os ряд приложений на java среди них продукты корпорации directcontrol express unab computer associates trustbroker cybersafe powerbroker identity services beyondtrust authentication services quest software admitmac thursby сервер samba пакета программ powerbroker identity services совместимости сетевыми службами microsoft может выполнять роль контроллера домена добавления схему поставляемые windows server включают атрибуты которые достаточно тесно связаны rfc чтобы использоваться общем случае базовые реализации rfc nss_ldap pam_ldap предложенные padl com непосредственно поддерживают эти атрибуты стандартная схема для членства группе соответствует rfc bis предлагаемому windows server включает консоль управления microsoft для создания редактирования атрибутов альтернативным вариантом является использование другой службы каталогов например directory server ранее fedora directory server fds eb bcom viewds или выполняющих двухстороннюю синхронизацию active directory реализуя таким образом отражённую интеграцию когда клиенты unix linux систем на собственных серверах клиенты windows active directory другим вариантом является использование openldap возможностью полупрозрачного перекрытия расширяющей элементы удалённого сервера ldap дополнительными атрибутами хранимыми локальной базе данных active directory помощью powershell примечания литература ссылки веб страница microsoft active directory windows internet naming service категория серверы каталогов