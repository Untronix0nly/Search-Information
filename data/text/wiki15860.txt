численное интегрирование историческое название численная квадратура вычисление значения определённого интеграла как правило приближённое под численным интегрированием понимают набор численных методов для нахождения значения определённого интеграла численное интегрирование применяется когда сама подынтегральная функция не задана аналитически например она представлена виде таблицы массива значений узлах некоторой расчётной сетки аналитическое представление подынтегральной функции известно но её первообразная не выражается через аналитические функции например этих двух случаях невозможно вычисление интеграла по формуле ньютона лейбница также возможна ситуация когда вид первообразной настолько сложен что быстрее вычислить значение интеграла численным методом одномерный случай файл integral as region under curve svg thumb px одномерный определённый интеграл как площадь криволинейной трапеции под графиком основная идея большинства методов численного интегрирования состоит замене подынтегральной функции на более простую интеграл от которой легко вычисляется аналитически при этом для оценки значения интеграла получаются формулы вида где число точек которых вычисляется значение подынтегральной функции точки называются узлами метода числа весами узлов при замене подынтегральной функции на полином нулевой первой второй степени получаются соответственно методы прямоугольников трапеций парабол симпсона часто формулы для оценки значения интеграла называют квадратурными формулами частным случаем является метод построения интегральных квадратурных формул для равномерных сеток известный как формулы котеса метод назван честь роджера котса основной идеей метода является замена подынтегральной функции каким либо многочленом после взятия интеграла можно написать где числа называются коэффициентами котеса вычисляются как интегралы от соответствующих многочленов стоящих исходном многочлене для подынтегральной функции при значении функции узле шаг сетки число узлов сетки индекс узлов слагаемое погрешность метода которая может быть найдена разными способами для нечетных погрешность может быть найдена интегрированием погрешности полинома подынтегральной функции частными случаями формул котеса являются формулы прямоугольников формулы трапеций формула симпсона формула ньютона метод прямоугольников пусть требуется определить значение интеграла функции на отрезке этот отрезок делится точками на равных отрезков длиной обозначим через значение функции точках далее составляем суммы каждая из сумм интегральная сумма для на поэтому приближённо выражает интеграл если заданная функция положительная возрастающая то эта формула выражает площадь ступенчатой фигуры составленной из входящих прямоугольников также называемая формулой левых прямоугольников формула выражает площадь ступенчатой фигуры состоящей из выходящих прямоугольников также называемая формулой правых прямоугольников чем меньше длина отрезков на которые делится отрезок тем точнее значение вычисляемое по этой формуле искомого интеграла очевидно стоит рассчитывать на бо льшую точность если брать качестве опорной точки для нахождения высоты точку посередине промежутка результате получаем формулу средних прямоугольников где учитывая априорно бо льшую точность последней формулы при том же объёме характере вычислений её называют формулой прямоугольников метод трапеций если функцию на каждом из частичных отрезков прямой проходящей через конечные значения то получим метод трапеций площадь трапеции на каждом отрезке погрешность аппроксимации на каждом отрезке где полная формула трапеций случае деления всего промежутка интегрирования на отрезки одинаковой длины где погрешность формулы трапеций где метод парабол метод симпсона использовав три точки отрезка интегрирования можно заменить подынтегральную функцию параболой обычно качестве таких точек используют концы отрезка его среднюю точку этом случае формула имеет очень простой вид если разбить интервал интегрирования на равных частей то имеем где увеличение точности приближение функции одним полиномом на всем отрезке интегрирования как правило приводит большой ошибке оценке значения интеграла для уменьшения погрешности отрезок интегрирования разбивают на части применяют численный метод для оценки интеграла на каждой из них при стремлении количества разбиений бесконечности оценка интеграла стремится его истинному значению для аналитических функций для любого численного метода приведённые выше методы допускают простую процедуру уменьшения шага два раза при этом на каждом шаге требуется вычислять значения функции только во вновь добавленных узлах для оценки погрешности вычислений используется правило рунге метод гаусса описанные выше методы используют фиксированные точки отрезка концы середину имеют низкий порядок точности методы правых левых прямоугольников методы средних прямоугольников трапеций метод парабол симпсона если мы можем выбирать точки которых мы вычисляем значения функции то можно при том же количестве вычислений подынтегральной функции получить методы более высокого порядка точности так для двух как методе трапеций вычислений значений подынтегральной функции можно получить метод уже не второго третьего порядка точности общем случае используя точек по формуле можно получить метод порядком точности получаются точные значения для полиномов степени не выше значения узлов метода гаусса по точкам являются корнями полинома лежандра степени значения весов вычисляются по формуле где первая производная полинома лежандра для узлы веса имеют следующие значения веса полином определен на отрезке наиболее известен метод гаусса по пяти точкам метод гаусса кронрода недостаток метода гаусса состоит том что он не имеет лёгкого вычислительной точки зрения пути оценки погрешности полученного значения интеграла использование правила рунге требует вычисления подынтегральной функции примерно таком же числе точек не давая при этом практически никакого выигрыша точности отличие от простых методов где точность увеличивается несколько раз при каждом новом разбиении кронродом был предложен следующий метод оценки значения интеграла где узлы метода гаусса по точкам параметров подобраны таким образом чтобы порядок точности метода был равен тогда для оценки погрешности можно использовать эмпирическую формулу где приближённое значение интеграла полученное методом гаусса по точкам библиотеки gsl slatec для вычисления определённых интегралов содержат подпрограммы использующие метод гаусса кронрода по точкам библиотека alglib использует метод гаусса кронрода по точкам метод чебышёва интегрирование при бесконечных пределах для интегрирования по бесконечным пределам нужно ввести неравномерную сетку шаги которой нарастают при стремлении бесконечности либо можно сделать такую замену переменных интеграле после которой пределы будут конечны аналогичным образом можно поступить если функция особая на концах отрезка интегрирования см том числе метод самокиша методы монте карло рисунок численное интегрирование функции методом монте карло для определения площади под графиком функции можно использовать следующий стохастический алгоритм ограничим функцию прямоугольником мерным случае многих измерений площадь которого можно легко вычислить набросаем этот прямоугольник параллелепипед некоторое количество точек штук координаты которых будем выбирать случайным образом определим число точек штук которые попадут под график функции площадь области ограниченной функцией осями координат даётся выражением этот алгоритм требует определения экстремумов функции на интервале не использует вычисленное точное значение функции кроме как сравнении вследствие чего непригоден для практики приведённые основной статье варианты метода монте карло избавлены от этих недостатков для малого числа измерений интегрируемой функции монте карло интегрирования гораздо ниже чем методов тем не менее некоторых случаях когда функция задана неявно необходимо определить область заданную виде сложных неравенств стохастический метод может оказаться более методы рунге кутты ме тоды ру нге ку тты важное семейство численных алгоритмов решения обыкновенных уравнений их систем итеративные методы явного неявного приближённого вычисления разработанные около года немецкими математиками рунге куттой метод сплайнов многомерный случай файл numerical integration tetrahedron points png thumb пример узлов интегрирования на тетраэдре небольших размерностях можно так же применять квадратурные формулы основанные на многочленах интегрирование производится аналогично одномерному интегрированию для больших размерностей эти методы становятся неприемлемыми из за быстрого возрастания числа точек сетки или сложной границы области этом случае применяется метод монте карло генерируются случайные точки нашей области усредняются значения функции них так же можно использовать смешанный подход разбить область на несколько частей каждой из которых или только тех где интеграл посчитать не удаётся из за сложной границы применить метод монте карло примеры реализации ниже приведена реализация python метода симпсона метода средних прямоугольников метода монте карло метода средних трапеций from matplotlib import mlab import math random def get_i return math math def func mim_lim max_lim delta def integrate func mim_lim max_lim integral step max_lim mim_lim for in mlab frange mim_lim max_lim step step integral step func step return integral while math fabs delta integrate func mim_lim max_lim integrate func mim_lim max_lim print rect print join str str math fabs integrate func mim_lim max_lim str math fabs integrate func mim_lim max_lim def func mim_lim max_lim delta def integrate func mim_lim max_lim integral step max_lim mim_lim for in mlab frange mim_lim max_lim step step integral step func func step return integral while math fabs delta integrate func mim_lim max_lim integrate func mim_lim max_lim print rect print join str str math fabs integrate func mim_lim max_lim str math fabs integrate func mim_lim max_lim def simpson_method func mim_lim max_lim delta def integrate func mim_lim max_lim integral step max_lim mim_lim for in mlab frange mim_lim step max_lim step step integral step func step func func step return integral while math fabs delta integrate func mim_lim max_lim integrate func mim_lim max_lim print rect print join str str math fabs integrate func mim_lim max_lim str math fabs integrate func mim_lim max_lim def func in_d out_d for in range random uniform random uniform if литература болтачев численные методы теплофизике курс лекций лекция численное интегрирование см также численное вычислительные методы список квадратурных формул категория численное интегрирование