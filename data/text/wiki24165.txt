межсетевой экран на границе сетевого периметра межсетево экра сетево экра программный или программно аппаратный элемент компьютерной сети осуществляющий контроль фильтрацию проходящего через него сетевого трафика соответствии заданными правилами другие названия брандма уэр противопожарная стена заимствованный из немецкого языка термин файрво противопожарная стена заимствованный из английского языка термин назначение среди задач которые решают межсетевые экраны основной является защита сегментов сети или отдельных хостов от доступа использованием уязвимых мест протоколах сетевой модели osi или программном обеспечении установленном на компьютерах сети межсетевые экраны пропускают или запрещают трафик сравнивая его характеристики заданными шаблонами наиболее место для установки межсетевых экранов граница периметра локальной сети для защиты внутренних хостов от атак извне однако атаки могут начинаться внутренних узлов этом случае если атакуемый хост расположен той же сети трафик не пересечёт границу сетевого периметра межсетевой экран не будет задействован поэтому настоящее время межсетевые экраны размещают не только на границе но между различными сегментами сети что обеспечивает дополнительный уровень безопасности история первые устройства выполняющие функцию фильтрации сетевого трафика появились конце когда интернет был новшеством не использовался глобальных масштабах этими устройствами были маршрутизаторы инспектирующие трафик на основании данных содержащихся заголовках протоколов сетевого уровня впоследствии развитием сетевых технологий данные устройства получили возможность выполнять фильтрацию трафика используя данные протоколов более высокого транспортного уровня маршрутизаторы можно считать первой программно аппаратной реализацией межсетевого экрана программные межсетевые экраны появились существенно позже были гораздо моложе чем антивирусные программы например проект netfilter iptables один из первых программных межсетевых экранов встраиваемых ядро linux версии был основан году такое позднее появление вполне объяснимо так как долгое время антивирус решал проблему защиты персональных компьютеров от вредоносных программ однако конце вирусы стали активно использовать отсутствие межсетевых экранов на компьютерах что привело повышению интереса пользователей данному классу устройств фильтрация трафика фильтрация трафика осуществляется на основе набора предварительно правил которые называются ruleset удобно представлять межсетевой экран как фильтров обрабатывающих информационный поток каждый из фильтров предназначен для интерпретации отдельного правила правил наборе существенно влияет на межсетевого экрана например многие межсетевые экраны последовательно сравнивают трафик правилами до тех пор пока не будет найдено соответствие для таких межсетевых экранов правила которые соответствуют наибольшему количеству трафика следует располагать как можно выше списке увеличивая тем самым существует два принципа обработки поступающего трафика первый принцип гласит что явно не запрещено то разрешено данном случае если межсетевой экран получил пакет не попадающий ни под одно правило то он передаётся далее противоположный принцип что явно не разрешено то запрещено гарантирует гораздо большую защищённость так как он запрещает весь трафик который явно не разрешён правилами однако этот принцип оборачивается дополнительной нагрузкой на администратора конечном счёте межсетевые экраны выполняют над поступающим трафиком одну из двух операций пропустить пакет далее allow или отбросить пакет deny некоторые межсетевые экраны имеют ещё одну операцию reject при которой пакет отбрасывается но отправителю сообщается недоступности сервиса доступ которому он пытался получить противовес этому при операции deny отправитель не информируется недоступности сервиса что является более безопасным классификация межсетевых экранов схематическое изображение классификации межсетевых экранов на основе сетевой модели osi до сих пор не существует единой общепризнанной классификации межсетевых экранов однако большинстве случаев поддерживаемый уровень сетевой модели osi является основной характеристикой при их классификации учитывая данную модель различают следующие типы межсетевых экранов управляемые коммутаторы пакетные фильтры шлюзы сеансового уровня посредники прикладного уровня инспекторы состояния управляемые коммутаторы управляемые коммутаторы иногда причисляют классу межсетевых экранов так как они осуществляют фильтрацию трафика между сетями или узлами сети однако они работают на канальном уровне разделяют трафик рамках локальной сети значит не могут быть использованы для обработки трафика из внешних сетей например из интернета многие производители сетевого оборудования такие как cisco nortel com zyxel предоставляют своих коммутаторах возможность фильтрации трафика на основе mac адресов содержащихся заголовках фреймов например коммутаторах семейства cisco catalyst эта возможность реализована при помощи механизма port security однако данный метод фильтрации не является эффективным так как аппаратно установленный сетевой карте mac адрес легко меняется программным путем поскольку значение указанное через драйвер имеет более высокий приоритет чем зашитое плату поэтому многие современные коммутаторы позволяют использовать другие параметры качестве признака фильтрации например vlan id технология виртуальных локальных сетей позволяет создавать группы хостов трафик которых полностью изолирован от других узлов сети при реализации политики безопасности рамках корпоративной сети основу которых составляют управляемые коммутаторы они могут быть мощным достаточно дешёвым решением взаимодействуя только протоколами канального уровня такие межсетевые экраны фильтруют трафик очень высокой скоростью основным недостатком такого решения является невозможность анализа протоколов более высоких уровней пакетные фильтры пакетные фильтры функционируют на сетевом уровне контролируют прохождение трафика на основе информации содержащейся заголовке пакетов многие межсетевые экраны данного типа могут оперировать заголовками протоколов более высокого транспортного уровня например tcp или udp пакетные фильтры одними из первых появились на рынке межсетевых экранов по сей день остаются самым их типом данная технология реализована подавляющем большинстве маршрутизаторов даже некоторых коммутаторах при анализе заголовка сетевого пакета могут использоваться следующие параметры ip адреса источника получателя тип транспортного протокола поля служебных заголовков протоколов сетевого транспортного уровней порт источника получателя достаточно часто приходится фильтровать пакеты что затрудняет определение некоторых атак многие сетевые атаки используют данную уязвимость межсетевых экранов выдавая пакеты содержащие запрещённые данные за фрагменты другого доверенного пакета одним из способов борьбы данным типом атак является межсетевого экрана таким образом чтобы блокировать пакеты некоторые межсетевые экраны могут пакеты перед пересылкой во внутреннюю сеть но это требует дополнительных ресурсов самого межсетевого экрана особенно памяти дефрагментация должна использоваться очень обоснованно иначе такой межсетевой экран легко может сам стать жертвой dos атаки пакетные фильтры могут быть реализованы следующих компонентах сетевой инфраструктуры пограничные маршрутизаторы операционные системы персональные межсетевые экраны так как пакетные фильтры обычно проверяют данные только заголовках сетевого транспортного уровней они могут выполнять это достаточно быстро поэтому пакетные фильтры встроенные пограничные маршрутизаторы идеальны для размещения на границе сетью низкой степенью доверия однако пакетных фильтрах отсутствует возможность анализа протоколов более высоких уровней сетевой модели osi кроме того пакетные фильтры обычно уязвимы для атак которые используют подделку сетевого адреса такие атаки обычно выполняются для обхода управления доступом осуществляемого межсетевым экраном шлюзы сеансового уровня межсетевой экран сеансового уровня исключает прямое взаимодействие внешних хостов узлом расположенным локальной сети выступая качестве посредника который реагирует на все входящие пакеты проверяет их допустимость на основании текущей фазы соединения шлюз сеансового уровня гарантирует что ни один сетевой пакет не будет пропущен если он не принадлежит ранее установленному соединению как только приходит запрос на установление соединения специальную таблицу помещается соответствующая информация адреса отправителя получателя используемые протоколы сетевого транспортного уровня состояние соединения случае если соединение установлено пакеты передаваемые рамках данной сессии будут просто копироваться локальную сеть без дополнительной фильтрации когда сеанс связи завершается сведения нём удаляются из данной таблицы поэтому все последующие пакеты притворяющиеся пакетами уже завершённого соединения отбрасываются так как межсетевой экран данного типа исключает прямое взаимодействие между двумя узлами шлюз сеансового уровня является единственным связующим элементом между внешней сетью внутренними ресурсами это создаёт видимость того что на все запросы из внешней сети отвечает шлюз делает практически невозможным определение топологии защищаемой сети кроме того так как контакт между узлами устанавливается только при условии его допустимости шлюз сеансового уровня предотвращает возможность реализации dos атаки присущей пакетным фильтрам несмотря на эффективность этой технологии она обладает серьёзным недостатком как всех классов межсетевых экранов шлюзов сеансового уровня отсутствует возможность проверки содержания поля данных что позволяет злоумышленнику передавать троянских коней защищаемую сеть посредники прикладного уровня межсетевые экраны прикладного уровня как шлюзы сеансового уровня исключают прямое взаимодействие двух узлов однако функционируя на прикладном уровне они способны понимать контекст передаваемого трафика межсетевые экраны реализующие эту технологию содержат несколько приложений посредников каждое из которых обслуживает свой прикладной протокол такой межсетевой экран способен выявлять передаваемых сообщениях блокировать несуществующие или нежелательные команд что зачастую означает dos атаку либо запрещать использование некоторых команд например ftp put которая даёт возможность пользователю записывать информацию на ftp сервер посредник прикладного уровня может определять тип передаваемой информации например это позволяет заблокировать почтовое сообщение содержащее исполняемый файл другой возможностью межсетевого экрана данного типа является проверка аргументов входных данных например аргумент имени пользователя длиной символов либо содержащий бинарные данные является по крайней мере подозрительным посредники прикладного уровня способны выполнять аутентификацию пользователя также проверять что ssl сертификаты подписаны конкретным центром межсетевые экраны прикладного уровня доступны для многих протоколов включая http ftp почтовые smtp pop imap telnet другие недостатками данного типа межсетевых экранов являются большие затраты времени ресурсов на анализ каждого пакета по этой причине они обычно не подходят для приложений реального времени другим недостатком является невозможность автоматического подключения поддержки новых сетевых приложений протоколов так как для каждого из них необходим свой агент инспекторы состояния каждый из типов межсетевых экранов используется для защиты корпоративных сетей обладает рядом преимуществ однако куда эффективней было бы собрать все эти преимущества одном устройстве получить межсетевой экран осуществляющий фильтрацию трафика сетевого по прикладной уровень данная идея была реализована инспекторах состояний совмещающих себе высокую защищённость данный класс межсетевых экранов позволяет контролировать каждый передаваемый пакет на основе таблицы правил каждую сессию на основе таблицы состояний каждое приложение на основе разработанных посредников осуществляя фильтрацию трафика по принципу шлюза сеансового уровня данный класс межсетевых экранов не вмешивается процесс установления соединения между узлами поэтому инспектора состояний заметно выше чем посредника прикладного уровня шлюза сеансового уровня сравнима пакетных фильтров ещё одно достоинство инспекторов состояния прозрачность для пользователя для клиентского программного обеспечения не потребуется дополнительная настройка данные межсетевые экраны имеют большие возможности расширения при появлении новой службы или нового протокола прикладного уровня для его поддержки достаточно добавить несколько шаблонов однако инспекторам состояний по сравнению посредниками прикладного уровня свойственна более низкая защищённость термин инспектор состояния внедрённый компанией check point software полюбился производителям сетевого оборудования настолько что сейчас практически каждый межсетевой экран причисляют этой технологии даже если он не реализует её полностью реализация существует два варианта исполнения межсетевых экранов программный программно аппаратный свою очередь программно аппаратный вариант имеет две разновидности виде отдельного модуля коммутаторе или маршрутизаторе виде устройства настоящее время чаще используется программное решение которое на первый взгляд выглядит более привлекательным это вызвано тем что для его применения достаточно казалось бы всего лишь приобрести программное обеспечение межсетевого экрана установить на любой имеющийся организации компьютер однако как показывает практика организации далеко не всегда находится свободный компьютер да ещё удовлетворяющий достаточно высоким требованиям по системным ресурсам после того как компьютер всё таки найден чаще всего куплен следует процесс установки настройки операционной системы также непосредственно программного обеспечения межсетевого экрана нетрудно заметить что использование обычного персонального компьютера далеко не так просто как может показаться именно поэтому всё большее распространение стали получать программно аппаратные комплексы называемые security appliance на основе как правило freebsd или linux урезанные для выполнения только необходимых функций достоинствами данных решений являются простота внедрения данные устройства имеют настроенную операционную систему требуют минимум настроек после внедрения сеть простота управления данными устройствами можно управлять откуда угодно по стандартным протоколам таким как snmp или telnet либо посредством защищённых протоколов таких как ssh или ssl данные устройства работают более эффективно так как из их операционной системы исключены все неиспользуемые сервисы высокая доступность данные устройства созданы выполнять конкретные задачи высокой доступностью ограниченность анализа межсетевого экрана межсетевой экран позволяет осуществлять фильтрацию только того трафика который он способен понимать противном случае он теряет свою эффективность так как не способен осознанно принять решение том что делать нераспознанным трафиком существуют протоколы такие как tls ssh ipsec srtp использующие криптографию для того чтобы скрыть содержимое из за чего их трафик не может быть также некоторые протоколы такие как openpgp mime шифруют данные прикладного уровня из за чего фильтровать трафик на основании информации содержащейся на данном сетевом уровне становится невозможно ещё одним примером ограниченности анализа межсетевых экранов является туннелированный трафик так как его фильтрация является невозможной если межсетевой экран не понимает используемый механизм туннелированния во всех этих случаях правила на межсетевом экране должны явно определять что делать трафиком который они не могут примечания литература книги статьи категория сетевое оборудование категория межсетевые экраны категория кибервойна категория информационная безопасность