fibre channel fc волоконный канал семейство протоколов для передачи данных стандартизацией протоколов занимается технический комитет входящий состав incits американским национальным институтом стандартов ansi изначальное применение fc области впоследствии практически полностью перешло сферу сетей хранения данных где fc используется как стандартный способ подключения системам хранения данных уровня предприятия fibre channel protocol fcp транспортный протокол как tcp ip сетях инкапсулирующий протокол scsi по сетям fibre channel является основой построения сетей хранения данных русскоязычной литературе термин используется без перевода история история fibre channel началась году году был утверждён ansi как стандарт упрощавший интерфейс hippi для которого применялся массивный парный кабель громоздкими коннекторами первоначально интерфейс fibre channel должен был повысить дальность упростить подключение линий передачи не увеличить скорость версии fibre channel название линейная скорость gbaud линейное кодирование ном мб пропускная способность мб год gfc gfc gfc gfc gfc gfc параллельный gfc gen gfc gen gfc gen топологии fibre channel топологии fc определяют взаимное подключение устройств именно передатчиков трансмиттеров приёмников ресиверов устройств существует три типа топологии fc точка точка point to point устройства соединены напрямую трансмиттер одного устройства соединён ресивером второго наоборот все отправленные одним устройством кадры предназначены для второго устройства управляемая петля arbitrated loop устройства объединены петлю трансмиттер каждого устройства соединён ресивером следующего перед тем как петля сможет служить для передачи данных устройства договариваются об адресах для передачи данных по петле устройство должно завладеть эстафетой token добавление устройства петлю приводит приостановке передачи данных пересобиранию петли для построения управляемой петли используют концентраторы которые способны размыкать или замыкать петлю при добавлении нового устройства или выходе устройства из петли коммутируемая связная архитектура switched fabric основана на применении коммутаторов позволяет подключать большее количество устройств чем управляемой петле при этом добавление новых устройств не влияет на передачу данных между уже подключёнными устройствами так как на основе коммутаторов можно строить сложные сети на коммутаторах поддерживаются распределённые службы управления сетью fabric services отвечающие за маршруты передачи данных регистрацию сети присвоение сетевых адресов проч fibre channel изначально разрабатывался как сеть пригодная для работы реальном времени транспорте fibre channel заложены механизмы регулирования потока flow control синхронизации портов по времени возможность повтора сбойной информации без обращения протоколу верхнего уровня упрощенно без подробностей зонирования виртуализации fibre channel при подключении порта обязательным является выполнение login так что коммутатор всех портах сети всегда знает какой порт где находится что может когда коммутатор fibre channel приходит кадр данных то коммутатор уже знает где находится адресат куда этот кадр отличие от ethernet котором коммутатор после прихода кадра сначала ищет где находится адресат только после его ответа посылает ему этот кадр если истекло время старения коммутатор ethernet вновь будет искать маршрут для другого кадра данных от того же источника тому же адресату хотя оба порта были online очевидно что подход fibre channel требует больше ресурсов поэтому коммутаторы по этой технологии значительно дороже чем для ethernet иногда под топологией fc ошибочно подразумевают топологию сети хранения данных то есть взаимное подключение оборудования инфраструктуры оконечных устройств уровни fibre channel состоит из пяти уровней fc физический описывает среду передачи трансиверы коннекторы типы используемых кабелей включает определение электрических оптических характеристик скоростей передачи данных других физических компонентов поддерживается как оптическая так электрическая среда витая пара коаксиальный или твинаксиальный кабели также многомодовое или одномодовое волокно со скоростью передачи данных от мегабит до гигабит на расстояния до километров fc кодирование описывает процесс кодирования каждые бит данных кодируются битовый символ transmission character специальные символы контроль ошибок для gfc используется кодирование вследствие этого gfc несовместим gfc fc кадрирование сигнализация описывает сигнальные протоколы на этом уровне происходит определение слов разбиение потока данных на кадры определяет правила передачи данных между двумя портами классы служб fc общих для узла служб определяет базовые расширенные службы для транспортного уровня также такие особенности как расщепление потока данных striping возможность передачи потока данных через несколько соединений маршрутов отображение множества портов на одно устройство fc отображения протоколов предоставляет возможность инкапсуляции других протоколов scsi atm ip hippi av via ibm sbccs многих других логические типы портов топология fibre channel логические типы портов зависимости от поддерживаемой топологии типа устройства порты разделяются на несколько типов порты узлов n_port node port порт устройства поддержкой топологии fc точка точка или fc sw коммутатором nl_port node loop port порт устройства поддержкой топологии fc al arbitrated loop управляемая петля порты коммутатора маршрутизатора только для топологии fc sw f_port fabric port порт фабрики switched fabric коммутируемая связная архитектура используется для подключения портов типа n_port коммутатору не поддерживает топологию петли fl_port fabric loop port порт фабрики поддержкой петли используется для подключения портов типа nl_port коммутатору e_port expansion port порт расширения используется для соединения коммутаторов может быть соединён только портом типа e_port ex_port порт для соединения fc маршрутизатора fc коммутатора со стороны коммутатора он выглядит как обычный e_port со стороны маршрутизатора это ex_port te_port trunking expansion port e_port внесен fibre channel компанией cisco сейчас принят как стандарт это расширенный isl или eisl te_port предоставляет помимо стандартных возможностей e_port маршрутизацию множественных vsans virtual sans это реализовано применением нестандартного кадра fibre channel vsan тегирование общий случай l_port loop port любой порт устройства поддержкой топологии петля nl_port или fl_port g_port generic port порт автоматически может определяться как порт типа e_port a_port или f_port варианты оптической среды передачи данных коннекторы fibre channel lc слева sc справа тип среды скорость mbyte передатчик модификация расстояние одномодовое волокно нм длинноволновой лазер sm ll км нм длинноволновой лазер sm ll км нм длинноволновой лазер sm ll км нм длинноволновой лазер sm ll км нм длинноволновой лазер sm ll км нм длинноволновой лазер sm ll км многомодовое волокно µм nm коротковолновой лазер sn sn sn sl инфраструктура fibre channel оборудование для инфраструктуры fibre channel подразделяется на несколько классов директоры многопортовые модульные коммутаторы высокой степенью доступности выделенные коммутаторы standalone switches коммутаторы фиксированным количеством портов стэкируемые коммутаторы stackable switches коммутаторы имеющие дополнительные порты для связи независимых шасси между собой встраиваемые коммутаторы embedded switches коммутаторы встраиваемые блейд корзину blade enclosure где есть разделение портов на функции порты предназначенные для подключения blade серверов не могут быть использованы для соединений концентраторы hubs устройства обеспечивающие связь управляемой петле arbitrated loop концентраторы коммутаторы loop switches коммутаторы обеспечивающие связь управляемой петле arbitrated loop концентраторы концентраторы коммутаторы практически не используются для подключения оконечных устройств используются для подключения дисков контроллерам дисковых массивах для увеличения дальности соединения используют дополнительное трансмиссионное оборудование такое как мультиплексоры на основе wdm др основные производители оборудования для инфраструктуры fibre channel brocade cisco qlogic emulex логические элементы потока данных при передаче данных выделяют следующие логические упорядоченные наборы ordered sets четырёхбайтные слова transmission words содержащие данные специальные символы разбиение потока данных на упорядоченные наборы позволяет сохранять синхронизацию между передатчиком ресивером на уровне битов слов упорядоченные наборы всегда начинаются символа основные типы наборов определяются сигнальным протоколом разделители кадров разделители кадров используются для отделения одного кадра от другого существует два таких набора начало кадра start of frame sof конец кадра end of frame eof базовые сигналы сигнал бездействия idle передаётся для обозначения готовности принимать отправлять кадры сигнал готовности ресивера receiver ready r_rdy используется при управлении потоком данных см классы обслуживания для индикации наличия места буфере ресивера базовые передаются для оповещения нестандартном состоянии порта при получении такой ответ посылается соответствующая или сигнал бездействия стандарт поддерживает четыре offline ols not operational nos link reset lr link reset response lrr протоколы protocols сетях хранения данных используются низкоуровневые протоколы fibre channel protocol fcp транспорт scsi через fibre channel наиболее часто используемый на данный момент протокол существует вариантах gbit gbit gbit gbit gbit iscsi транспорт scsi через tcp ip fcoe транспортировка fcp scsi поверх чистого ethernet fcip ifcp инкапсуляция передача fcp scsi пакетах ip hyperscsi транспорт scsi через ethernet ficon транспорт через fibre channel используется только мейнфреймами ata over ethernet транспорт ata через ethernet scsi или tcp ip транспорт через infiniband ib адресация уникальный адрес устройства каждое устройство имеет уникальный байтовый адрес называемый nwwn node world wide name состоящий из нескольких компонентов bb bb bb cc cc cc назначаются производителем устройства назначаются ieee для каждого производителя всегда зарезервировано стандартом число произвольно выбирается производителем классы служб cos fibre channel поддерживает следующие классы служб classes of service cos стандарт fc ph определяет классы класс определён стандарте fc ph fc fs установлен устаревшим класс предложен для изохронного режима но недостаточно класс определён стандарте fc ph класс стандартах fc sw fc sw класс acknowledged connection service выделенные каналы подтверждением между двумя устройствами через коммутатор или фабрику устанавливается выделенное соединение принимающее устройство отправляет на передающее устройство подтверждения приёма каждого кадра соединение остаётся открытым до тех пор пока передача данных не будет завершена время установления соединения составляет несколько микросекунд предоставляемый канал обычно дуплексный хотя по необходимости возможна организация симплексного например если необходимо одновременно передавать данные одному узлу принимать от другого устройствам доступна вся его пропускная способность используется сквозное управление потоком гарантируется высокая скорость обмена правильный порядок приёма кадров идеально подходит для приложений работающих большими объёмами данных например системы моделирования или обработки видео если пропускная способность не используется полностью данным приложением она всё равно недоступна для других приложений пока соединение не будет закрыто так как попытки соединения таким портом будут отвергаться выдачей сигнала занято поэтому стандарте рекомендуется закрывать соединения отсутствие данных для передачи этом случае доступна максимальная пропускная способность основной недостаток невозможность работы между собой портов разной скоростью работы fc ph передача буферизация класса camp on начиная fc fs считаются устаревшими класс acknowledged connectionless service передачи без организации соединения подтверждением каждый кадр коммутируется независимо от остальных конечный порт может одновременно передавать принимать данные от нескольких узлов при этом канал между двумя не выделяется по сути происходит коммутатором трафика каждый кадр подтверждается принимающим устройством кадры могут доставляться по различным маршрутам то есть упорядоченная доставка кадров данном классе не гарантирована упорядочивание кадров осуществляется на уровне fc утилизация доступной полосы пропускания ниже чем классе поскольку включаются механизмы регулирования потока на покадровой основе класс unacknowledged connectionless service иногда называется datagram connectionless service передачи без организации соединения без подтверждения аналогичен классу за исключением того что нет подтверждения доставки пропускная способность отсутствие ошибок из за отсутствия подтверждений незначительно от большинстве случаев до худшем для класса случае увеличивается по сравнению классом но гарантий доставки нет упорядоченная доставка кадров не гарантирована упорядочивание кадров осуществляется на уровне fc запрос на повторную передачу потерянных кадров осуществляется протоколами верхних уровней соответственно случае ошибок передачи также если кадр отклоняется или ресурс занят то кадр теряется подключаются протоколы верхних уровней пропускная способность падает поскольку протоколов верхних уровней время реакции тайм ауты существенно выше чем на уровне fc при этом для протоколов реального времени задержка повтором может быть такой что передаваемая информация уже устарела используется для организации многоадресных рассылок применяется также системах массовой памяти наиболее класс коммутируемых fc сетей поскольку более прост реализации протоколы верхних уровней scsi ip работают именно этом классе класс fractional bandwidth connection oriented service соединение дробной полосой пропускания между n_ports сходен классом так как тоже предполагает установление соединения подтверждение доставки фиксированную задержку соблюдение порядка кадров соединение между портами устанавливается виде виртуального канала полосой пропускания достаточной для предоставления услуг предсказуемым качеством qos включающий гарантированные полосу пропускания максимальную задержку такой виртуальный двунаправленный канал состоит из двух виртуальных соединений virtual circuit vc причём на каждом vc могут обеспечиваться различные qos каждый n_port может устанавливать несколько таких соединений до используется для критичных ко времени доставки данных например видео аудиопотоков класс isochronous service изохронное соединение не стандартизован предназначен для приложений требующих немедленной доставки данных без промежуточной буферизации класс unidirectional connection service соединение аналогичен классу но является исключительно используется для многоадресных рассылок через соответствующий сервер n_port может затребовать соединения класса на одно или несколько устройств портов установленное соединение существует пока инициатор явном виде не закроет его разработан для доставки трафика реального времени например аудио видео смешанный класс intermix является подвидом класса позволяет передавать кадры класса или те моменты когда приложение первого класса не занимает канал причём кадры классов или необязательно должны быть адресованы тому же получателю что класса был специально разработан целью частично устранить блокировку фабрики передачами первого класса класс используется коммутаторами для управления передачи служебной информации передача идёт без установления соединения по inter switch links isl между e_ports сферы применения fibre channel файл ml qlogicnfcconn jpg left thumb px san свитч qlogic подключёнными нему fc оптическими коннекторами fibre channel широко применяется для создания сетей хранения данных storage area networks благодаря высокой скорости передачи данных малой задержке расширяемости практически не имеет аналогов этой области однако последние годы область его применения постепенно перемещается сегмент систем решений бюджетный сегмент успехом осваивается недорогими решениями iscsi на базе gigabit ethernet ethernet наметилась также тенденция переносу транспортного уровня протокола fc тот же gigabit ethernet при помощи протоколов fcoe fcip см также hba scsi iscsi thunderbolt сетевая плата ссылки fibre channel industry association technical committee jon tate brian cartwright john cronin christian dapprich ibm san survival guide ibm redbooks sg august онлайн книга сети хранения данных fibre channel примечания категория протоколы транспортного уровня категория fibre channel