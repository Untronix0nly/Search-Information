utf от англ bit unicode transformation format формат преобразования юникода бит формат кодирования текста юникод переменной длиной символьных слов символов ascii первоначально предназначался для кодирования текстов юникода сообщениях электронной почты интернета которые были более эффективными чем комбинация utf quoted printable применение современный стандарт формата электронной почты mime запрещает кодирование заголовков использованием байтовых значений выше диапазона ascii хотя mime позволяет кодировать тело сообщения из разных наборов символов более широких чем ascii базовая инфраструктура передачи smtp основной стандарт передачи mail по прежнему не гарантирует битную чистоту поэтому случае сомнений необходимо применять нетривиальное кодирование передаваемого контента сожалению base имеет недостаток заключающийся том что даже символы us ascii не читаются не mime клиентах другой стороны utf сочетании quoted printable представляет собой очень неэффективный формат требующий байт для отличных от ascii символов из bmp basic multilingual plane байтов для символов вне bmp если во время кодирования соблюдаются определённые правила текст кодировке utf может быть отправлен по электронной почте без использования базовой кодировки передачи mime но должен быть явно помечен как набор текстовых символов кроме того если они используются заголовках электронной почты таких как subject utf должен содержаться закодированных по стандарту mime словах набор символов так как закодированные слова используют или quoted printable или base наборы utf был разработан возможностью не использовать знак равенства качестве экранирующего символа чтобы избежать двойного пропуска при его сочетании quoted printable или его вариантом rfc кодирование заголовков utf как правило не используется нативном виде приложениях так как очень неудобен при обработке несмотря на то что utf имеет преимущество перед комбинациями utf quoted printable или base ныне несуществующий internet mail consortium рекомендовал не использовать кодировку utf также был введён bitmime чтобы уменьшить необходимость кодирования тел сообщений битном формате форма utf mutf настоящее время используется mail протоколе imap для поиска имён почтовых ящиков описание первоначально utf был предложен качестве протокола rfc mail safe transformation format of unicode этот rfc устарел по сравнению rfc информационным rfc который никогда не был стандартом как заявлено rfc rfc не определяет интернет стандарт любого типа несмотря на это rfc цитируется как определение utf списке кодировок iana также utf не является стандартом unicode unicode standard перечислены только utf utf utf существует также версия указанная rfc которая иногда как utf некоторые символы могут быть представлены непосредственно виде одиночных байтов ascii они образуют группу так называемых прямых символов из букв латиницы цифр символов пунктуации прямые символы безопасны при их буквальном отображении другая основная группа известная как необязательные прямые символы содержит все другие печатные символы диапазоне за исключением пробела использование необязательных прямых символов уменьшает размер улучшает читаемость но также увеличивает вероятность повреждения информации такими факторами как плохо почтовые шлюзы может потребовать дополнительного экранирования при использовании необязательных прямых символов кодированных словах для полей заголовка пробел табуляция возврат каретки перевод строки также могут быть представлены непосредственно виде одиночных байтов ascii однако если кодированный текст должен использоваться электронной почте необходимо соблюдать осторожность гарантирующую что для этих символов не потребуется дополнительной кодировки передаваемого контента подходящей для электронной почты знак плюса может быть закодирован как другие символы должны быть сначала закодированы utf символы кодами от выше будут закодированы суррогатах big endian старшие биты конце затем модифицированы коды base начало таких блоков из символов закодированных utf base обозначается знаком конец блоков обозначается любым символом который не входит модифицирующий набор base если символ после модифицирования base является дефис минусом ascii то он пропускается декодером декодирование возобновляется со следующего символа противном случае декодирование возобновляется символом после base также был введён bitmime чтобы уменьшить необходимость кодирования тел сообщений битном формате форма utf mutf настоящее время используется mail протоколе imap для поиска имён почтовых ящиков примеры hello world кодируется как hello world кодируется как ad кодируется как akm кодовое обозначение unicode для знака фунта равно соответствует utf которая преобразуется base как приведённой ниже таблице два недостающих бита дополняются код двоичный код индексы код base алгоритм кодирования декодирования кодирование во первых кодировщик должен определить какие символы можно представить непосредственно формате ascii кроме знака плюс который кодируются как какие символы нужно пометить как блоки символов unicode простой кодировщик может кодировать напрямую все символы которые он считает безопасными для прямого кодирования однако стоит оканчивать unicode вводом одного символа непосредственно ascii затем начинать другую unicode содержащую от до байтов это больше чем байта необходимых для представления символа как части unicode каждая символов юникода должна быть закодирована использованием следующей процедуры затем окружена разделителями для примера используем символов декодирование сначала закодированные данные должны быть разделены на простые текстовые фрагменты ascii включая плюсы за которыми следует дефис непустые блоки unicode как указано разделе описания как только это будет сделано каждый блок unicode должен быть декодирован следующей процедурой используя результат примера кодирования выше маркер unicode маркер юникода часто называемый bom byte order mark является необязательной специальной байтов самом начале потока или файла который не будучи самими данными указывает кодировку используемую для последующих данных маркер используется при отсутствии метаданных обозначающих кодировку для данной схемы кодирования сигнатура представляет собой представление схемы кодовой точке unicode feff так называемый bom символ хотя маркер unicode как правило представляет собой единую фиксированную байтов специфика utf представляет вариаций последние бита го байта кодировки utf feff относятся следующему символу что приводит возможным битовым шаблонам следовательно разным возможным байтам позиции пятая вариация необходима для устранения неоднозначности случая когда вообще никакие символы не следуют за маркером см определение кодировки по маркеру байтов безопасность utf допускает множественные представления одной той же исходной строки частности символы ascii могут быть представлены как часть блоков unicode таким образом если для строк которые могут быть позже как utf используются стандартные алгоритмы экранирования или проверки подлинности на основе ascii то блоки unicode могут использоваться для внедрения вредоносных строк свободно проходящих через проверку чтобы устранить эту проблему системы проверки должны выполнять декодирование перед проверкой не должны пытаться автоматически обнаруживать utf старые версии internet explorer можно обмануть путём интерпретации страницы как utf это можно использовать для атаки на межсайтовый скриптинг поскольку служебные символы могут быть закодированы как adw ad utf которые большинство валидаторов пропускают как простой текст примечания категория компьютерные кодировки