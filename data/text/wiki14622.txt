bluetooth от слов синий зуб произносится блюту спецификация беспроводных персональных сетей bluetooth обеспечивает обмен информацией между такими устройствами как персональные компьютеры настольные карманные ноутбуки мобильные телефоны интернет планшеты принтеры цифровые фотоаппараты мышки клавиатуры джойстики наушники гарнитуры на надёжной бесплатной повсеместно доступной радиочастоте для ближней связи bluetooth позволяет этим устройствам сообщаться когда они находятся радиусе до друг от друга дальность сильно зависит от преград помех даже разных помещениях название слово bluetooth адаптация на английский язык датского слова blåtand синезубый так прозвали когда то короля викингов харальда синезубого жившего дании около тысячи лет назад прозвище этот король получил за темный передний зуб харальд правил веке данией частью норвегии объединил враждовавшие датские племена единое королевство подразумевается что bluetooth делает то же самое протоколами связи объединяя их один универсальный стандарт хотя blå современных скандинавских языках означает синий во времена викингов оно также могло означать чёрного цвета таким образом исторически правильно было бы перевести датское harald blåtand скорее как harald blacktooth чем как harald bluetooth русском тексте портал грамота ру называет использование написания bluetooth допустимым блюту логотип bluetooth является сочетанием двух нордических скандинавских рун хагалаз младшего футарка беркана звуковые значения которых соответствуют инициалам харальда синезубого дат harald blåtand норв harald blåtann логотип похож на более старый логотип для beauknit textiles подразделения корпорации beauknit нём используется слияние отраженной для beauknit он шире имеет скругленные углы но общем он такой же история создания развития работы по созданию bluetooth начал производитель оборудования ericsson году как беспроводную альтернативу кабелям rs первоначально эта технология была приспособлена под потребности системы flyway функциональном интерфейсе между системой спецификация bluetooth была разработана группой bluetooth special interest group bluetooth sig которая была основана году неё вошли компании ericsson ibm intel toshiba nokia впоследствии bluetooth sig ieee достигли соглашения на основе которого спецификация bluetooth стала частью стандарта ieee дата опубликования июня года класс максимальная мощность мвт максимальная мощность дбм радиус действия менее принцип действия bluetooth принцип действия основан на использовании радиоволн радиосвязь bluetooth осуществляется ism диапазоне который используется различных бытовых приборах беспроводных сетях свободный от лицензирования диапазон ггц bluetooth применяется метод расширения спектра со скачкообразной перестройкой частоты метод fhss прост реализации обеспечивает устойчивость широкополосным помехам оборудование недорогое согласно алгоритму fhss bluetooth несущая частота сигнала скачкообразно меняется раз секунду всего выделяется рабочих частот шириной мгц японии франции испании полоса же частотных канала переключения между частотами для каждого соединения является псевдослучайной известна только передатчику приёмнику которые каждые мкс один временной слот синхронно перестраиваются одной несущей частоты на другую таким образом если рядом работают несколько пар приёмник передатчик то они не мешают друг другу этот алгоритм является также составной частью системы защиты передаваемой информации переход происходит по алгоритму определяется отдельно для каждого соединения при передаче цифровых данных аудиосигнала кбит обоих направлениях используются различные схемы кодирования аудиосигнал не повторяется как правило цифровые данные случае утери пакета информации будут переданы повторно протокол bluetooth поддерживает не только соединение point to point но соединение point to multipoint спецификации bluetooth устройства версий имели плохую совместимость между продуктами различных производителей была обязательной передача адреса устройства bd_addr на этапе установления связи что делало невозможной реализацию анонимности соединения на протокольном уровне было основным недостатком данной спецификации bluetooth bluetooth было исправлено множество ошибок найденных добавлена поддержка для нешифрованных каналов индикация уровня мощности принимаемого сигнала rssi bluetooth главные улучшения включают следующее быстрое подключение обнаружение адаптивная перестройка частоты расширенным спектром afh которая повышает стойкость радиопомехам более высокие чем скорости передачи данных практически до мбит расширенные синхронные подключения esco которые улучшают качество передачи голоса аудиопотоке позволяя повторную передачу повреждённых пакетов при необходимости могут увеличить задержку аудио чтобы оказать лучшую поддержку для параллельной передачи данных host controller interface hci добавлена поддержка трёхпроводного интерфейса uart утверждён как стандарт ieee standard введены режимы управления потоком данных flow control повторной передачи retransmission modes для cap bluetooth edr bluetooth версии был выпущен ноября имеет обратную совместимость предыдущими версиями основным нововведением стала поддержка enhanced data rate edr для ускорения передачи данных номинальная скорость edr около мбит однако на практике это позволило повысить скорость передачи данных только до мбит дополнительная достигается помощью различных радиотехнологий для передачи данных стандартная базовая скорость передачи данных использует gfsk модуляцию радиосигнала при скорости передачи мбит edr использует сочетание модуляций gfsk psk двумя вариантами dqpsk dpsk они имеют большие скорости передачи данных по воздуху мбит соответственно bluetooth sig издала спецификацию как технология bluetooth edr которая подразумевает что edr является дополнительной функцией кроме edr есть другие незначительные спецификации продукты могут соответствовать технологии bluetooth не поддерживая более высокую скорость передачи данных по крайней мере одно коммерческое устройство htc tytn pocket pc использует bluetooth без edr своих технических спецификациях согласно edr спецификации edr обеспечивает следующие преимущества увеличение скорости передачи раза мбит некоторых случаях уменьшение сложности нескольких одновременных подключений из за дополнительной полосы пропускания снижение потребления энергии благодаря уменьшению нагрузки bluetooth год добавлена технология расширенного запроса характеристик устройства для дополнительной фильтрации списка при сопряжении технология sniff subrating которая позволяет увеличить работы устройства от одного заряда аккумулятора раз кроме того обновлённая спецификация существенно упрощает ускоряет установление связи между двумя устройствами позволяет производить обновление ключа шифрования без разрыва соединения также делает указанные соединения более защищёнными благодаря использованию технологии near field communication bluetooth edr августе года bluetooth sig представила версию edr новая редакция bluetooth снижает потребление энергии раз повышает уровень защиты данных облегчает распознавание соединение bluetooth устройств благодаря уменьшению количества шагов за которые оно выполняется bluetooth hs hs была принята bluetooth sig апреля года она поддерживает теоретическую скорость передачи данных до мбит её основной особенностью является добавление amp alternate mac phy дополнение как сообщение для amp были предусмотрены две технологии uwb но uwb отсутствует спецификации модули поддержкой новой спецификации соединяют себе две радиосистемы первая обеспечивает передачу данных мбит стандартная для bluetooth имеет низкое вторая совместима со стандартом обеспечивает возможность передачи данных со скоростью до мбит сравнима со скоростью сетей wi fi выбор радиосистемы для передачи данных зависит от размера передаваемого файла небольшие файлы передаются по медленному каналу большие по bluetooth использует более общий стандарт без суффикса то есть несовместим такими спецификациями wi fi как или bluetooth bluetooth sig утвердил спецификацию bluetooth июня года bluetooth включает себя протоколы классический bluetooth bluetooth bluetooth низким bluetooth основан на wi fi классический bluetooth состоит из протоколов предыдущих спецификаций bluetooth частоты работы системы bluetooth мощность не более вт полоса частот гц ггц ггц протокол bluetooth низким предназначен прежде всего для миниатюрных электронных датчиков использующихся спортивной обуви тренажёрах миниатюрных сенсорах размещаемых на теле пациентов низкое достигается за счёт использования особого алгоритма работы передатчик включается только на время отправки данных что обеспечивает возможность работы от одной батарейки типа cr течение нескольких лет стандарт предоставляет скорость передачи данных мбит при размере пакета данных байт новой версии два bluetooth устройства смогут устанавливать соединение менее чем за миллисекунд поддерживать его на расстоянии до для этого используется коррекция ошибок необходимый уровень безопасности обеспечивает битное aes шифрование датчики температуры давления влажности скорости передвижения на базе этого стандарта могут передавать информацию на различные устройства контроля мобильные телефоны кпк пк первый чип поддержкой bluetooth bluetooth был выпущен компанией st ericsson конце года настоящее время выпускается большое количество мобильных устройств поддержкой этого стандарта bluetooth конце года bluetooth special interest group sig представила спецификацию bluetooth одно из улучшений реализованных спецификации bluetooth касается совместной работы bluetooth мобильной связи четвёртого поколения lte стандарт предусматривает защиту от взаимных помех путём автоматического координирования передачи пакетов данных bluetooth декабря bluetooth special interest group sig представила спецификацию bluetooth основные улучшения повышение увеличение скорости передачи данных bluetooth июня года bluetooth special interest group sig представила спецификацию bluetooth изменения коснулись основном режима низким потреблением режима радиус действия увеличен раза скорость увеличена раза стек протоколов bluetooth bluetooth имеет многоуровневую архитектуру состоящую из основного протокола протоколов замены кабеля протоколов управления телефонией заимствованных протоколов обязательными протоколами для всех стеков bluetooth являются lmp cap sdp кроме того устройства связывающиеся bluetooth обычно используют протоколы hci rfcomm lmp link management protocol используется для установления управления между двумя устройствами реализуется контроллером bluetooth hci host controller interface определяет связь между стеком хоста то есть компьютера или мобильного устройства контроллером bluetooth cap logical link control and adaptation protocol используется для локальных соединений между двумя устройствами использующими различные протоколы более высокого уровня позволяет фрагментировать пересобирать пакеты sdp service discovery protocol позволяет обнаруживать услуги предоставляемые другими устройствами определять их параметры rfcomm radio frequency communications протокол замены кабеля создаёт виртуальный поток данных эмулирует управляющие сигналы rs bnep bluetooth network encapsulation protocol используется для передачи данных из других стеков протоколов через канал cap применяется для передачи ip пакетов профиле personal area networking avctp audio video control transport protocol используется профиле audio video remote control для передачи команд по каналу cap avdtp audio video distribution transport protocol используется профиле advanced audio distribution для передачи стереозвука по каналу cap tcs telephony control protocol binary протокол определяющий сигналы управления вызовом для установления голосовых соединений соединений для передачи данных между устройствами bluetooth используется только профиле cordless telephony заимствованные протоколы включают себя point to point protocol ppp tcp ip udp object exchange protocol obex wireless application environment wae wireless application protocol wap профили bluetooth профиль набор функций или возможностей доступных для определённого устройства bluetooth для совместной работы bluetooth устройств необходимо чтобы все они поддерживали общий профиль нижеуказанные профили определены одобрены группой разработки bluetooth sig advanced audio distribution profile dp разработан для передачи двухканального стерео аудиопотока например музыки беспроводной гарнитуре или любому другому устройству профиль полностью поддерживает кодек sub_band_codec sbc опционально поддерживает mpeg аудио mpeg aac atrac способен поддерживать кодеки определённые производителем audio video remote control profile avrcp разработан для управления стандартными функциями телевизоров hi fi оборудования прочего то есть позволяет создавать устройства функциями дистанционного управления может использоваться связке профилями dp или vdp basic imaging profile bip разработан для пересылки изображений между устройствами включает возможность изменения размера изображения конвертирование поддерживаемый формат принимающего устройства basic printing profile bpp позволяет пересылать текст сообщения электронной почты vcard другие элементы на принтер профиль не требует от принтера специфических драйверов что выгодно отличает его от hcrp common isdn access profile cip для доступа устройств isdn cordless telephony profile ctp профиль беспроводной телефонии device id profile dip позволяет класс устройства производителя версию продукта dial up networking profile dun протокол предоставляет стандартный доступ интернету или другому телефонному сервису через bluetooth базируется на spp включает себя команды ppp at определённые спецификации etsi fax profile fax предоставляет интерфейс между мобильным или стационарным телефоном пк на котором установлено программное обеспечение для факсов поддерживает набор at команд стиле itu или itu голосовой звонок или передача данных профилем не поддерживается file transfer profile ftp_profile обеспечивает доступ файловой системе устройства включает стандартный набор команд ftp позволяющий получать список каталогов изменения каталогов получать передавать удалять файлы качестве транспорта используется obex базируется на goep general audio video distribution profile gavdp база для dp vdp generic access profile gap база для всех остальных профилей generic object exchange profile goep база для других профилей передачи данных базируется на obex hard copy cable replacement profile hcrp предоставляет простую альтернативу кабельного соединения между устройством принтером минус профиля том что для принтера необходимы специфичные драйвера что делает профиль неуниверсальным hands free profile hfp используется для соединения беспроводной гарнитуры телефона передаёт монозвук одном канале human interface device profile hid обеспечивает поддержку устройств hid human interface device таких как мыши джойстики клавиатуры проч использует медленный канал работает на пониженной мощности headset profile hsp используется для соединения беспроводной гарнитуры headset телефона поддерживает минимальный набор at команд спецификации gsm для обеспечения возможности совершать звонки отвечать на звонки завершать звонок настраивать громкость через профиль headset при наличии bluetooth выше можно выводить на гарнитуру всё звуковое сопровождение работы телефона например прослушивать на гарнитуре все сигналы подтверждения операций mp музыку из плеера мелодии звонка звуковой ряд видеороликов гарнитуры поддерживающие такой профиль имеют возможность передачи стереозвука отличие от моделей которые поддерживают только профиль hands free intercom profile icp обеспечивает голосовые звонки между bluetooth совместимыми устройствами lan access profile lap обеспечивает доступ bluetooth устройствам вычислительным сетям lan wan или интернет посредством другого bluetooth устройства которое имеет физическое подключение этим сетям bluetooth устройство использует ppp поверх rfcomm для установки соединения lap также допускает создание ad hoc bluetooth сетей object push profile opp базовый профиль для пересылки объектов таких как изображения виртуальные визитные карточки др передачу данных инициирует отправляющее устройство клиент не приёмное сервер personal area networking profile pan позволяет использовать протокол bluetooth network encapsulation качестве транспорта через bluetooth соединение phone book access profile pbap позволяет обмениваться записями телефонных книг между устройствами serial port profile spp базируется на спецификации etsi ts использует протокол rfcomm профиль эмулирует порт предоставляя возможность замены стандартного rs беспроводным соединением является базовым для профилей dun fax hsp avrcp service discovery application profile sdap используется для предоставления информации профилях которые использует устройство сервер sim access profile sap sim позволяет получить доступ sim карте телефона что позволяет использовать одну sim карту для нескольких устройств synchronisation profile synch позволяет персональные данные pim профиль заимствован из спецификации инфракрасной связи адаптирован группой bluetooth sig video distribution profile vdp позволяет передавать потоковое видео поддерживает стандарты mpeg visual simple profile profiles profile поддерживаются опционально не содержатся спецификации wireless application protocol bearer wapb протокол для организации to point to point соединения через bluetooth безопасность июне года авишай вул янив шакед опубликовали статью содержащую подробное описание атаки на устройства bluetooth материал содержал описание как активной так пассивной атаки позволяющей заполучить pin код устройства дальнейшем осуществить соединение данным устройством пассивная атака позволяет соответствующе экипированному злоумышленнику подслушать sniffing процесс инициализации соединения дальнейшем использовать полученные результате прослушки анализа данные для установления соединения spoofing естественно для проведения данной атаки злоумышленнику нужно находиться близости непосредственно момент установления связи это не всегда возможно поэтому родилась идея активной атаки была обнаружена возможность отправки особого сообщения определённый момент позволяющего начать процесс инициализации устройством злоумышленника обе процедуры взлома достаточно сложны включают несколько этапов основной из которых сбор пакетов данных их анализ сами атаки основаны на уязвимостях механизме аутентификации создания ключа шифра между двумя устройствами инициализация bluetooth соединения инициализацией bluetooth соединения принято называть процесс установки связи её можно разделить на три этапа генерация ключа kinit генерация ключа связи он носит название link key обозначается как kab аутентификация первые два пункта входят так называемую процедуру паринга паринг pairing или сопряжение процесс связи двух или более устройств целью создания общего секретного значения kinit которое они будут дальнейшем использовать при общении некоторых переводах официальных документов по bluetooth можно также встретить термин подгонка пары перед началом процедуры сопряжения на обеих сторонах необходимо ввести pin код kinit формируется по алгоритму который оперирует следующими величинами bd_addr уникальный mac адрес bt устройства длиной бит pin код его длина in_rand случайная битная величина для создания ключа связи kab устройства обмениваются битными словами lk_rand lk_rand генерируемыми случайным образом далее следует побитовый xor ключом инициализации kinit снова обмен полученным значением затем следует вычисление ключа по алгоритму для этого необходимы величины bd_addr битный lk_rand каждое устройство хранит своё полученное от другого устройства значения на данном этапе pairing заканчивается начинается последний этап инициализации bluetooth mutual authentication или взаимная аутентификация основана она на схеме запрос ответ одно из устройств становится верификатором генерирует случайную величину au_rand посылает его соседнему устройству открытом виде называемому предъявителем как только предъявитель получает это слово начинается вычисление величины sres по алгоритму она отправляется верификатору соседнее устройство производит аналогичные вычисления проверяет ответ предъявителя если sres совпали то устройства меняются ролямии процесс повторяется заново алгоритм оперирует такими величинами случайно созданное au_rand link key kab свой собственный bd_addr атака на сопряжение если злоумышленнику удалось прослушать эфир во время процедуры сопряжения он перехватил сохранил все сообщения то далее найти pin можно используя перебор первым кто заметил эту уязвимость был англичанин олли вайтхауз ollie whitehouse апреле года он первым предложил перехватить сообщения во время сопряжения попытаться вычислить pin методом перебора используя полученную информацию тем не менее метод имеет один существенный недостаток атаку возможно провести только случае если удалось подслушать все данные другими словами если злоумышленник находился вне эфира во время начала сопряжения или же упустил какую то величину то он не имеет возможности продолжить атаку атака на пересопряжение вулу шакеду удалось найти решение трудностей связанных атакой вайтхауза был разработан второй тип атаки если процесс сопряжения уже начат данные упущены провести атаку невозможно но если устройства уже успели связаться сохранили ключ kab приступили взаимной аутентификации можно заставить устройства заново инициировать процесс сопряжения чтобы провести вышеописанную атаку на сопряжение данная атака требует отправки нужных сообщений нужный момент времени стандартные устройства доступные продаже не подойдут для этих целей использовав любой из этих методов злоумышленник может приступить базовой атаке на сопряжение таким образом имея арсенале эти две атаки злоумышленник может похитить pin код далее имея pin код он сможет установить соединение любым из этих устройств стоит учесть что большинстве устройств безопасность на уровне служб доступных через bluetooth не обеспечивается на должном уровне большинство разработчиков делает ставку именно на безопасность установления сопряжения поэтому последствия действий злоумышленника могут быть различными от кражи записной книжки телефона до установления исходящего вызова телефона жертвы использования его как прослушивающего устройства оценка времени подбора pin кода протоколе bluetooth активно используются алгоритмы основанные на шифре safer брюс шнайер подтвердил что уязвимость относится критическим подбор pin на практике прекрасно работает может быть произведен реальном времени ниже приведены результаты полученные на pentium iv ht на ггц длина знаков время сек конкретные реализации вышеописанных атак могут работать различной скоростью способов оптимизации множество особые настройки компилятора различные реализации циклов условий арифметических операций авишай вул янив шакед нашли способ значительно сократить время перебора pin кода увеличение длины pin кода не является панацеей только сопряжение устройств безопасном месте может частично защитить от описанных атак пример bluetooth гарнитура или автомобильный handsfree инициализация связи при включении данными устройствами может происходить многократно течение дня не всегда пользователя есть возможность находиться при этом защищённом месте применение радиус работы устройств bt не превышает метров для bt до класс эти числа декларируются стандартом для прямой видимости реальности не стоит ожидать работы на расстоянии более такого дальнодействия недостаточно для эффективного применения атак на практике поэтому ещё до детальной проработки алгоритмов атаки на defcon публике была представлена антенна винтовка bluesniper разработанная джонном херингтоном john herington устройство подключается портативному устройству ноутбуку кпк имеет достаточную направленность мощность эффективная работа до км сосуществование другими протоколами частая смена рабочего канала fhss широком диапазоне частот дает шанс на сосуществование другими протоколами введением адаптивной afh ситуация немного улучшилась отладка сертификация отладка контроль соответствия стандарту осложняется активными соседями по диапазону например wi fi существуют решения позволяющие декодировать отслеживать все соединения одновременно во всех каналах bluetooth см также ieee стек bluetooth блюджекинг uwb примечания литература ссылки bluetooth tutorial спецификации bluetooth безопасность bluetooth edr хорошо доделанное старое yaniv shaked avishai wool cracking the bluetooth pin nfc forum категория радиосвязь категория беспроводные сети категория сетевые стандарты категория умный дом категория автоматизация