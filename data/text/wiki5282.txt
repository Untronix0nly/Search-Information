rc от или также известен как arc или arcfour потоковый шифр широко применяющийся различных системах защиты информации компьютерных сетях например протоколах ssl tls алгоритмах обеспечения безопасности беспроводных сетей wep wpa шифр разработан компанией для его использования требуется лицензия алгоритм rc как любой потоковый шифр строится на основе генератора псевдослучайных битов на вход генератора записывается ключ на выходе читаются псевдослучайные биты длина ключа может составлять от до бит генерируемые биты имеют равномерное распределение основные преимущества шифра высокая скорость работы переменный размер ключа rc довольно уязвим если используются не случайные или связанные ключи один ключевой поток используется дважды эти факторы также способ использования могут сделать криптосистему небезопасной например wep история потоковый шифр rc был создан рональдом ривестом сотрудником компании году сокращение rc официально обозначает rivest cipher или шифр ривеста номер версии см rc rc rc rc никогда не публиковался rc разрабатывался но нём была найдена уязвимость но его часто считают сокращением от ron code код рона течение семи лет шифр являлся коммерческой тайной точное описание алгоритма предоставлялось только после подписания соглашения неразглашении но сентябре года его описание было анонимно отправлено список рассылки cypherpunks вскоре описание rc было опубликовано группе новостей usenet sci crypt оттуда исходный код попал на множество сайтов сети интернет опубликованный алгоритм на выходе выдавал шифротексты совпадающие шифротекстами выдаваемыми подлинным rc обладатели легальных копий исходного кода rc подтвердили идентичность алгоритмов при различиях обозначениях структуре программы поскольку данный алгоритм известен он более не является коммерческой тайной однако название rc является торговой маркой компании чтобы избежать возможных претензий со стороны владельца торговой марки шифр иногда называют arcfour или arc имея виду предполагаемый rc поскольку rsa security официально не опубликовала алгоритм алгоритм шифрования rc применяется некоторых широко стандартах протоколах шифрования например wep wpa ssl tls rc стал популярен благодаря простоте его аппаратной программной реализации высокой скорости работы алгоритма обоих случаях сша длина ключа рекомендуемая для использования внутри страны равна битам соглашение заключённое между spa правительством сша разрешило экспортировать шифры rc длиной ключа до бит битные ключи разрешено использовать заграничным отделениям американских компаний описание алгоритма ядро алгоритма поточных шифров состоит из функции генератора псевдослучайных битов гаммы который выдаёт поток битов ключа ключевой поток гамму псевдослучайных битов файл gamma png thumbnail px режим гаммирования для поточных шифров алгоритм шифрования функция генерирует битов затем битов посредством операции суммирование по модулю два xor объединяется открытым текстом результате получается шифрограмма алгоритм расшифровки повторно создаётся регенерируется поток битов ключа ключевой поток поток битов ключа складывается шифрограммой операцией xor силу свойств операции xor на выходе получается исходный незашифрованный текст rc фактически класс алгоритмов определяемых размером блока дальнейшем блока параметр является размером слова для алгоритма определяет длину блока обычно но целях анализа можно уменьшить его однако для повышения безопасности необходимо увеличить эту величину алгоритме нет противоречий на увеличение размера блока при увеличении допустим до бит элементов блоке становится соответственно время начальной итерации будет увеличено однако скорость шифрования возрастёт внутреннее состояние rc представляется виде массива размером двух счётчиков массив известен как блок далее будет обозначаться как он всегда содержит перестановку возможных значений слова два счётчика обозначены через инициализация rc состоит из двух частей инициализация блока генерация слова инициализация блока алгоритм также известен как key scheduling algorithm или ksa этот алгоритм использует ключ подаваемый на вход пользователем сохранённый key имеющий длину байт инициализация начинается заполнения массива далее этот массив перемешивается путём перестановок определяемых ключом так как только одно действие выполняется над то должно выполняться утверждение что всегда содержит один набор значений который был дан при первоначальной инициализации si for from to si endfor for from to si key mod mod поменять местами si sj endfor генерация слова генератор ключевого потока rc эта часть алгоритма называется генератором псевдослучайной генератор ключевого потока rc переставляет значения хранящиеся одном цикле rc определяется одно битное слово из ключевого потока дальнейшем ключевое слово будет сложено по модулю два исходным текстом которое пользователь хочет зашифровать получен зашифрованный текст while цикл генерации mod si mod поменять местами si sj si sj mod st сгенерировано псевдослучайное слово для будет сгенерирован один байт endwhile безопасность отличие от современных шифров таких как estream rc не использует nonce оказию наряду ключом это значит что если один ключ должен использоваться течение долгого времени для шифрования нескольких потоков сама криптосистема использующая rc должна комбинировать оказию долгосрочный ключ для получения потокового ключа для rc один из возможных выходов генерировать новый ключ для rc помощью хэш функции от долгосрочного ключа nonce однако многие приложения использующие rc просто конкатенируют ключ nonce из за этого слабого расписания ключей используемого rc приложение может стать уязвимым поэтому он был признан устаревшим многими софтверными компаниями такими как microsoft например net framework от microsoft отсутствует реализация rc здесь будут рассмотрены некоторые атаки на шифр методы защиты от них исследования руза восстановление ключа из перестановки году андрю руз пронаблюдал что первый байт ключевого потока коррелирован первыми тремя байтами ключа первые несколько байт перестановки после алгоритма расписания ключей коррелированы некоторой линейной комбинацией байт ключа эти смещения не были доказаны до года когда пол рафи мэйтрэ доказали ключа ключевого потока также пол мэйтрэ доказали перестановки ключа последняя работа также использует ключа перестановки для того чтобы создать первый алгоритм полного восстановления ключа из последней перестановки после ksa не делая предположений ключе векторе инициализации этот алгоритм имеет постоянную вероятность успеха зависимости от времени которая соответствует квадратному корню из сложности полного перебора позднее было сделано много работ восстановлении ключа из внутреннего состояния rc атака флурера мантина шамира фмш году флурер мантин шамир опубликовали работу об уязвимости ключевого расписания rc они показали что первые байты ключевого потока среди всех возможных ключей неслучайны из этих байтов можно высокой вероятностью получить информацию об используемом шифром ключе если долговременный ключ nonce просто склеиваются для создания ключа шифра rc то этот долговременный ключ может быть получен помощью анализа достаточно большого количества сообщений зашифрованных использованием данного ключа эта уязвимость некоторые связанные ней эффекты были использованы при взломе шифрования wep беспроводных сетях стандарта ieee это показало необходимость скорейшей замены wep что повлекло за собой разработку нового стандарта безопасности беспроводных сетей wpa криптосистему можно сделать невосприимчивой этой атаке если отбрасывать начало ключевого потока таким образом алгоритм называется rc dropn где количество байтов из начала ключевого потока которые следует отбросить рекомендовано использовать консервативная оценка составляет атака базируется на слабости зная первое псевдослучайное слово байтов входного ключа key используя слабость алгоритме генерации псевдо случайного слова можно получить байт входного ключа повторяя шаги добывается полный ключ при атаке на wep для iv имеет вид где от до любое число для определения около вариантов потребуется перехватить примерно миллиона пакетов атака кляйна году андреас кляйн представил анализ шифра rc котором он указал на сильную ключа ключевого потока rc кляйн проанализировал атаки на первом раунде подобные атаке фмш на втором раунде возможные их улучшения он также предложил некоторые изменения алгоритма для усиления стойкости шифра частности он утверждает что если поменять направление цикла на обратное алгоритме ключевого расписания то можно сделать шифр более стойким атакам типа фмш комбинаторная проблема году ади шамир ицхак мантин первыми поставили комбинаторную проблему связанную количеством всевозможных входных выходных данных шифра rc если из всевозможных элементов внутреннего состояния шифра известно элементов из состояния то если предположить что остальные элементы нулевые максимальное количество элементов которые могут быть получены алгоритмом за следующие раундов также равно году это предположение было доказано сорадюти полом бартом пренелем атака ванхофа писсенса летом года мэти ванхоф mathy vanhoef франк писсенс frank piessens из университета левена бельгии реальную атаку на протокол tls использующий rc для шифрования передаваемых данных идея взлома базируется на принципе mitm встроившись канал передачи данных атакующая сторона генерирует серверу большое количество запросов вынуждая его ответ возвращать куки зашифрованные одним тем же ключом имея распоряжении около пар открытый текст шифротекст атакующая сторона получила возможность на основе статистических методов флюрер макгрю absab вероятностью восстановить ключ следовательно зашифрованные куки практические временные затраты составили около часов верхняя же оценка потребного времени на момент демонстрации составила около часов модификации rc ранее рассматривались атаки основанные на коррелируемости первых байт шифрованного текста ключа подобные слабости алгоритма могут быть решены отбрасыванием начальной части шифрованного текста надёжным считается отбрасывание первых байт исследования начала шифротекста были проведены для показания ненадёжности определённого числа первых байтов что может привести получению злоумышленником ключа шифрования были предложены несколько модификаций rc выполняющие поставленную задачу усиления безопасности при использовании алгоритма rc vmpc rc rc году свет увидела работа souradyuti paul bart preneel которой предлагалась модификация rc для rc используется два блока вместо одного как rc обозначим s₁ s₂ для них соответствующе используются два счётчика j₁ j₂ счётчик как для rc используется единственном числе для всего алгоритма принцип выполнения алгоритма остается прежним но имеется ряд отличий s₁ является параметром для s₂ за одну итерацию то есть за одно увеличение индекса генерируется два байта шифротекста алгоритм j₁ j₂ while цикл генерации j₁ j₁ s₁i mod поменять местами s₁i s₁j₁ i₂ s₁i s₁j₁ mod output s₂i₂ j₂ j₂ s₂i mod поменять местами s₂i s₂j₂ i₁ s₂i s₂j₂ mod output s₁i₁ endwhile скорость шифрования данного алгоритма может быть увеличена за счёт rc году была разработана предложена модификация rc авторы subhamoy maitra goutam paul модифицировали инициализацию блока ksa использовав уровневое скремблирование также модификации был подвергнут алгоритм генерации слова prga алгоритм все арифметические операции выполняются по mod символами обозначены битовые сдвиги влево вправо соответственно символ обозначает операцию исключающее или while цикл генерации si sj si поменяли местами si sj sj output sa sc xaa endwhile реализация работа многих поточных шифров основана на линейных регистрах сдвига обратной связью это позволяет достичь высокой эффективности реализаций шифра виде интегральной схемы аппаратная реализация но затрудняет программную реализацию таких шифров поскольку шифр rc не использует lfsr основан на байтовых операциях его удобно реализовывать программно типичная реализация выполняет от до машинных команд на каждый байт текста поэтому программная реализация шифра должна работать быстро криптосистемы протоколы использующие rc wep mppe браузер opera mini протокол ssl вариативно протокол ssh вариативно протокол rdp kerberos вариативно sasl mechanism digest md вариативно формат pdf skype вариативно слово вариативно означает что rc является одним из нескольких алгоритмов шифрования которые могут использоваться системой см также vmpc примечания ссылки rsa security response to weaknesses in key scheduling algorithm of rc письмо содержащее описание алгоритма rc списке рассылки cypherpunks klein attacks on the rc stream cipher февраля года формат postscript категория потоковые шифры