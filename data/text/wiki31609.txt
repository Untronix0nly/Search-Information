fma умножение сложение однократным округлением это набор опциональных битных simd инструкций для архитектур предназначенный для выполнения операции умножения сложения над числами формате плавающей запятой существует два варианта расширений добавляющих инструкции fma fma поддерживается процессорами amd начиная архитектуры bulldozer fma было реализовано ранее fma fma поддерживается процессорами intel начиная архитектуры haswell процессорами amd начиная архитектуры piledriver особенности инструкций fma fma почти идентичная но они не являются совместимыми обе содержат simd инструкции умножения сложения для чисел плавающей точкой их поддержка компиляторах займёт некоторое время проблема совместимости разница между fma fma заключается том сколько различных операндов есть инструкции или операция fma имеет вид форма операндами fma позволяет находиться разных регистрах тогда как форма операндами fma требует чтобы находился одном из тех регистров которых находится или форма операндами делает код короче также её проще реализовать аппаратно тогда как форма операндами обеспечивает большую гибкость fma процессоры поддержкой fma intel intel представила аппаратную реализацию fma процессорах основанных на архитектуре haswell году amd процессоры amd получили поддержку fma архитектуре piledriver году новые инструкции fma инструкция операнды операция vfmadd pdy ymm ymm ymm vfmadd psy vfmadd pdx xmm xmm xmm vfmadd psx vfmadd sd xmm xmm xmm vfmadd ss xmm xmm xmm vfmadd pdy ymm ymm ymm vfmadd psy vfmadd pdx xmm xmm xmm vfmadd psx vfmadd sd xmm xmm xmm vfmadd ss xmm xmm xmm vfmadd pdy ymm ymm ymm vfmadd psy vfmadd pdx xmm xmm xmm vfmadd psx vfmadd sd xmm xmm xmm vfmadd ss xmm xmm xmm fma процессоры поддержкой fma amd amd впервые реализовала поддержку fma процессорах архитектуры bulldozer которые были представлены октябре поддержку fma имеет также архитектура piledriver начиная zen бренды ryzen epyc amd прекратило поддержку fma intel на год процессоры intel не поддерживают fma неизвестно будет ли intel поддерживать fma будущем новые инструкции fma инструкция операнды операция vfmaddpdx xmm xmm xmm xmm vfmaddpdy ymm ymm ymm ymm vfmaddpsx xmm xmm xmm xmm vfmaddpsy ymm ymm ymm ymm vfmaddsd xmm xmm xmm xmm vfmaddss xmm xmm xmm xmm история несовместимость между fma от intel fma от amd вызвана тем что обе компании изменили свои планы без согласования деталей кодирования друг другом amd изменила планы от fma сторону fma тогда как intel от fma сторону fma практически единовременно поддержка компиляторами различные компиляторы предлагают различный уровень поддержки fma gcc поддерживает fma mfma gcc также поддерживает fma mfma microsoft visual sp поддерживает fma microsoft visual поддерживает fma pathscale поддерживает fma mfma open имеет ограниченную поддержку amd open compiler suite поддерживает fma fma начиная версии компиляторы intel поддерживают только fma поддержка ассемблерах nasm получил поддержку fma версии fma версии yasm поддерживает fma fma начиная версии fasm поддерживает fma fma см также умножение сложение примечания ссылки категория инструкции категория расширения архитектуры