com модель компонентного объекта произносится как ком это технологический стандарт от компании microsoft предназначенный для создания программного обеспечения на основе компонентов объекта каждый из которых может использоваться во многих программах одновременно стандарт воплощает себе идеи полиморфизма инкапсуляции объектно стандарт com мог бы быть универсальным платформо независимым но закрепился основном на операционных системах семейства microsoft windows современных версиях windows com используется очень широко на основе com были реализованы технологии microsoft ole automation activex dcom com directx также xpcom история com стандарт com был разработан году корпорацией microsoft как основа для развития технологии ole технология ole уже позволяла создавать составные документы например пакете microsoft office эта технология позволяла включать диаграммы microsoft excel документы microsoft word путаница названиях году microsoft попыталась переименовать технологию ole activex но это удалось лишь частично например технология ole позволяла создавать так называемые элементы управления ole или ocx повторно используемые элементы интерфейса которые были построены на стандарте com эти элементы управления ole были переименованы элементы управления activex хотя расширение файлов ocx за ними осталось затем microsoft стала активно продвигать activex интернет включив поддержку элементов activex свой браузер internet explorer результате название ole осталось только за технологией составных документов локальных внедряемых объектов сетевые ole объекты стали называть по новому activex некоторая путаница между понятиями ole activex сохраняется до сих пор но речь идёт об одних тех же com технологиях причём иногда даже путают понятия ole com так внедряемые ole объекты иногда называют com объектами ole контейнеры com контейнерами поддержка ос windows windows windows windows server windows server windows server поддерживают com для windows server роль сервера приложений которая реализует com объявлена устаревшей подлежащей удалению будущих версиях принципы работы com основным понятием которым оперирует стандарт com является com компонент программы построенные на стандарте com фактически не являются автономными программами представляют собой набор между собой com компонентов каждый компонент имеет уникальный идентификатор guid может одновременно использоваться многими программами компонент взаимодействует другими программами через com интерфейсы наборы абстрактных функций свойств каждый com компонент должен как минимум поддерживать стандартный интерфейс iunknown который предоставляет базовые средства для работы компонентом интерфейс iunknown включает себя три метода queryinterface addref release windows api предоставляет базовые функции позволяющие использовать com компоненты библиотеки mfc особенно atl wtl предоставляют более гибкие удобные средства для работы com библиотека atl от microsoft до сих пор остаётся самым популярным средством создания com компонентов но зачастую com разработка остаётся ещё довольно сложным делом программистам приходится вручную выполнять многие рутинные задачи связанные com особенно это заметно случае разработки на впоследствии технологиях com особенно microsoft попыталась упростить задачу разработки com компонентов технологии основанные на стандарте com dcom выпущенная году технология dcom распределённая com основана на технологии dce rpc разновидности rpc dcom позволяет com компонентам друг другом по сети главным конкурентом dcom является другая известная распределённая технология corba как dcom так corba решают задачу вызова метода объекта расположенного на другой машине также передачу ссылки на объект одной машины на другую сетевой уровень dcom называется orpc object rpc является объектно ориентированным расширением dce rpc технология dcom обеспечивает базовые установки безопасности позволяя задавать кто из каких машин может создавать экземпляры объекта вызывать его методы com microsoft transaction server был включен option pack для windows nt еще году составе windows была выпущена технология com которая являлась новой версией microsoft transaction server технология расширяла возможности разработчиков com компонентов предоставляя им некоторые готовые услуги например автоматический пул потоков создаваемый стандартным процессом загрузчиком mtx exe доступ контексту котором выполняется компонент например компоненты используемые asp могут этой возможностью получить доступ внутренним объектам той страницы на которой они выполняются интеграция транзакциями монитора ms dtc контекст com может автоматически содержать себе транзакцию ms dtc mts com использовался внутри ряда версий веб сервера ms iis для загрузки исполнения веб приложений как бинарных по технологии isapi так скриптовых по технологии asp сама asp dll есть isapi приложение com объединяет компоненты так называемые приложения com что упрощает обслуживание компонентов безопасность основные направления com некоторые идеи заложенные основу com были также реализованы net будущее com году была официально выпущена платформа которая на сегодняшний день объявлена microsoft рекомендуемой основой для создания приложений компонентов под windows по этой причине включены средства позволяющие обращаться компонентам com из приложений наоборот по словам представителей майкрософт com точнее com являются отлично технологиями dcom через интернет решение проблемы xp sp году dcomlab опубликовал коммерческий продукт combridge при использовании combridge для работы по dcom через интернет не требуется cis не используется порт локальной сети не требуются настройки dcomcnfg combridge встраивается транспортный уровень dcom полностью выделяя весь трафик созданного объекта всех полученных из него объектов отдельный поток opc opc ole for process control семейство программных технологий предоставляющих единый интерфейс для управления объектами автоматизации процессами многие из opc протоколов базируются на windows технологиях ole activex com dcom такие opc протоколы как opc xml da opc ua являются платформо независимыми ole ole англ object linking and embedding произносится как oh lay олэй связывание встраивание объекта технология связывания внедрения объектов другие документы объекты разработанные корпорацией майкрософт ole позволяет передавать часть работы от одной программы редактирования другой возвращать результаты назад например установленная на персональном компьютере издательская система может послать некий текст на обработку текстовый редактор либо некоторое изображение редактор изображений помощью ole технологии критика технология часто критикуется за неоправданную сложность конкретно необходимость использования двух языков idl для описания интерфейсов обычно для написания реализаций необходимость возникает только при создании собственных интерфейсов не возникает случае если разработчик ограничил себя использованием готовых интерфейсов необходимость прокладочного кода его роли обычно выступает atl для того чтобы создать com объект на базе класса хотя этот код тривиален использовании для опытного человека он не очень прост для начинающих как предыдущем пункте эта проблема возникает только при написании собственных классов не возникает при одном лишь использовании стандартных чужих классов для которых microsoft разработал библиотеку смарт пойнтеров comdef эта библиотека делает использование com объектов тривиальным необходимость регистрации компонент реестре операционной системы причем при этом качестве идентификатора класса используется нечитаемый человеком guid хотя его возможно дополнить читаемым именем инфраструктура remoting удаленного вызова методов использует бинарный формат запросов ответов являясь расширением dce rpc это приводит возникновению огромной поверхности уязвимости точки зрения безопасности не раз приводило крупным эпидемиям вредоносного по msblaster инфраструктура remoting использует по умолчанию вслед за dce rpc динамически назначаемые номера tcp udp портов что делает её крайне сложной настройке при наличии межсетевых экранов обработка ошибок com принято использовать битные коды ошибки hresult которые имеют значения вроде совершенно не читаемы человеком хотя последнее время все они легко ищутся поисковыми машинами интернета кроме того runtime type information com известная под названием type libraries поддерживается только для automation compatible интерфейсов имеющих огромные ограничения на типы параметров массивы только safearray строки только bstr никаких произвольных структур только числа дата время массивы строки ссылки на другие automation compatible объекты заметно однако что многие из этих недостатков являются платой за достоинство com независимость от языка исполняющей среды не существуют истинно объектных языках таких как или же прекращенная реализация java компании microsoft эти языки предоставляют полную runtime type information отсутствие необходимости регистрации возможность написания как интерфейсов так классов стандартным для языка образом без прокладок вроде atl так ms любой класс java тривиально публиковался внешнему миру как класс com достаточно было лишь регистрации то же существует противоположной стороны истинно объектные языки либо вообще не способны стыковаться компонентами из других объектных языков требуют написания всей системы нижележащих подсистем фреймворков сверху донизу на одном языке одной исполняющей среде java objective либо же налагают такое же требование хотя не на язык но на исполняющую среду net языки managed vb net более новые аналогичные технологии например мире net пытаются решить эти проблемы там обычно стек remoting полиморфен кастомизируем что дает возможность самостоятельно выбирать формат вопросов ответов транспортный протокол по умолчанию используется уже не dce rpc soap качестве формата данных xml качестве транспорта http который не полагается на динамические номера портов использование механизма позднего связывания может существенно снизить по сравнению например вызовом экспортируемой функции из динамической библиотеки однако этот механизм применяется только скриптовых языках только том случае если язык не поддерживает объявление ссылок на объекты как ссылок на com интерфейсы из type libraries виде dim obj as excel workbook поддерживает только абстрактные com объекты виде dim obj as object кроме того такой же подход применяется objective cocoa примечания ссылки раздел разработки win com библиотеке msdn раздел com библиотеке msdn раздел com библиотеке msdn раздел dcom библиотеке msdn раздел com dcom com на сайте rsdn концепция com com интерфейсов подборка статей com литература категория технологии программного обеспечения microsoft категория объектно ориентированное категория объектные модели