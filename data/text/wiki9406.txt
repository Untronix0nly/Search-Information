selinux linux улучшенной безопасностью реализация системы принудительного контроля доступа которая может работать параллельно классической избирательной системой контроля доступа краткое описание оставаясь рамках избирательной системы контроля доступа операционная система имеет фундаментальное ограничение плане разделения доступа процессов ресурсам доступ ресурсам основывается на правах доступа пользователя это классические права rwx на трех уровнях владелец группа владелец остальные selinux права доступа определяются самой системой при помощи специально определенных политик политики работают на уровне системных вызовов применяются самим ядром но можно реализовать на уровне приложения selinux действует после классической модели безопасности linux иными словами через selinux нельзя разрешить то что запрещено через права доступа пользователей или групп политики описываются при помощи специального гибкого языка описания правил доступа большинстве случаев правила selinux прозрачны для приложений не требуется никакой их модификации состав некоторых дистрибутивов входят готовые политики которых права могут определяться на основе совпадения типов процесса субъекта файла объекта это основной механизм selinux две других формы контроля доступа доступ на основе ролей на основе многоуровневой системы безопасности например секретно совершенно секретно самый простой для работы точки зрения поддержки тип политики так называемая целевая политика разработанная рамках проекта fedora рамках политики описано более процессов которые могут выполняться операционной системе все что не описано целевой политикой выполняется домене типом unconfined_t процессы работающие этом домене не защищаются selinux таким образом все сторонние приложения будут без всяких проблем работать системе целевой политикой рамках классических разрешений избирательной системы контроля доступа кроме целевой политики состав некоторых дистрибутивов входит политика многоуровневой моделью безопасности поддержкой модели белла лападулы третий вариант политики строгий тут действует принцип что не разрешено то запрещено принцип наименьших прав политика основывается на reference policy от компании tresys selinux был разработан агентством национальной безопасности сша затем его исходные коды были представлены для скачивания selinux включён состав ядра linux начиная версии также для selinux требуются версии некоторых утилит ps ls других которые обеспечивают поддержку новых функций ядра поддержка со стороны файловой системы основные понятия домен это некоторый набор действий которые может производить один процесс главным образом это действия необходимые процессу для выполнения определенной задачи роль это совокупность нескольких доменов контекст безопасности это совокупность всех атрибутов которые связаны объектами субъектами политика безопасности это набор заданных правил который регулирует взаимодействие ролей доменов справа обзор lsm lsm модули безопасности linux представляют собой реализацию виде подгружаемых модулей ядра первую очередь lsm применяются для поддержки контроля доступа сами по себе lsm не обеспечивают систему какой то дополнительной безопасностью лишь являются неким интерфейсом для её поддержки система lsm обеспечивает реализацию функций перехватчиков которые хранятся структуре политик безопасности охватывающей основные операции защиту которых необходимо обеспечить контроль доступа систему осуществляется благодаря настроенным политикам методы управления доступом большинство операционных систем обладают средствами методами управления доступом которые свою очередь определяют может ли некий объект на уровне операционной системы пользователь или программа получить доступ определенному ресурсу используются следующие методы управления доступом дискреционный контроль доступа dac данный метод реализует ограничение доступа объектам на основе групп которым они принадлежат linux основе этого метода лежит стандартная модель контроля доступа файлам права доступа определены для следующих категорий пользователь владелец файла группа все пользователи которые являются членами группы другие все пользователи которые не являются ни владельцами файла ни членами группы причем каждой из групп предоставляются следующие права права на запись на чтение на исполнение мандатное управление доступом mac главным образом суть этого метода заключается установлении определенных прав доступа субъекта определенным объектам ос реализовано следующее программа обладает только теми возможностями которые необходимы ей для выполнения своих задач не более того данный метод имеет преимущество сравнении предыдущим если программе будет обнаружена уязвимость то возможности её доступа будут весьма ограничены контроль доступа на основе ролей rbac права доступа реализованы виде ролей выдаваемых системой безопасности роли представляют собой определенные полномочия на выполнение конкретных действий группой субъектов над объектами системе данная политика является улучшением дискреционного контроля доступа внутренняя архитектура selinux самом начале своего появления selinux была реализована виде патча данном случае было непросто настраивать политику безопасности появлением механизмов lsm настройка управление безопасностью значительно упростились политика механизмы усиления безопасности были разделены selinux была реализована виде подгружаемых модулей ядра перед доступом внутренним объектам операционной системы производится изменение кода ядра это реализуется при помощи специальных функций перехватчиков системных вызовов так называемых функций хуков функции перехватчики хранятся некоторой структуре данных их целью является выполнение определенных действий по обеспечению безопасности основанных на заранее установленной политике сам модуль включает себя шесть главных компонентов сервер безопасности кэш вектора доступа avc таблицы сетевых интерфейсов код сигнала сетевого уведомления свою виртуальную файловую систему selinuxfs реализацию функций перехватчиков кэш вектора доступа используется для кэширования вычисленных результатов хранения готовых решений управления доступом полученных из сервера безопасности нужно это для того чтобы минимизировать накладные расходы на со стороны механизмов безопасности selinux интерфейс кэша вектора доступа для сервера безопасности определен заголовочном файле include avc_ss таблица сетевых интерфейсов отображает сетевые устройства контексты безопасности поддержка отдельных таблиц необходима ввиду того что поле безопасности сетевых устройств было исключено из проекта сетевые устройства добавляются таблицу когда впервые оказываются поле видимости функций перехватчиков засекаются ими удаляются из неё когда устройство настраивается или перезагружается политика безопасности связи перенастройкой это возможно благодаря callback функциям которые регистрируют изменения конфигурации устройства перезагрузку политик безопасности код таблицы сетевых интерфейсов можно найти файле netif код события сетевого уведомления позволяет модулю selinux уведомлять процессы операционной системы случае когда политика безопасности была перезагружена эти уведомления используются пространством пользователя для поддержки совместимости ядром этот механизм возможен благодаря библиотеке selinux код события сетевого уведомления можно найти файле netlink псевдофайловая система selinux экспортирует api функции политики сервера безопасности процессы операционной системы изначально api функции ядра selinux были разделены на три компонента атрибуты процесса файловые атрибуты политика api как часть изменений для внесения версию ядра linux также selinux предоставляет поддержку политики api вызовов все три компонента api нового ядра инкапсулированы библиотеку api selinux libselinux код псевдофайловой системы можно найти файле selinuxfs реализация функций перехватчиков управляет информационной безопасностью связанной внутренними объектами ядра реализацией контроля доступа selinux для каждой операции внутри ядра функции перехватчики вызывают сервер безопасности кэш вектора доступа для получения решений политики безопасности применения этих решений для маркировки по каким либо признакам контроля объектов ядра код этих функций перехватчиков расположен файле hooks структуры данных связанные внутренними объектами определены файле include objsec возможности разные политики зависимости от поставленных задач четкая реализация политик поддержка приложений запрашивающих политику исполнение контроля доступа этих приложений для примера задача запущенная cron корректным контекстом независимые специфичные политики языковые политики selinux независимые специфичные форматы меток безопасности их содержание индивидуальные метки рычаги управления для объектов ядра сервисов демонов кэширование доступных решений для эффективности возможность изменения политик различные меры для защищенности целостности системы данных очень гибкие политики управление процессом инициализации наследование прав запуск программ управление файловыми системами папками файлами открытыми дескрипторами управление сокетами сообщениями ядра системы сетевыми интерфейсами реализации selinux доступен коммерческой поддержкой как часть red hat enterprise linux начиная версии сообществе поддерживаемые дистрибутивы linux centos debian archlinux fedora core начиная версии hardened gentoo opensuse начиная версии ubuntu rosa alt linux спт другие системы selinux представляет один из нескольких возможных подходов ограничению действий выполняемых установленным по система apparmor делает примерно то же самое что selinux одно важное различие между этими системами способ идентификации объектов файловой системы apparmor использует полный путь selinux же работает глубже используя индексный дескриптор эти различия проявляются двух случаях если файл имеет вторую незащищенную жёсткую ссылку то apparmor разрешит доступ через нее selinux откажет так как жёсткие ссылки ссылаются на один тот же индексный дескриптор если же приложение пересоздает защищенный файл что используется довольно часто приводит изменению индексного дескриптора то apparmor продолжит отказывать доступе selinux его разрешит избежать этих проблем обеих системах позволит применение политики no access по умолчанию см также lids linux intrusion detection system агентство национальной безопасности сша trustedbsd apparmor примечания литература анатомия selinux архитектура реализация developerworks тим джонс selinux бронежилет для корпоративного пингвина журнал хакер ссылки sebsd sedarwin selinux by nsa наиболее полная информация проекте selinux документация для пользователей разработчиков selinuxproject org selinux debian configurating selinux for your needs linux улучшенной безопасностью руководство пользователя рус документация fedora linux категория linux категория информационная безопасность