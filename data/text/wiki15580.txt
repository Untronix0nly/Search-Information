гост магма российский стандарт симметричного блочного шифрования принятый году полное название гост системы обработки информации защита алгоритм преобразования является примером des подобных криптосистем созданных по классической итерационной схеме фейстеля по некоторым сведениям история этого шифра гораздо более давняя алгоритм положенный впоследствии основу стандарта родился недрах восьмого главного управления кгб ссср ныне структуре фсб воронежском нии связи вероятно ещё годах рамках проектов создания программных аппаратных реализаций шифра для различных вычислительных платформ момента опубликования стандарта на нём стоял ограничительный гриф для служебного пользования формально шифр был объявлен полностью открытым только мае года история создания шифра критерии разработчиков по состоянию на год не обнародованы вместе новым алгоритмом кузнечик один из вариантов алгоритма гост был опубликован под названием магма как часть стандарта гост описание гост блочный шифр битным ключом циклами называемыми раундами преобразования оперирующий битными блоками основа алгоритма шифра сеть фейстеля выделяют четыре режима работы гост простой замены гаммирование гаммирование обратной связью режим выработки имитовставки режим простой замены функция ai ki используемая сети фейстеля для зашифровывания этом режиме битный блок открытого текста сначала разбивается на две половины младшие биты старшие биты на ом цикле используется подключ ki двоичное исключающее или для генерации подключей исходный битный ключ разбивается на восемь битных блоков ключи являются циклическим повторением ключей нумеруются от младших битов старшим ключи являются ключами после выполнения всех раундов алгоритма блоки склеиваются обратите внимание что старшим блоком становится младшим результат есть результат работы алгоритма расшифровывание выполняется так же как зашифровывание но инвертируется порядок подключей ki функция вычисляется следующим образом ai ki складываются по модулю результат разбивается на восемь битовых каждая из которых поступает на вход своего узла таблицы замен порядке возрастания старшинства битов называемого ниже блоком общее количество блоков стандарта восемь то есть столько же сколько каждый блок представляет собой перестановку чисел от до конкретный вид блоков стандарте не определен первая битная попадает на вход первого блока вторая на вход второго если узел блока выглядит так на входе блока то на выходе будет если то на выходе будет если на входе то на выходе выходы всех восьми блоков объединяются битное слово затем всё слово циклически сдвигается влево старшим разрядам на битов режим простой замены имеет следующие недостатки может применяться только для шифрования открытых текстов длиной кратной бит при шифровании одинаковых блоков открытого текста получаются одинаковые блоки шифротекста что может дать определенную информацию криптоаналитику таким образом применение гост режиме простой замены желательно лишь для шифрования ключевых данных гаммирование схема работы режиме гаммирования при работе гост режиме гаммирования описанным ниже образом формируется гамма которая затем побитно складывается по модулю исходным открытым текстом для получения шифротекста шифрование режиме гаммирования лишено недостатков присущих режиму простой замены так даже идентичные блоки исходного текста дают разный шифротекст для текстов длиной не кратной бит лишние биты гаммы отбрасываются кроме того гамма может быть выработана заранее что соответствует работе шифра поточном режиме выработка гаммы происходит на основе ключа так называемой синхропосылки которая задает начальное состояние генератора алгоритм выработки следующий синхропосылка шифруется использованием описанного алгоритма простой замены полученные значения записываются во вспомогательные разрядные регистры младшие старшие биты соответственно суммируется по модулю константой суммируется по модулю константой переписываются соответственно которые затем шифруются использованием алгоритма простой замены полученный результат является битами гаммы шаги повторяются соответствии длиной шифруемого текста для расшифровывания необходимо выработать такую же гамму после чего побитно сложить её по модулю зашифрованным текстом очевидно для этого нужно использовать ту же синхропосылку что при шифровании при этом исходя из требований уникальности гаммы нельзя использовать одну синхропосылку для шифрования нескольких массивов данных как правило синхропосылка тем или иным образом передается вместе шифротекстом особенность работы гост режиме гаммирования заключается том что при изменении одного бита шифротекста изменяется только один бит расшифрованного текста одной стороны это может оказывать положительное влияние на другой злоумышленник может внести некоторые изменения текст даже не расшифровывая его гаммирование обратной связью схема работы режиме гаммирования обратной связью алгоритм шифрования похож на режим гаммирования однако гамма формируется на основе предыдущего блока зашифрованных данных так что результат шифрования текущего блока зависит также от предыдущих блоков по этой причине данный режим работы также называют гаммированием зацеплением блоков алгоритм шифрования следующий синхропосылка заносится регистры содержимое регистров шифруется соответствии алгоритмом простой замены полученный результат является битным блоком гаммы блок гаммы побитно складывается по модулю блоком открытого текста полученный шифротекст заносится регистры операции выполняются для оставшихся блоков требующего шифрования текста при изменении одного бита шифротекста полученного использованием алгоритма гаммирования обратной связью соответствующем блоке расшифрованного текста меняется только один бит так же затрагивается последующий блок открытого текста при этом все остальные блоки остаются неизменными при использовании данного режима следует иметь виду что синхропосылку нельзя использовать повторно например при шифровании логически раздельных блоков информации сетевых пакетов секторов жёсткого диска это обусловлено тем что первый блок шифр текста получен всего лишь сложением по модулю два зашифрованной синхропосылкой таким образом знание всего лишь первых байт исходного шифрованного текста позволяют читать первые байт любого другого шифр текста после повторного использования синхропосылки режим выработки имитовставки схема выработки имитовставки этот режим не является общепринятом смысле режимом шифрования при работе режиме выработки имитовставки создаётся некоторый дополнительный блок зависящий от всего текста ключевых данных данный блок используется для проверки того что шифротекст случайно или преднамеренно не были внесены искажения это особенно важно для шифрования режиме гаммирования где злоумышленник может изменить конкретные биты даже не зная ключа однако при работе других режимах вероятные искажения нельзя обнаружить если передаваемых данных нет избыточной информации имитовставка вырабатывается для блоков открытого текста по бит алгоритм следующий блок открытых данных записывается регистры после чего подвергается преобразованию первым циклам шифрования режиме простой замены полученному результату побитно по модулю прибавляется следующий блок открытых данных последний блок при необходимости дополняется нулями сумма также шифруется соответствии пунктом после добавления шифрования последнего блока из результата выбирается имитовставка длиной бит бита номер до отсчёт начинается стандарт рекомендует выбирать исходя из того что вероятность навязывания ложных данных равна имитовставка передается по каналу связи после зашифрованных блоков для проверки принимающая сторона проводит аналогичную описанной процедуру случае несовпадения результата переданной имитовставкой все соответствующие блоков считаются ложными следует отметить что выработка имитовставки может проводиться параллельно шифрованию использованием одного из описанных выше режимов работы узлы замены блоки все восемь блоков могут быть различными некоторые считают что они могут являться дополнительным ключевым материалом увеличивающим эффективную длину ключа однако существуют применимые на практике атаки позволяющие их определить впрочем необходимости увеличении длины ключа нет бит вполне достаточно настоящее время как правило таблицы замен являются долговременным параметром схемы общим для определенной группы пользователей узлы замены определенные документом rfc идентификатор id gostr testparamset номер блока значение этот узел замены определен гост для целей тестирования данный узел замен используется приложениях цб рф oid идентификатор id gost cryptopro paramset номер блока значение данный узел замен используется cryptopro csp по умолчанию так же данный узел замен используется по верба oid идентификатор id gost cryptopro paramset номер блока значение данный узел замен используется cryptopro csp oid идентификатор id gost cryptopro paramset номер блока значение данный узел замен используется cryptopro csp oid идентификатор id gost cryptopro paramset номер блока значение данный узел замен используется cryptopro csp узел замены определенный техническим комитетом по стандартизации защита информации сокращенно тк росстандарта oid идентификатор id tc gost param номер блока значение данный узел замен предлагался тк при международной стандартизации гост составе стандарта шифрования iso iec рекомендуется отечественным разработчикам также данный блок зафиксирован новой ревизии стандарта гост тексте стандарта указывается что поставка заполнения узлов замены блоков производится установленном порядке то есть разработчиком алгоритма достоинства стандарта атаки полным перебором xsl атаки учёт не берутся так как их эффективность на данный момент полностью не доказана эффективность реализации соответственно высокое быстродействие на современных компьютерах наличие защиты от навязывания ложных данных выработка имитовставки одинаковый цикл шифрования во всех четырёх алгоритмах стандарта криптоанализ считается что гост устойчив таким широко применяемым методам как линейный криптоанализ обратный порядок использования ключей последних восьми раундах обеспечивает защиту от атак скольжения slide attack отражения reflection attack ростовцев маховенко филиппов чечулин своей работе описали вид криптоанализа который сводится построению алгебраической целевой функции нахождению её экстремума были выделены классы слабых ключей частности показано что разреженные ключи со значительным преобладанием или являются слабыми по мнению авторов их метод любом случае лучше чем полный перебор однако без численных оценок мае года известный криптоаналитик николя куртуа доказал существование атаки на данный шифр имеющей сложность раз меньше сложности прямого перебора ключей при условии наличия пар открытый текст закрытый текст данная атака не может быть осуществлена на практике ввиду слишком высокой вычислительной сложности более того знание пар открытый текст закрытый текст очевидно позволяет читать зашифрованные тексты даже не вычисляя ключа большинстве других работ также описываются атаки применимые только при некоторых предположениях таких как определенный вид ключей или таблиц замен некоторая модификация исходного алгоритма или же требующие все ещё недостижимых объёмов памяти или вычислений вопрос наличии применимых на практике атак без использования слабости отдельных ключей или таблиц замены остается открытым критика стандарта основные проблемы стандарта связаны неполнотой стандарта части генерации ключей таблиц замен считается что стандарта существуют слабые ключи таблицы замен но стандарте не описываются критерии выбора отсева слабых октябре года на заседании го объединённого технического комитета международной организации по стандартизации iso iec jtc sc гост был выдвинут на включение международный стандарт блочного шифрования iso iec связи этим январе года были сформированы фиксированные наборы узлов замены их свойства однако гост не был принят качестве стандарта соответствующие таблицы замен не были опубликованы таким образом существующий стандарт не специфицирует алгоритм генерации таблицы замен блоков одной стороны это может являться дополнительной секретной информацией помимо ключа другой поднимает ряд проблем нельзя определить криптостойкость алгоритма не зная заранее таблицы замен реализации алгоритма от различных производителей могут использовать разные таблицы замен могут быть несовместимы между собой возможность преднамеренного предоставления слабых таблиц замен лицензирующими органами рф потенциальная возможность отсутствие запрета стандарте использования таблиц замены которых узлы не являются перестановками что может привести чрезвычайному снижению стойкости шифра возможные применения использование mime pkcs cryptographic message syntax использование для защиты соединений tls ssl https web использование для защиты сообщений xml encryption примечания см также имитовставка имитозащита des гост гост кузнечик шифр литература спесивцев вегнер крутяков др защита информации персональных эвм радио связь мп веста ссылки категория сеть фейстеля категория гост