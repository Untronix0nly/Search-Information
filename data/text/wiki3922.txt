microsoft visual basic язык также интегрированная среда разработки программного обеспечения разрабатываемые корпорацией microsoft язык visual basic унаследовал дух стиль отчасти синтаксис своего предка языка basic которого есть немало диалектов то же время visual basic сочетает себе процедуры элементы объектно ориентированных компонентно ориентированных языков интегрированная среда разработки vb включает инструменты для визуального проектирования интерфейса редактор кода возможностью intellisense подсветкой синтаксиса также инструменты для отладки приложений visual basic также является хорошим средством быстрой разработки rad приложений баз данных для операционных систем семейства microsoft windows множество готовых компонентов поставляемых вместе со средой призваны помочь программисту сразу же начать разрабатывать бизнес логику приложения не отвлекая его внимание на написание кода запуска программы подписки на события других механизмов которые vb реализует автоматически первое признание серьёзными разработчиками visual basic получил после выхода версии окончательное признание как полноценного средства для windows при выходе версии версия vb входящая состав microsoft visual studio стала по настоящему зрелым функционально богатым продуктом история развития справа справа справа справа справа дата выпуска версия описание май visual basic для microsoft windows за основу языка был взят синтаксис qbasic новшеством принесшим затем языку огромную популярность явился принцип связи языка графического интерфейса этот принцип был разработан аланом купером alan cooper реализован прототипе tripod также известном как ruby сентябрь visual basic под dos он не был полностью совместим windows версией vb поскольку являлся следующей версией quickbasic работал текстовом режиме экрана интересно отметить что составе была специальная утилита которая конвертировала проекты данной версии проекты visual basic для windows она делала код максимально совместимым windows версией конвертировала формы хотя результат получался из за различий текстового графического режима также давала коде комментарии подсказками по дальнейшему улучшению ноябрь visual basic среда разработки стала проще использовании работала быстрее окно свойства переместилось отдельный список добавлена подсветка исходного кода вышел свет visual basic версиях standard professional ко всему прочему состав поставки добавился движок для работы базами данных access август visual basic версия которая могла создавать как так разрядные windows приложения кроме того появилась возможность писать на vb классы также visual basic наконец то стал полноценным компилятором что значительно увеличило скорость выполнения программ добавлена поддержка ole controls ocx взамен старым элементам управления февраль visual basic начиная этой версии стало возможно наряду обычными приложениями разрабатывать свои com компоненты скомпилировав такой компонент ocx файл поставляя его можно было предоставить свой объект управления не только конечному пользователю но другим разработчикам после чего они могли интегрировать этот объект свои приложения составе интегрированной средой входят code native компиляторы исполнением приложений занимается новая виртуальная машина реализованная динамической библиотеке msvbvm dll также квартале этого года microsoft выпускает продукт специальной редакции visual basic control creation edition vb cce который только над проектированием activex элементов управления середина visual basic оптимизирована работы виртуальной машины вынесена msvbvm dll улучшена работа native компилятора добавлены новые функции для работы со строками массивами данная версия языка является последней линейке классического vb microsoft изменила политику отношении языков семейства basic вместо развития visual basic был создан абсолютно новый язык visual basic net первый выпуск visual basic net наиболее важная особенность заключается том что код полностью управляем платформой net framework common language runtime нарушена обратная совместимость классической версией visual basic апрель microsoft модернизирована visual basic net оптимизировала работу компилятора выпущен совместно обновлённой версией net framework входит состав visual studio требует net framework после выхода visual basic net microsoft убрала приставку net из названия продукта следующая версия называется visual basic входит состав visual studio требует net framework входит состав visual studio требует net framework входит состав visual studio требует net framework входит состав visual studio требует net framework входит состав visual studio обновлен net framework до версии входит состав visual studio после выхода visual basic версии разработчики из microsoft существенно изменили направление развития данной технологии visual basic net не позволяет программировать по старому потому что по сути является совершенно другим языком таким же как любой другой язык для платформы net языка так же как его преимущества простота скорость создания программ лёгкость использования готовых компонентов при использовании среде net не имеют такого значения как раньше всё сосредоточено на возможностях самой платформы net на её библиотеках классов на данный момент июнь нужно говорить visual basic как классических версиях языка его диалектах visual basic for applications vba visual basic scripting edition vbscript языке для платформы net visual basic net элементы языка типы данных переменные visual basic объявляются оператором dim после которого указывается имя затем ключевое слово as тип переменной если тип опущен то ключевое слово as не указывается переменная объявляется как variant если не указать конструкцию option explicit разделе деклараций то явного объявления переменных не требуется они автоматически будут созданы при первом использовании данное поведение может привести снижению скорости выполнения программы так как необъявленные переменные будут иметь тип variant также возможны логические ошибки связанные неверным вводом имени имеющейся переменной или риска конфликтов приложении когда область определения переменной не совсем ясна dim strmessage as string объявление переменной символьного типа dim iproductcount as integer объявление переменной целочисленного типа dim dt yearsofvictory as date объявление переменной для хранения даты времени dim othervalue тип не указан переменная типа variant public sub main strmessage привет мир iproductcount dt yearsofvictory pm дата мая othervalue тип переменной variant подтип double othervalue википедия тип переменной variant подтип string end sub таблица основных типов visual basic наименование размер типа описание типа данных byte байт байт предназначен для хранения целых чисел от до если переменной такого типа присвоить значение выходящее за эти пределы то visual basic сгенерирует ошибку времени выполнения integer байта целое предназначен для хранения целых чисел диапазоне до суффикс для обозначения типа long байта длинное целое предназначен для хранения целых чисел диапазоне до суффикс для обозначения типа single байта плавающей точкой одинарной точности диапазон от до для отрицательных значений от до для положительных значений суффикс для обозначения типа double байт плавающей точкой двойной точности переменные этого типа позволяют хранить числа точностью до цифр длиной до символов диапазон значений варьируется от до суффиксом является вычисления ним являются так как используется бинарное представление числа согласно стандарта ieee decimal байт масштабируемое целое этот тип использует десятичное представление чисел вычисления ним также как типом currency являются точными диапазон значений от до нельзя напрямую объявить переменную типом decimal он может использоваться только как подтип для variant переменную можно привести данному типу помощью функции кастования cdec boolean байта булев тип данных может хранить только два значения true либо false истина или ложь истинное значение vb соответствует целочисленной ложь равна при неявном приведении типа любое численное значение отличное от нуля рассматривается как истина такое поведение позволяет использовать логические операторы and or not xor не только для булевой алгебры но также для битовых операций string байт строка переменной длины предназначен для хранения строковой символьной информации сама строка хранится кодировке unicode поэтому каждый символ кодируется байтами если посмотреть тип изнутри то используется дополнительно байта для хранения указателя на строку байта для размера строки сама строка завершается нуль символами ещё байта таким образом максимальный размер строки может достигать до гбайт суффикс типа string байт строка постоянной длины также как тип string хранит символьные данные за исключением того что размер данных фиксированный указывается при объявлении переменной если значение строки слишком большое то она усекается до необходимого размера если строка меньше чем требуется то происходит выравнивание размера добавлением символа пробела следует заметить что фиксированные строки массивы также структуры не могут быть больше кб date байт тип данных позволяет хранить значения времени даты промежутке от полуночи января года до полуночи декабря года если переменной присвается только значение даты то время равняется целочисленная единица представляет собой одни сутки это позволяет добавлять вычитать даты используя только математические операторы но для выполнения этих целей vb предоставляет функции работы датами object байта используется для хранения ссылки на объект присваивание переменной для этого типа происходит помощью оператора set сам тип является аналогом idispatch нем хранится ссылка на интерфейс idispatch для любого объекта нужно использовать iunknown currency байт денежный данный тип может иметь до цифр после запятой до перед ней значение представляют собой числа десятичной системе счисления не двоичной как это происходит для типов плавающей запятой одинарной двойной точности таким образом вычисления будут произведены точно диапазон значений от до данный тип является для проведения финансовых расчетов суффикс variant байт байта байт байт переменная типа variant может содержать данные любого типа включая ссылки на объекты типы массивы visual basic автоматически производит необходимые преобразования данных подтип содержащий число требует байт памяти для хранения строковых данных байта длина самой строки диапазон значений равен диапазону значений подтипа данный тип самый медленный по скорости выполнения так как требуется время на распаковку упаковку значений операторы язык visual basic содержит множество операторов которые отвечают за арифметические операции операции сравнения присвоения также конкатенации оператор присвоения знак равенства используется для присвоения значения переменной также возможно использование ключевого слова let перед именем переменной ранних версиях языка basic его наличие было обязательным но visual basic он оставлен для совместимости для присвоения переменной объектного типа необходимо наличие ключевого слова set примеры nvar let icount set refdouble objclass многократное присваивание так как это реализовано языке невозможно не означает что будут иметь равные значения vb оценит выражение переменную присвоит результат true или false или зависимости от типа арифметические операторы сложение вычитание умножение деление возведение степень пример целочисленное деление делит первое число на второе отбрасывая не округляя дробную часть пример деление по модулю mod делит первое число на второе возвращая только остаток от деления пример mod операторы сравнения равенство пример if nvar then больше чем меньше чем if nvar then больше или равно меньше или равно if nvar then не равно пример if nvar then сравнение объектов is определяет ссылаются объектные переменные на тот же объект или на разные пример if obj is obj then оператор подобия like сравнивает строковый объект шаблоном определяет подходит ли шаблон пример if stremail like then логические операторы логическое and обе части выражения должны быть истинными чтобы всё выражение стало истинным пример if and then логическое или or должно быть истинным хотя бы одно из выражений пример if or then логическое отрицание not возвращает true если условие ложно наоборот пример if not then логическое исключение xor выражении xor возвращает true если только true или только true иначе false эквивалентность eqv оценивает эквивалентность двух выражений возвращает true если они имеют одинаковое значение импликация imp возвращает false если true false иначе true операторы конкатенации оператор используется для конкатенации строк если обе части выражения имеют символьный тип то операция склеивания строк будет успешной если одна из частей выражения имеет числовой тип но другая часть не может быть корректно преобразована числу то возникает ошибка приведения типов чтобы не допустить таких ситуаций рекомендуется использовать соответствующие операторы для конвертации типов или применять оператор для соединения строк оператор производит автоматическое преобразование выражений значений строковой тип например выражение str даёт результат не если бы использовали оператор данном выражении то vb привел бы выражение числовому типу случае успеха произвёл бы арифметическое сложение управляющие конструкции visual basic как во многих языках существуют конструкции предназначенные для управления порядком выполнения действий некоторые из конструкций такие как gosub return оставлены для совместимости ранними версиями языка basic но реализация виде отдельных процедур может обеспечить более код оператор ветвления общий синтаксис запись оператора ветвления одну строку if then такая запись позволит выполнить действия зависимости от истинности условия if then else запись оператора ветвления несколько строк if then elseif then elseif then else end if оператор выбора общий синтаксис select case переменная или выражение которое требуется проверить по одному или нескольким условиям case выполняется действие если проверяемое значение будет соответствовать значению действие_ case проверяет список значений если найдено соответствие то выполняется действие действие_ case to проверяет диапазон значений действие_ case is проверяет значение на истинность условием действие_ case else выполняется действие если ни одно из условий не выполнится действие_ end select пример вывод различных сообщений зависимости от значения переменной введём переменную дадим ей значение вручную dim as double inputbox введите числовое значение переменной select case проверим подходит ли некоторой воображаемой функции наше значение case is to диапазон подходящих значений msgbox действительное значение для некоторой функции case else не подходящие значения msgbox значение не может быть использовано некоторой функции end select цикл со счётчиком общий синтаксис for to step блок_операторов exit for выход из цикла next переменная пример подсчёт суммы чётных чисел от до for to step sum sum next совместный цикл общий синтаксис for each in блок_операторов exit for принудительный выход из цикла next переменная пример выводит на экран каждый элемент из массива dim stritem as variant for each stritem in array яблоко груша слива print stritem next цикл условием общий синтаксис do while цикл выполняется когда условие истинно блок_операторов exit do принудительный выход из цикла loop do until цикл выполняется когда условие ложно блок_операторов exit do loop while цикл выполняется когда условие истинно блок_операторов wend пример построчное чтение текстового файла open file txt for input as do while not eof возвратит true если ожидается конец файла line input strbuffer чтение строки переменную debug print strbuffer вывод окно отладки loop close цикл постусловием общий синтаксис do блок_операторов exit do loop while do блок операторов exit do loop until процедуры функции подпрограммы являются одними из основных элементов языка они представляют собой процедуры функции процедура начинается оператора sub заканчивается end sub между которыми помещается код процедуры могут вызываться или самим visual basic например реализованные виде обработчиков событий или другими процедурами функциями имя процедуры обработки события состоит из имени объекта знака подчёркивания имени события private sub command событие будет вызвано при нажатии на элемент управления кнопка end sub private sub form_mousemove button as integer shift as integer as single as single вызывается при перемещении указателя мыши окне формы end sub на самом деле visual basic реализует цикл обработки оконных сообщений windows примере формой цикл отфильтрует сообщение wm_mousemove автоматически вызовет процедуру form_mousemove параметрами какие кнопки мыши были нажаты координаты указателя данный механизм скрывает от разработчика некоторые аспекты среде windows позволяя ему сразу приступить написанию кода большинстве случаев класс решаемых задач не потребует от программиста знаний сообщениях оконных функциях но visual basic не ограничивает программиста самому реализовать обработку оконных сообщений это позволяет очень гибко подходить построению приложений но потребует достаточного опыта для написания подобного кода который может вызвать нестабильную работу программы вплоть до аварийного завершения функции vb начинаются ключевого слова function заканчиваются end function возвращаемое значение функции присваивается переменной совпадающее названием функции для того чтобы досрочно прервать выполнение процедуры или функции существуют специальные операторы exit sub exit function visual basic содержит встроенные функции для работы файловой системой датой временем математические функции функции взаимодействия системой функции для работы со строками функции приведения типов функции осуществляющие финансовые расчёты также существуют функции которые позволяют работать например указателями пример функции для решения квадратного уравнения private sub main dim retx as double retx as double dim strstatus as string strstatus retx retx решение уравнения выводим ответ msgbox решение strstatus vbcrlf retx vbcrlf retx vbinformation end sub функция решения квадратного уравнения public function byval as double byval as double byval as double byref as double byref as double as string dim as double получаем значение дискриминанта if then sqr вычисляем корни уравнения sqr решение получено функция возвращает сообщение решении else дискриминант этом примере можно заметить модификатор byval перед аргументами это способствует тому что параметры функцию будут переданы по значению модификатор byref напротив передаёт значение по ссылке для такого типа модификатора функция может модифицировать значения переменных переданных качестве параметров visual basic по умолчанию всегда передаёт значения по ссылке если ни один из модификаторов не был указан модули классы программный код visual basic хранится модулях существуют три вида модулей модуль формы form стандартный модуль module модуль класса class module модуль формы расширение файла frm является основой большинства приложений visual basic модуль формы содержит процедуры обработки события общие процедуры объявленные на уровне формы переменные константы типы внешние процедуры если открыть модуль формы текстовом редакторе можно увидеть описания формы её элементов управления включая их свойства код размещённый модуле формы может ссылаться на другие формы или объекты приложения стандартный модуль расширение файла bas является контейнером для процедур функций объявлений которым обычно получают доступ другие модули приложения они могут содержать глобальную переменную доступную всему приложению или описанные на уровне модуля переменные константы типы внешние глобальные процедуры код размещённый стандартном модуле может быть не связан определенным приложением если не использовать ссылки на модуль формы или имена элементов управления стандартный модуль может быть использован других приложениях модуль класса расширение файла cls является основой объектно visual basic модуль класса используется для создания новых объектов эти объекты могут иметь собственные свойства методы события фактически форма просто модуль класса который может содержать элементы управления помещенные него выводить их на экран классы могут содержать специальные процедуры class_terminate которые фактически являются конструктором деструктором объектно ориентированное простое взаимодействие между объектами является одним из базовых составляющих парадигмы visual basic сам объект называется экземпляром класса объектная модель vb предоставляет различные классы для работы формами элементами управления буфером обмена коллекциями экраном для взаимодействия другими объектами класс предоставляет разработчику интерфейс состоящий из свойств методов событий создание нового объекта из класса возможно ранним или поздним связыванием для раннего связывания используется ключевое слово new перед именем класса для позднего связывания используется функция createobject возвращающая ссылку на созданный объект присваивание ссылок осуществляется переменные типом object используя оператор set доступ методам свойствам класса происходит через оператор точку который ставится сразу после имени переменной объектного типа если класс содержит события то переменные объявляются ключевым словом withevents тем самым будут доступны процедуры обработки событий пример показывает взаимодействие программы библиотекой microsoft scripting runtime предоставляющая объекты для работы файловой системой public sub main dim objfso as new создаём экземпляр класса используя оператор new dim objwindows as folder set objwindows objfso getfolder environ systemroot вызываем метод класса getfolder присваиваем ссылку на полученный объект msgbox папка windows objwindows path читаем свойства класса msgbox дата создания format objwindows datecreated yyyy mm dd mm ss dim stextfilepath as string dim objts as textstream stextfilepath objfso buildpath environ temp тестовый файл txt метод двумя параметрам возвращает значение типа string set objts objfso createtextfile stextfilepath true objts write привет википедия objts close objfso deletefile stextfilepath true set objfso nothing присваивая nothing происходит освобождение ссылки объект может вызвать процедуру деструктора set objwindows nothing vb автоматически вызывает деструктор если на объект больше не ссылаются set objts nothing end sub visual basic позволяет разработчику самому создавать новые классы отличие от других языков таких как java visual basic имеет неполную поддержку ооп как известно абстрактный класс необходим чтобы предоставить шаблон для интерфейса другим классам visual basic классы имеющие члены класса но не содержащие реализацию можно использовать качестве абстрактных классов но фактически они ими не являются из классов visual basic всегда можно создать объекты даже если они не содержат кода принцип инкапсуляции действует visual basic чтобы разграничить доступ членам класса служат модификаторы public private friend используемые при описании процедур функций констант переменных типов наследование реализации не поддерживается visual basic обеспечивает только поддержку наследования интерфейса через оператор implements при наследовании интерфейса любой класс может действовать как базовый класс интерфейса вообще любой класс может выступать как базовый класс интерфейса полиморфизм обеспечивается только через интерфейсы так как наследование vb не поддерживает реализация полиморфизма показана на примере классов автомобиль самолёт реализующие интерфейс класса транспорт класс itransport cls public function getmaxspeed as long end function класс cauto cls implements itransport наследуем интерфейс private function as long реализация метода end function класс cfly cls implements itransport private function as long end function стандартный модуль program bas option explicit public sub main dim as itransport объявляем переменную типом itransport set new cauto передаем ссылку процедуру которая вызовет нужный метод класса зависимости от реализации set new cfly end sub функция имеет аргумент который принимает ссылку на объект реализующий интерфейс itransport public sub transport as itransport msgbox максимальная скорость transport getmaxspeed end sub дизайнер форм редактор кода редактор кода представляет собой текстовый редактор дополнительными функциями для простого быстрого ввода исходного кода подсветка синтаксиса исходного кода горизонтальное разделение окна на панели показ всего исходного кода или конкретной процедуры перечислений объектов используемых программе со списком событий которые разработчик может обработать автоизменение регистра букв первая буква ключевых слов указываются верхнем регистре регистр имён переменных автоматически изменяется чтобы соответствовать регистру которое было задано при их объявленени автодополнение названий функций процедур переменных используя intellisense проверка кода на наличие синтаксических ошибок умная табуляция блоков отладка справа интегрированная среда разработки предоставляет программисту богатые возможности для отладки программ одно из преимуществ visual basic заключается возможности изменять значительной мере исходный код программы без её полной перекомпиляции перезапуска во время отладки процедур разработчику предоставляется возможность перемещать маркер указывающий на текущую выполняемую инструкцию как вперёд пропуская часть кода так назад заставляя vb заново исполнять уже отработанные инструкции кроме всего прочего среда предоставляет инструменты для отладки такие как окно немедленного выполнения immediate window окно локальных переменных locals window окно наблюдения watch window окно просмотра стека вызовов процедур call stack такие продвинутые средства позволяют программисту более глубже проводить анализ исследуемого алгоритма отлаживаемом приложении visual basic переходит режим отладки при выполнении одного из условий при выполнении инструкции stop при выполнении инструкции на которую установлена точка останова брейкпоинт при возникновении ошибки для которой не найден подходящий обработчик ошибок при нажатии горячих клавиш ctrl break компиляция комплекте интегрированной средой разработки идёт компилятор code код нативный back end совместимый компилятор линковщик наличие двух компиляторов позволяет отнести visual basic как компилируемому так языку вне зависимости от того какой из компиляторов будет выбран приложения требуют для своего запуска виртуальную машину времени выполнения visual basic которая представляет собой библиотеку msvbvmxx dll где xx версия языка код позволяет выполняться приложению на аппаратно независимой виртуальной машине которая реальном времени будет транслировать псевдо код программы машинный код процессора теоретически такой подход позволяет осуществить переносимость приложений на новые аппаратные платформы не требуя доработки исходного кода самих программ одно из главных преимуществ связанное компиляцией code является горячее изменение исходного кода режиме отладки visual basic находясь режиме отладки всегда компилирует программу код далее выполнение может быть приостановлено программистом вносятся значительные изменения исходный код затем продолжается выполнение полная перекомпиляция перезапуск приложения при этом не требуется компилятор создаёт исполняемый файл формате pe но вместо инструкций для реального процессора содержится код виртуальную машину байт код приложения главным недостатком компиляции код является низкая скорость выполнения программ так как большая часть времени тратится на трансляцию программы машинный код native компиляция стала возможна выходом visual basic данный компилятор позволяет создавать код по сравнению приложениями которые были собраны код машинный код компилируются большинство инструкций арифметические операции управляющие конструкции но такие действия как вызов встроенных функций языка работа со строками обработка ошибок будут выполняться библиотекой времени выполнения visual basic таким образом несмотря на компиляцию машинный код приложение для своего выполнения будет требовать виртуальную машину visual basic также частый вызов функций из библиотеки времени выполнения приводит ухудшению скорости выполнения приложения но несмотря на все недостатки native компилятор обеспечивает приемлемую скорость выполнения кода компилятор содержит несколько параметров оптимизации на вкладке компиляции проекта можно отключить некоторые проверочные операции выход за пределы массива целочисленное переполнение др правильная настройка этих параметров позволяет разработчику получить дополнительный прирост разрабатываемом приложении развёртывание совместно microsoft visual basic поставляется package deployment wizard предназначенный для создания установочных пакетов на основе проекта visual basic сравнении со своим хорошо известным setup wizard wizard предоставляет новую но сожалению новый инструмент содержит некоторые ошибки одной из проблем данного приложения является ошибка преобразования даты если локаль установленная операционной системе пользователя будет отличной от американской существуют сторонние приложения которые предоставляют более продвинутые средства для управления установочными пакетами также возможен вариант установки vb приложений простым копированием который сводится выполнению нескольких шагов если системном каталоге операционной системы отсутствует файл времени выполнения приложений visual basic msvbvm dll то необходимо предварительно его скопировать туда если приложение содержит нестандартные элементы управления такие как activex controls то предварительно необходимо их скопировать системный каталог произвести регистрацию системном реестре microsoft windows регистрацию компонент можно например выполнить команду regsvr exe передать полный путь файлу или программным способом непосредственно вызвав метод который реализует com совместимая компонента создать программную папку скопировать исполняемый файл при необходимости создать ярлык приложения на рабочем столе пользователя дополнительные возможности activex элементы управления ocx начиная версии vb разработчику предоставляется возможность не только использовать готовые компоненты activex но создавать свои vb берёт на себя всю работу по созданию кода который предназначен для регистрации информации компоненте системном реестре реализации интерфейса idispatch создания уникальных guid используемых качестве идентификаторов для классов clsid интерфейсов iid библиотек типов libid благодаря такому подходу от программиста потребуется только создать классы необходимым функционалом создание новых guid класса интерфейса зависит от установленного параметра совместимости на вкладке свойств проекта он может принимать одно из трех состояний без совместимости visual basic создает новые идентификаторы интерфейса класса каждый раз при построении или компиляции проекта каждое построение компоненты может использоваться только приложениями созданными для работы конкретной версией этой компоненты то есть если имя класса проекта не будет изменено во время компиляции то сгенерируются новые идентификаторы они перепишут информацию реестре таким образом приложения ссылающиеся на старые идентификаторы не смогут запуститься совместимость на уровне проекта параметр предназначен для поддержания совместимости во время тестирования чтобы после создании компоненты было поведение такое же словно установлен параметр без совместимости двоичная совместимость при компиляции проекта visual basic создает новые идентификаторы при необходимости сохраняются идентификаторы класса интерфейса из предыдущих версий компоненты изменение реализации метода не меняет идентификаторы также добавление нового класса методов не изменяет существующей интерфейс таким образом старые приложения могут использовать старый интерфейс компоненты новые приложения могут ссылаться на новую версию интерфейса если изменяется метод или удаляется из интерфейса то vb предупредит несоответствии интерфейсом компоненты рекомендует произвести перекомпиляцию приложений после завершения компиляции на выходе будет двоичный файл библиотеки по спецификации com данный компонент реализует как минимум интерфейса iunknown idispatch библиотека типов tlb будет интегрированна внутри ресурсов исполняемого файла также дополнительно создаются файлы полезной информацией такие как exp lib windows api прикладной интерфейс visual basic предоставляет языковые средства для декларации вызова функции из библиотек динамической компоновки dll данный механизм позволяет расширять приложения за счёт использования дополнительных библиотек предоставляемых другими разработчиками том числе написанные на различных языках один из таких наборов библиотек предоставляется операционной системой microsoft windows общий синтаксис декларации функции процедуры выглядит следующим образом private declare sub lib alias псевдоним параметры private declare function lib alias псевдоним параметры as тип_возврата псевдонимы необходимо задавать ряде случаев использование названии функции идентификаторов visual basic название содержат недопустимые символы или не могут быть правильно средой вызываемые функции должны поддерживать соглашение вызове stdcall при передаче параметра типом string функцию winapi vb осуществляет автоматическую конвертацию кодировки из unicode ansi после выполнения функции происходит обратная конвертация из ansi unicode чтобы исключить автоматическую конвертацию строк аргументы функции необходимо задекларировать типом long передавать указатель на строку используя функцию strptr таким образом можно оптимизировать приложения выполняющее множественные вызовы функций пример вызова windows api для получение полного пути каталогу windows вывода сообщения на экран private declare function lib kernel dll alias byval buffer as string byval nsize as long as long private declare function messagebox lib user dll alias messageboxa byval hwnd as long byval lptext as string byval lpcaption as string byval wtype as long as long private const mb_iconasterisk as long public sub main dim buffer as string переменная которую будет получен результат функции dim retlen as long buffer string vbnullchar lens buffer len buffer вызов функции buffer left buffer lens messagebox ос установлена каталог buffer информация mb_iconasterisk вызов функции end sub следует учесть что вызов функций winapi связан определенными внутренними соглашениями именно каким образом функция будет возвращать результат какие структуры необходимо ей передать количество аргументов их типы что будет содержаться возвращаемом значении разработчики используют техническую документацию предоставляемую вместе библиотеками которыми они работают чтобы правильно задекларировать функции структуры достоинства недостатки достоинства высокая скорость создания приложений графическим интерфейсом для microsoft windows простой синтаксис языка обеспечивает низкий порог вхождения возможность компиляции как машинный код так код по выбору программиста безопасность типов обеспечивает защита от ошибок связанных применением указателей доступом памяти этот аспект делает visual basic приложения более стабильными но также является объектом критики возможность использования большинства winapi функций для расширения функциональных возможностей приложения данный вопрос наиболее полно исследован дэном эпплманом написавшим книгу visual basic programmer guide to the win api недостатки поддержка операционных систем только семейства windows mac os исключение vb for dos отсутствие полноценного механизма наследования реализации объектов существующее языке наследование позволяет наследовать только интерфейсы но не их реализацию практически все встроенные функции языка реализованы через библиотеку времени исполнения которая свою очередь производит много дополнительной работы по проверке или преобразованию типов что замедляет скорость работы приложений язык сильно привязан своей среде разработки операционной системе microsoft windows являясь исключительно инструментом написания windows приложений привязка среде заключается том что существует большое количество средств предназначенных для помощи удобства встроенный отладчик просмотр переменных структур данных на лету окно отладки всплывающие подсказки при наборе текста программы intellisense все эти преимущества делают бесполезным даже невозможным использование visual basic вне среды разработки например обычном текстовом редакторе критика часто критике подвергаются такие аспекты visual basic как возможность отключить средства слежения за объявленными переменными возможность неявного преобразования переменных наличие типа данных variant по мнению критиков это даёт возможность писать крайне плохой код другой стороны это можно рассматривать как плюс так как vb не навязывает хороший стиль даёт больше свободы программисту отсутствие указателей низкоуровневого доступа памяти asm вставок невозможность экспорта функций нативных библиотеках отсутствие стандартных средств разработки консольных приложений несмотря на то что парадигма visual basic позволяет среднему vb программисту обходиться без всего этого перечисленные вещи также нередко становятся объектами критики хотя используя возможности определённые ухищрения всё это можно реализовать на vb например помощью функций для получения указателей varptr strptr objptr пользоваться этими трюками иногда сложнее чем например на однако стоит отметить что все недостатки языка вытекают из его основного достоинства простоты разработки графического интерфейса поэтому многие программисты используют visual basic для разработки интерфейса пользователя программы реализуют виде динамически подключаемых библиотек dll написанных на других языках например реализации диалекты visual basic for applications vba это среда разработки практически не отличается от классического visual basic которая предназначена для написания макросов других прикладных программ для конкретных приложений наибольшую популярность получил благодаря своему использованию пакете microsoft office широкое распространение visual basic for applications сочетании изначально недостаточным вниманием вопросам безопасности привело широкому распространению макровирусов особенности не позволяет компилировать приложения исполняемые файлы exe dll для выполнения приложений современной среде требуются корректные настройки безопасности макросов приложении которое является хостом для vba отсутствуют некоторые объекты такие как clipboard app form timer data вместо них предоставляются другие классы реализованные объектной модели конкретного приложения visual basic scripting edition vbscript скриптовый язык являющийся несколько усечённой версией обычного visual basic используется основном для автоматизации систем microsoft windows также для создания страниц asp сценариев для internet explorer особенности отсутствуют операторы для работы файловой системой нет возможности объявить переменную конкретным типом данных все переменные имеют тип variant возможно использовать только позднее связывание для работы внешними библиотеками компиляция кода исполняемые файлы отсутствует исходный код хранится текстовых файлах расширением vbs или vbe embedded visual basic evb данный инструмент используется для разработки программного обеспечения под операционные системы windows ce windows mobile включает себя интегрированную среду разработки отладчик эмулятор для тестирования приложений embedded visual basic базируется не на языке visual basic на языке описания сценариев visual basic scripting edition приложения компилируются код исполняемые файлы имеют расширение vb которые ассоциированы хост приложением особенности все переменные по умолчанию относятся виду variant строгий контроль типов не поддерживается разработка activex элементов управления не поддерживается но возможно использование готовых ряд встроенных элементов управления visual basic не поддерживается некоторые свойства отсутствуют требуется наличие библиотек embedded visual basic runtime для запуска приложений см также visual basic net visual basic for applications gambas примечания рекомендуемая литература категория объектно ориентированные языки категория бейсик категория microsoft visual studio