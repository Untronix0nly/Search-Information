pppoe сетевой протокол канального уровня второй уровень сетевой модели osi передачи кадров ppp через ethernet основном используется xdsl сервисами предоставляет дополнительные возможности аутентификация сжатие данных шифрование стандартное mtu протокола ниже чем на стандартном ethernet ethernet байт pppoe байт что иногда вызывает проблемы плохо настроенными межсетевыми экранами pppoe это туннелирующий протокол который позволяет настраивать или инкапсулировать ip или другие протоколы которые настраиваются на ppp через соединения ethernet но программными возможностями ppp соединений поэтому используется для виртуальных звонков на соседнюю ethernet машину устанавливает соединение точку которое используется для транспортировки ip пакетов работающее возможностями ppp это позволяет применять традиционное ppp ориентированное по для настройки соединения которое использует не канал пакетно ориентированную сеть как ethernet чтобы организовать классическое соединение логином паролем для интернет соединений также ip адрес по другую сторону соединения назначается только когда pppoe соединение открыто допуская динамическое ip адресов pppoe разработан uunet redback networks routerware протокол описан rfc стоит отметить что некоторые поставщики оборудования cisco juniper например используют термин pppoeoe pppoe over ethernet означающий pppoe работающий напрямую через ethernet или другие ieee сети также pppoe работающий через связанные ethernet ethernet bridged over atm для того чтобы отличать от pppoeoa pppoe over atm который работает на atm virtual circuit по спецификации rfc snap инкапсулирует pppoe pppoeoa это не то же самое что point to point protocol over atm pppoa поскольку он не использует snap работа pppoe осуществляется следующим образом существует ethernet среда то есть несколько соединённых сетевых карт которые адресуются mac адресами заголовки ethernet кадров содержат адрес отправителя кадра адрес получателя кадра тип кадра одну из карт слушает pppoe сервер клиент посылает ethernet кадр на который должен ответить pppoe сервер адрес отправителя кадра свой mac адрес адрес получателя кадра ff ff ff ff ff ff тип кадра pppoe active discovery initiation pppoe сервер посылает клиенту ответ адрес отправителя кадра свой mac адрес адрес получателя кадра мас адрес клиента тип кадра pppoe active discovery offer если сети несколько pppoe серверов то все они посылают ответ клиент выбирает подходящий сервер посылает ему запрос на соединение сервер посылает клиенту подтверждение уникальным идентификатором сессии все последующие кадры сессии будут иметь этот идентификатор таким образом между сервером клиентом создается виртуальный канал который идентификатором сессии mac адресами клиента сервера затем этом канале устанавливается ppp соединение уже ppp пакеты упаковывается ip трафик pppoe discovery pppoed padi padi pppoe active discovery initiation если пользователь хочет подключиться интернету по dsl сначала его машина должна обнаружить концентратор доступа dsl ccess oncentrator или dsl ac на стороне провайдера point of presence pop взаимодействие через ethernet возможно только через mac адреса если компьютер не знает mac адреса dsl ac он посылает padi пакет через ethernet broadcast mac ff ff ff ff ff ff этот padi пакет содержит мас адрес пославшей его машины пример padi пакета frame bytes on wire bytes captured ethernet ii src da df dst ff ff ff ff ff ff ppp over ethernet discovery version type code active discovery initiation padi session id payload length pppoe tags tag service name tag host uniq binary data bytes src source представляет mac адрес машины пославшей padi dst destination является ethernet адресом padi пакет может быть получен более чем одним dsl ac pado pado pppoe active discovery offer как только машина отослала padi пакет dsl ac отвечает посылая pado пакет используя mac адреса пришедшие padi pado пакет содержит mac адреса dsl ac их имена например leix erx для концентратора com dsl ac лейпциге имя сервиса если же более одной точки dsl ac ответило pado пакетом машина выбирает dsl ac конкретный pop используя пришедшие имена или имена сервисов пример pado пакета frame bytes on wire bytes captured ethernet ii src dst da df ppp over ethernet discovery version type code active discovery offer pado session id payload length pppoe tags tag service name tag ac name string data ipzbrool tag host uniq binary data bytes ac name string data представляет строковое ac имя данном случае ipzbr arcor dsl ac лейпциге src представляет mac адрес dsl ac mac адрес dsl ac также идентифицирует производителя dsl ac данном случае nortel networks padr padr как pppoe active discovery request как сказано выше машина должна выбрать pop точку доступа это делается помощью padr пакета который посылается на mac адрес выбранного dsl ac pads pads pppoe active discovery session confirmation padr пакет подтверждается концентратором пересылкой pads пакета нём же приходит session id соединение dsl ac для этой точки доступа теперь полностью установлено padt padt pppoe active discovery termination этот пакет обрывает соединение pop он может быть послан либо со стороны пользователя либо со стороны dsl ac преимущества схемы ip заголовки ethernet среде игнорируются то есть пользователь может назначить ip адрес своей сетевой карте но это не приведет обвалу сети теоретически при работе сетевым концентратором не должно произойти обвала при смене пользователем mac адреса даже на адрес сервера при работе сетевым коммутатором все зависит от конструкции коммутатора каждое соединение отделено от других работает своем канале настройки ip адрес адрес шлюза адреса dns серверов могут передаваться сервером ppp соединение легко обсчитывается например при помощи radius ppp соединение можно шифровать например при работе сетевым концентратором когда на каждой сетевой карте может быть виден весь ethernet трафик прочитать чужой ip трафик весьма затруднительно см также rp pppoe примечания ссылки rfc method for transmitting ppp over ethernet pppoe rfc layer tunneling protocol tp active discovery relay for ppp over ethernet pppoe rfc accommodating maximum transit unit maximum receive unit mtu mru greater than in the point to point protocol over ethernet pppoe категория сетевые протоколы категория vpn