md message digest хеш функция разработанная профессором массачусетского университета рональдом ривестом году впервые описанная rfc для произвольного входного сообщения функция генерирует разрядное хеш значение называемое дайджестом сообщения этот алгоритм используется протоколе аутентификации ms chap разработанном корпорацией майкрософт для выполнения процедур проверки подлинности удаленных рабочих станций windows является md одна операция md хеширование md состоит из таких операций сгруппированных раунда по операций нелинейная функция каждом раунде функция меняется mi означает битный блок входного сообщения ki битная константа различная для каждой операции алгоритм md предполагается что на вход подано сообщение состоящее из бит хеш которого нам предстоит вычислить здесь произвольное неотрицательное целое число оно может быть нулем не обязано быть кратным восьми может быть сколь угодно большим запишем сообщение побитово виде ниже приведены шагов используемые для вычисления хеша сообщения шаг добавление недостающих битов сообщение расширяется так чтобы его длина битах по модулю равнялась таким образом результате расширения сообщению недостает бита до длины кратной битам расширение производится всегда даже если сообщение изначально имеет нужную длину расширение производится следующим образом один бит равный добавляется сообщению затем добавляются биты равные до тех пор пока длина сообщения не станет равной по модулю итоге сообщению добавляется как минимум бит как максимум шаг добавление длины сообщения битное представление длины сообщения перед добавлением набивочных битов добавляется результату предыдущего шага маловероятном случае когда больше чем используются только младших бита эти биты добавляются виде двух битных слов первым добавляется слово содержащее младшие разряды на этом этапе после добавления битов длины сообщения мы получаем сообщение длиной кратной битам это эквивалентно тому что это сообщение имеет длину кратную ти битным словам каждое битное слово содержит четыре битных но следуют они не подряд наоборот например из восьми битных слов мы получаем два битных слова dcba hgfe пусть означает массив слов получившегося сообщения здесь кратно шаг инициализация md буфера для вычисления хеша сообщения используется буфер состоящий из слов битных регистров эти регистры следующими числами младшие байты сначала word word ab cd ef word fe dc ba word шаг обработка сообщения блоками по слов для начала определим три вспомогательные функции каждая из которых получает на вход три битных слова по ним вычисляет одно битное слово на каждую битовую позицию действует как условное выражение если то иначе функция могла бы быть определена использованием вместо поскольку не могут равняться одновременно действует на каждую битовую позицию как функция максимального значения если по крайней мере двух словах из соответствующие биты равны то выдаст этом бите иначе выдаст бит равный интересно отметить что если биты статистически независимы то биты будут также статистически независимы функция реализует побитовый она обладает таким же свойством как алгоритм хеширования на абстрактном языке обрабатываем каждый блок из ти слов for to do заносим ый блок переменную for to do set xj to mi end конец цикла по сохраняем как aa как bb как cc как dd aa bb cc dd раунд пусть abcd означает следующую операцию xk замечание величина битная константа первые байты старшие она представляет собой квадратный корень из она же восьмеричном представлении величина ed eba битная константа первые байты старшие она представляет собой квадратный корень из она же восьмеричном представлении эти данные приведены книге кнут искусство издание года том стр таблица шаг формирование хеша результат хеш функция получается как abcd то есть мы выписываем бит начиная младшего бита заканчивая старшим битом реализация алгоритма на языке содержится rfc примеры хешей битные md хеши представляют собой значное число ричном формате следующем примере показан хеш байтной строки ascii md the quick brown fox jumps over the lazy dog bee ba abaeae любое даже самое незначительное изменение хешируемой информации приводит получению полностью отличного хеша например изменение примере одной буквы на md the quick brown fox jumps over the lazy og ce da ad df пример md хеша для нулевой строки md cfe ae сравнение md md использует три цикла из шагов каждый то время как md использует четыре цикла из шагов каждый md дополнительная константа первом цикле не применяется аналогичная дополнительная константа используется для каждого из шагов во втором цикле другая дополнительная константа используется для каждого из шагов третьем цикле md различные дополнительные константы тi применяются для каждого из шагов md использует четыре элементарные логические функции по одной на каждом цикле по сравнению тремя md по одной на каждом цикле md на каждом шаге текущий результат складывается результатом предыдущего шага например результатом первого шага является измененное слово результат второго шага хранится образуется добавлением циклически сдвинутому влево на определенное число бит результату элементарной функции аналогично результат третьего шага хранится образуется добавлением циклически сдвинутому влево результату элементарной функции md это последнее сложение не включает безопасность уровень безопасности закладывавшийся md был рассчитан на создание достаточно устойчивых гибридных систем электронной цифровой подписи основанных на md криптосистеме открытым ключом рональд ривест считал что алгоритм хеширования md можно использовать для систем нуждающихся сильной криптостойкости но то же время он отмечал что md создавался прежде всего как очень быстрый алгоритм хеширования поэтому он может быть плох плане криптостойкости как показали последовавшие исследования он был прав для приложений где важна прежде всего криптостойкость стал использоваться алгоритм md уязвимости уязвимости md были статье берта ден бура антона босселарса году первая коллизия была найдена гансом доббертином году см также md md haval sha ссылки rfc rfc paj home cryptography реализация md на javascript так же поддерживает md sha опубликовано под bsd license также содержит ссылки на несколько других реализаций поиск коллизий improved collision attack on md категория хеш функции