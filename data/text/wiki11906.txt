сеть фе йстеля конструкция фейстеля один из методов построения блочных шифров сеть состоит из ячеек называемых ячейками фейстеля на вход каждой ячейки поступают данные ключ на выходе каждой ячейки получают изменённые данные изменённый ключ все ячейки однотипны говорят что сеть представляет собой определённую многократно повторяющуюся итерированную структуру ключ выбирается зависимости от алгоритма шифрования расшифрования меняется при переходе от одной ячейки другой при шифровании расшифровании выполняются одни те же операции отличается только порядок ключей ввиду простоты операций сеть фейстеля легко реализовать как программно так аппаратно большинство современных блочных шифров des rc rc rc blowfish feal cast tea xtea xxtea др используют сеть фейстеля качестве основы альтернативой сети фейстеля является подстановочно перестановочная сеть aes др история году хорст фейстель запатентовал два устройства реализующие различные алгоритмы шифрования позже получившие название люцифер одно из этих устройств использовало конструкцию впоследствии названную сетью фейстеля тогда фейстель работал над созданием новых криптосистем стенах ibm вместе доном копперсмитом проект люцифер был скорее но стал основой для алгоритма des году журнал scientific american опубликовал статью фейстеля криптография компьютерная безопасность которой раскрыты некоторые важные аспекты шифрования приведено описание первой версии проекта люцифер первой версии проекта люцифер сеть фейстеля не использовалась на основе сети фейстеля был спроектирован алгоритм des году власти сша приняли стандарт признающий des стандартным методом шифрования данных des некоторое время широко использовался системах итеративная структура алгоритма позволяла создавать простые программные аппаратные реализации согласно некоторым данным ссср уже годы кгб разрабатывала блочный шифр использовавший сеть фейстеля вероятно именно этот шифр году был принят качестве гост году были разработаны алгоритмы feal rc сети фейстеля получили широкое распространение годы годы появления таких алгоритмов как blowfish tea rc cast xtea xxtea rc других января года институт nist объявил конкурс по созданию нового алгоритма шифрования данных призванного заменить des новый блочный шифр получил название aes был утверждён мая года aes вместо сети фейстеля используется подстановочно перестановочная сеть конструкция блочного шифра на основе сетей фейстеля px простое описание шифрование пусть требуется зашифровать некоторую информацию представленную двоичном виде виде нулей единиц находящуюся памяти компьютера или иного устройства например файле алгоритм шифрования информация разбивается на блоки одинаковой фиксированной длины полученные блоки называются входными так как поступают на вход алгоритма случае если длина входного блока меньше чем размер который выбранный алгоритм шифрования способен зашифровать единовременно размер блока то блок удлиняется каким либо способом как правило длина блока является степенью двойки например составляет бита или бит далее будем рассматривать операции происходящие только одним блоком так как процессе шифрования другими блоками выполняются те же самые операции выбранный блок делится на два подблока одинакового размера левый правый левый подблок изменяется функцией использованием раундового ключа результат складывается по модулю xor правым подблоком результат будет использован следующем раунде роли левого подблока левый подблок текущего раунда будет использован следующем раунде роли правого подблока по какому либо математическому правилу вычисляется раундовый ключ ключ который будет использоваться следующем раунде перечисленные операции выполняются раз где количество раундов выбранном алгоритме шифрования при этом между переходами от одного раунда этапа другому изменяются ключи заменяется на на расшифрование расшифровка информации происходит так же как шифрование тем лишь исключением что ключи следуют обратном порядке то есть не от первого му от го первому алгоритмическое описание блок открытого текста делится на две равные части каждом раунде вычисляются где номер раунда количество раундов выбранном алгоритме шифрования некоторая функция ключ го раунда раундовый ключ результатом выполнения раундов является раунде перестановка не производится чтобы была возможность использовать ту же процедуру для расшифрования просто инвертировав порядок использования ключей вместо небольшим изменением можно добиться полной идентичности процедур шифрования расшифрования достоинства обратимость алгоритма независимо от используемой функции возможность выбора сколь угодно сложной функции математическое описание рассмотрим пример пусть блок данных поступающий на вход входной блок некоторое инволютивное преобразование или инволюция взаимно однозначное преобразование которое является обратным самому себе то есть для каждого справедливо выражение блок данных получаемый на выходе результат при однократном применении преобразования входному блоку получится выходной блок при применении преобразования результату предыдущего преобразования получится пусть входной блок состоит из двух подблоков равной длины определим два преобразования шифрование данных ключом перестановка подблоков введём обозначения однократное применение преобразования двукратное применение преобразования докажем инволютивность двукратного преобразования несложно заметить что преобразование меняет только левый подблок оставляя правый неизменным поэтому далее будем рассматривать только подблок после двукратного применения преобразования получим таким образом следовательно инволюция докажем инволютивность двукратного преобразования рассмотрим процесс шифрования пусть входное значение преобразование ключом выходное значение результат го раунда тогда преобразование выполняемое на раунде можно записать виде преобразование выполняемое на раунде следовательно выходное значение после раундов шифрования будет равно можно заметить что на последнем этапе не обязательно выполнять перестановку расшифрование ведётся применением всех преобразований обратном порядке силу инволютивности каждого из преобразований обратный порядок даёт исходный результат функции используемые сетях фейстеля своей работе криптография компьютерная безопасность хорст фейстель описывает два блока преобразований функций блок подстановок блок блок перестановок блок можно показать что любое двоичное преобразование над блоком данных фиксированной длины может быть реализовано виде блока силу сложности строения разрядного блока при больших на практике применяют более простые конструкции термин блок оригинальной статье используется вместо термина функция вследствие того что речь идёт блочном шифре предполагалось что блоки будут цифровыми микросхемами цифровыми блоками файл block svg frame принципиальная схема разрядного блока принципиальная схема разрядного блока блок блок подстановок блок состоит из следующих частей дешифратор преобразователь разрядного двоичного сигнала одноразрядный сигнал по основанию система коммутаторов внутренние соединения всего возможных соединений шифратор преобразователь сигнала из одноразрядного ричного разрядный двоичный анализ разрядного блока при большом крайне сложен однако реализовать такой блок на практике очень сложно так как число возможных соединений крайне велико на практике блок подстановок используется как часть более сложных систем общем случае блок может иметь несовпадающее число входов выходов этом случае системе коммутации от каждого выхода дешифратора может идти не строго одно соединение или более или не идти вовсе то же самое справедливо для входов шифратора электронике можно непосредственно применять приведённую справа схему же генерируют таблицы замены оба этих подхода являются эквивалентными то есть файл зашифрованный на компьютере можно расшифровать на электронном устройстве наоборот таблица замены для приведённого разрядного блока комбинации вход выход блок блок перестановок блок всего лишь изменяет положение цифр является линейным устройством этот блок может иметь очень большое количество входов выходов однако силу линейности систему нельзя считать криптоанализ ключа для разрядного блока проводится путём подачи на вход различных сообщений каждое из которых состоит из нуля единицы или наоборот из единиц нуля циклический сдвиг файл left shift png циклический сдвиг влево frame циклический сдвиг влево на разряда битной шины можно показать что циклический сдвиг является частным случаем блока простейшем случае сдвиг на бит крайний бит отщепляется перемещается на другой конец регистра или шины зависимости от того какой бит берётся правый или левый сдвиг называется вправо или влево сдвиги на большее число бит можно рассматривать как многократное применение сдвига на циклический сдвиг на бит для разрядного входа функция выполняющая преобразование подблока учётом значения ключа по ключу реализация зависит от выбранного алгоритма блочного шифрования int int subblock преобразуемый подблок int key ключ возвращаемое значение преобразованный блок функция выполняющая шифрование открытого текста void crypt int left левый входной подблок int right правый входной подблок int rounds количество раундов int key массив ключей по ключу на раунд int temp for temp left right keyi left right right temp достоинства недостатки достоинства простота аппаратной реализации на современной электронной базе простота программной реализации силу того что значительная часть функций поддерживается на аппаратном уровне современных компьютерах например сложение по модулю xor сложение по модулю умножение по модулю хорошая изученность алгоритмов построенных на основе сетей фейстеля недостатки за один раунд шифруется только половина входного блока теоретические исследования сети фейстеля были широко изучены криптографами силу их обширного распространения году майкл люби провели исследования сети фейстеля доказали что если раундовая функция является криптостойкой псевдослучайной используемые ключи независимы каждом раунде то раундов будет достаточно для того чтобы блочный шифр являлся псевдослучайной перестановкой тогда как четырёх раундов будет достаточно для того чтобы сделать сильную псевдослучайную перестановку псевдослучайной перестановкой люби ракофф назвали такую которая устойчива атаке адаптивным выбором открытого текста сильной псевдослучайной перестановкой псевдослучайную перестановку устойчивую атаке использованием выбранного шифрованного текста иногда западной литературе сеть фейстеля называют luby rackoff block cipher честь люби ракоффа которые проделали большой объём теоретических исследований этой области дальнейшем году предложили упрощённый вариант конструкции люби ракоффа состоящий из четырёх раундов этом варианте качестве первого последнего раунда используются две попарно независимые перестановки два средних раунда конструкции наора рейнголда идентичны раундам конструкции люби ракоффа большинство же исследований посвящено изучению конкретных алгоритмов во многих блочных шифрах на основе сети фейстеля были найдены те или иные уязвимости однако ряде случаев эти уязвимости являются чисто теоретическими при нынешней компьютеров использовать их на практике для взлома невозможно модификации сети фейстеля при большом размере блоков шифрования бит более реализация такой конструкции фейстеля на разрядных архитектурах может вызвать затруднения поэтому применяются варианты этой конструкции обычно используются сети четырьмя ветвями на рисунке показаны наиболее модификации также существуют схемы которых длины половинок не совпадают такие сети называются изображение feistel type svg тип изображение feistel type svg тип изображение feistel type svg тип алгоритм idea источник схема одной итерацииполного раунда алгоритма idea px center алгоритме idea используется глубоко сеть фейстеля нём битные входные блоки данных обозначим за делятся на подблока длиной бит на каждом этапе используется битных ключей всего используется основных этапов укороченный формулы для вычисления значения подблоков на раунде для раундов го по предварительные вычисления финальные вычисления где ключ на раунде формула для вычисления го раунда выходом функции будет можно заметить что блоки чистом виде не используются качестве основных операций используются умножение по модулю сложение по модулю шифры на основе сети фейстеля люцифер lucifer модуль выбирающий используемую таблицу подстановок по битовому ключу упрощённая схема слоёв алгоритме люцифер июнь схема генерации распространения единиц исторически первым алгоритмом использующим сеть фейстеля был алгоритм люцифер при работе над которым фейстелем была собственно разработана структура впоследствии получившая название сеть фейстеля июне года фейстелем был получен американский патент первая версия люцифера использовала блоки ключи длиной по бит не использовала конструкцию сеть фейстеля последующая модификация алгоритма была запатентована на имя джона смитта ноябре года us patent nov патенте содержится как описание собственно самой сети фейстеля так конкретной функции шифрования ней использовались разрядные ключи битные блоки наконец последняя версия предложена году оперировала битными блоками ключами наиболее полное описание алгоритма люцифер было приведено статье артура соркина люцифер алгоритм lucifer cryptographic algorithm журнале криптология cryptologia за январь хотя изначальная модификация люцифера обходилась без ячеек фейстеля она хорошо демонстрирует то как только применением блоков можно сильно исказить исходный текст структура алгоритма люцифер образца июня года представляет собой сэндвич из слоёв двух типов используемых по очереди так называемые sp сети или подстановочно перестановочные сети первый тип слоя блок разрядности бит за ним идёт второй слой представляющий собой модуля каждый из которых состоит их двух четырёхбитных блоков чьи соответствующие входы закорочены на них подаётся одно то же значение выхода предыдущего слоя но сами блоки подстановок различны отличаются таблицами замен на выход модуля подаются значения только одного из блоков какого конкретно определяется одним из битов ключе номер которого соответствовал номеру блока структуре упрощённая схема алгоритма меньшей разрядности неполным числом раундов приведена на рисунке ней используется модулей выбора блоков всего блока таким образом такая схема использует битный ключ рассмотрим теперь как будет меняться шифротекст приведённом выше алгоритме при изменении всего одного бита для простоты возьмём таблицы замен блоков такими что если на вход блока подаются все нули то на выходе будут все нули силу нашего выбора блоков если на вход шифрующего устройства подаются все нули то на выходе устройства будут все нули реальных системах такие таблицы замен не используются так как они сильно упрощают работу криптоаналитика но нашем примере они наглядно иллюстрируют сильную межсимвольную взаимосвязь при изменении одного бита шифруемого сообщения видно что благодаря первому блоку единственная единица сдвигается перемещается центр блока затем следующий нелинейный блок размножает её уже две единицы за счёт следующего блока изменяют своё положение конце устройства шифрования благодаря сильной межсимвольной связи выходные биты стали сложной функцией от входных от используемого ключа среднем на выходе половина бит будет равна половина по своей сути сеть фейстеля является альтернативой сложным sp сетям используется намного шире теоретической точки зрения раундовая функция шифрования может быть сведена sp сети однако сеть фейстеля является более практичной так как шифрование дешифрование может вестись одним тем же устройством но обратным порядком используемых ключей вторая третья версия алгоритма использующие сеть фейстеля оперировали над битными блоками битным ключом битными блоками со битными ключами последней третьей версии раундовая функция шифрования была устроена очень просто сначала шифруемый подблок пропускался через слой битных блоков аналогично слоям sp сетях только блок является константным не зависит от ключа затем нему по модулю добавлялся раундовый ключ после чего результат пропускался через блок des функция где разрядный входной блок на итерации разрядный ключ на данной итерации алгоритме des состоит из следующих операций расширение входного блока до разрядов некоторые входные разряды могут повторяться сложение по модулю ключом деление результата на блоков длиной по бит каждый полученные блоки информации подаются на блоки подстановок имеющие разрядные входы разрядные выходы на выходе битные блоки объединяются битный который является результатом функции полное число раундов алгоритме des равно магма функция где битные числа вычисляется следующим образом складываются по модулю результат разбивается на битных блоков которые подаются на вход разрядных блоков которые могут быть различными выходы блоков объединяют битное число которое затем сдвигается циклически на битов влево полученный результат является выходом функции количество раундов алгоритме гост равно сравнительный список алгоритмов следующие блочные шифры качестве своей основы используют классическую или сеть фейстеля алгоритм год число раундов длина ключа размер блока количество подблоков blowfish от до camellia cast cast cipherunicorn cipherunicorn clefia deal des dfc feal гост idea kasumi khufu loki lucifer macguffin magenta mars mercy misty raiden rc rc rc rtea seed sinople skipjack tea triple des twofish xtea xtea xxtea примечания литература категория криптография