right dns система доменных имён компьютерная распределённая система для получения информации доменах чаще всего используется для получения ip адреса по имени хоста компьютера или устройства получения информации маршрутизации почты обслуживающих узлах для протоколов домене srv запись распределённая база данных dns поддерживается помощью иерархии dns серверов по определённому протоколу основой dns является представление об иерархической структуре доменного имени зонах каждый сервер отвечающий за имя может делегировать ответственность за дальнейшую часть домена другому серверу точки зрения другой организации или человеку что позволяет возложить ответственность за актуальность информации на серверы различных организаций людей отвечающих только за свою часть доменного имени начиная года систему dns внедряются средства проверки целостности передаваемых данных называемые dns security extensions dnssec передаваемые данные не шифруются но их достоверность проверяется способами внедряемый стандарт dane обеспечивает передачу средствами dns достоверной информации сертификатов используемых для установления безопасных защищённых соединений транспортного прикладного уровней ключевые характеристики dns dns обладает следующими ответственность за разные части иерархической структуры несут разные люди или организации хранения информации каждый узел сети обязательном порядке должен хранить только те данные которые входят его зону ответственности возможно адреса корневых dns серверов кэширование информации узел может хранить некоторое количество данных не из своей зоны ответственности для уменьшения нагрузки на сеть иерархическая структура которой все узлы объединены дерево каждый узел может или самостоятельно определять работу нижестоящих узлов или делегировать передавать их другим узлам резервирование за хранение обслуживание своих узлов зон отвечают обычно несколько серверов разделённые как физически так логически что обеспечивает сохранность данных продолжение работы даже случае сбоя одного из узлов dns важна для работы интернета так как для соединения узлом необходима информация его ip адресе для людей проще запоминать буквенные обычно осмысленные адреса чем цифр ip адреса некоторых случаях это позволяет использовать виртуальные серверы например http серверы различая их по имени запроса первоначально преобразование между доменными ip адресами производилось использованием специального текстового файла hosts который составлялся централизованно автоматически рассылался на каждую из машин своей локальной сети ростом сети возникла необходимость эффективном механизме которым стала dns dns была разработана полом мокапетрисом году оригинальное описание механизмов работы содержится rfc rfc публикация rfc rfc изменила спецификацию dns отменила rfc rfc rfc как устаревшие дополнительные возможности поддержка динамических обновлений защита данных dnssec транзакций tsig поддержка различных типов информации история использование более простого запоминающегося имени вместо числового адреса хоста относится эпохе arpanet стэнфордский институт теперь sri international поддерживал текстовый файл hosts txt который сопоставлял имена узлов числовыми адресами компьютеров arpanet поддержание числовых адресов называемых списком присвоенных номеров было обработано джоном постелем институте информационных наук университета южной калифорнии isi команда которого тесно сотрудничала нии адреса назначались вручную чтобы запросить имя хоста адрес добавить компьютер главный файл пользователи связывались сетевым информационным центром nic sri руководимым элизабет фейнлер по телефону рабочее время началу годов поддержание единой таблицы хостов стало медленным громоздким развивающейся сети требовалась автоматическая система именования для решения технических кадровых вопросов постел поставил перед собой задачу выработать компромисс между пятью конкурирующими предложениями для решения задачи полом мокапетрисом мокапетрис вместо этого создал концепцию иерархической системы доменных имен рабочая группа ietf опубликовала оригинальные спецификации rfc rfc ноябре года году четыре студента uc berkeley дуглас терри марк пейнтер дэвид риггл сонгниан чжоу написали первую версию сервера имен bind berkeley internet name daemon году кевин данлэп из dec существенно пересмотрел реализацию dns майк карел фил альмквист пол викси поддерживали bind тех пор начале годов bind был перенесен на платформу windows nt он широко распространен особенно unix системах по прежнему является наиболее широко используемым программным обеспечением dns интернете ноябре года были приняты спецификации dns rfc rfc после этого были приняты сотни rfc изменяющих дополняющих dns проблемы безопасностью первоначально проблемы безопасности не были основными соображениями при разработке программного обеспечения dns или любого программного обеспечения для развёртывания раннем интернете поскольку сеть не была открыта для широкой общественности однако рост интернета коммерческом секторе годах изменил требования мерам безопасности для защиты целостности данных аутентификации пользователей несколько уязвимостей были обнаружены использованы одной из таких проблем является отравление кэша dns котором данные на кэширующие преобразователи под предлогом того что они являются авторитетным сервером происхождения тем самым загрязняя хранилище данных потенциально ложной информацией длительными сроками действия время жизни впоследствии запросы легитимных приложений могут быть перенаправлены на сетевые хосты контролируемые злоумышленником dns ответы ранее не имели подписи что давало возможность для множества вариантов атаки современные расширения системы безопасности доменных имен dnssec изменяют dns чтобы добавить поддержку подписанных ответов другие расширения такие как tsig добавляют поддержку аутентификации между доверенными одноранговыми узлами обычно используются для авторизации передачи зоны или операций динамического обновления некоторые доменные имена могут использоваться для достижения эффектов спуфинга например paypal com paypa com это разные имена но пользователи могут не различать их графическом интерфейсе зависимости от выбранного шрифта пользователя во многих шрифтах буква цифра выглядят очень похожими или даже идентичными эта проблема остро стоит системах которые поддерживают доменные имена поскольку многие коды символов iso могут отображаться на типичных экранах компьютеров эта уязвимость иногда используется фишинге для подтверждения результатов dns также могут использоваться такие методы как обратный dns подтверждением прямых записей но достоверными они не являются при этом не учитывается вариант терминология принципы работы ключевыми понятиями dns являются доме область узел дереве имён вместе со всеми подчинёнными ему узлами если таковые имеются то есть именованная ветвь или поддерево дереве имён структура доменного имени отражает порядок следования узлов иерархии доменное имя читается слева направо от младших доменов доменам высшего уровня порядке повышения значимости вверху находится корневой домен имеющий идентификатор точка ниже идут домены первого уровня доменные зоны затем домены второго уровня третьего например для адреса ru wikipedia org домен первого уровня org второго wikipedia третьего ru поддомен подчинённый домен например wikipedia org поддомен домена org ru wikipedia org домена wikipedia org теоретически такое деление может достигать глубины уровней каждая метка может содержать до символов пока общая длина вместе точками не достигнет символов но на практике регистраторы доменных имён используют более строгие ограничения например если вас есть домен вида mydomain ru вы можете создать для него различные поддомены вида mysite mydomain ru mysite mydomain ru ресурсная запись единица хранения передачи информации dns каждая ресурсная запись имеет имя то есть привязана определённому доменному имени узлу дереве имён тип поле данных формат содержание которого зависит от типа зона часть дерева доменных имён включая ресурсные записи размещаемая как единое целое на некотором сервере доменных имён dns сервере см ниже чаще одновременно на нескольких серверах см ниже целью выделения части дерева отдельную зону является передача ответственности см ниже за соответствующий домен другому лицу или организации это называется делегированием см ниже как связная часть дерева зона внутри тоже представляет собой дерево если рассматривать пространство имён dns как структуру из зон не отдельных узлов имён тоже получается дерево оправданно говорить родительских дочерних зонах старших подчинённых на практике большинство зон го го уровня ru com состоят из единственного узла которому непосредственно подчиняются дочерние зоны больших корпоративных доменах го более уровней иногда встречается образование дополнительных подчинённых уровней без выделения их дочерние зоны делегирование операция передачи ответственности за часть дерева доменных имён другому лицу или организации за счёт делегирования dns обеспечивается хранения технически делегирование выражается выделении этой части дерева отдельную зону размещении этой зоны на dns сервере см ниже управляемом этим лицом или организацией при этом родительскую зону включаются склеивающие ресурсные записи ns содержащие указатели на dns сервера дочерней зоны вся остальная информация относящаяся дочерней зоне хранится уже на dns серверах дочерней зоны dns сервер по для обслуживания dns также компьютер на котором это по выполняется dns сервер может быть ответственным за некоторые зоны или может перенаправлять запросы вышестоящим серверам dns клиент библиотека или программа для работы dns ряде случаев dns сервер выступает роли dns клиента авторитетность признак размещения зоны на dns сервере ответы dns сервера могут быть двух типов авторитетные когда сервер заявляет что сам отвечает за зону неавторитетные когда сервер обрабатывает запрос возвращает ответ других серверов некоторых случаях вместо передачи запроса дальше dns сервер может вернуть уже известное ему по запросам ранее значение режим кеширования dns запрос запрос от клиента или сервера серверу запрос может быть рекурсивным или нерекурсивным см рекурсия система dns содержит иерархию dns серверов соответствующую иерархии зон каждая зона поддерживается как минимум одним авторитетным сервером dns от авторитетный на котором расположена информация домене имя ip адрес не тождественны один ip адрес может иметь множество имён что позволяет поддерживать на одном компьютере множество веб сайтов это называется виртуальный хостинг обратное тоже справедливо одному имени может быть сопоставлено множество ip адресов это позволяет создавать балансировку нагрузки для повышения устойчивости системы используется множество серверов содержащих идентичную информацию протоколе есть средства позволяющие поддерживать синхронность информации расположенной на разных серверах существует корневых серверов их адреса практически не изменяются протокол dns использует для работы tcp или udp порт для ответов на запросы традиционно запросы ответы отправляются виде одной udp датаграммы tcp используется когда размер данных ответа превышает байт для axfr запросов рекурсия термином рекурсия dns обозначают алгоритм поведения dns сервера при котором сервер выполняет от имени клиента полный поиск нужной информации во всей системе dns при необходимости обращаясь другим dns серверам dns запрос может быть рекурсивным требующим полного поиска нерекурсивным или итеративным не требующим полного поиска аналогично dns сервер может быть рекурсивным умеющим выполнять полный поиск нерекурсивным не умеющим выполнять полный поиск некоторые программы dns серверов например bind можно так чтобы запросы одних клиентов выполнялись рекурсивно запросы других нерекурсивно при ответе на нерекурсивный запрос также при неумении или запрете выполнять рекурсивные запросы dns сервер либо возвращает данные зоне за которую он ответственен либо возвращает ошибку настройки нерекурсивного сервера когда при ответе выдаются адреса серверов которые обладают большим объёмом информации запрошенной зоне чем отвечающий сервер чаще всего адреса корневых серверов являются некорректными такой сервер может быть использован для организации dos атак случае рекурсивного запроса dns сервер опрашивает серверы порядке убывания уровня зон имени пока не найдёт ответ или не обнаружит что домен не существует на практике поиск начинается наиболее близких искомому dns серверов если информация них есть кэше не устарела сервер может не запрашивать другие dns серверы рассмотрим на примере работу всей системы предположим мы набрали браузере адрес ru wikipedia org браузер спрашивает сервера dns какой ip адрес ru wikipedia org однако сервер dns может ничего не знать не только запрошенном имени но даже обо всём домене wikipedia org этом случае сервер обращается корневому серверу например этот сервер сообщает меня нет информации данном адресе но знаю что является ответственным за зону org тогда сервер dns направляет свой запрос но тот отвечает меня нет информации данном сервере но знаю что является ответственным за зону wikipedia org наконец тот же запрос отправляется третьему dns серверу получает ответ ip адрес который передаётся клиенту браузеру данном случае при разрешении имени то есть процессе поиска ip по имени браузер отправил известному ему dns серверу рекурсивный запрос ответ на такой тип запроса сервер обязан вернуть готовый результат то есть ip адрес либо пустой ответ код ошибки nxdomain dns сервер получивший запрос от браузера последовательно отправлял нерекурсивные запросы на которые получал от других dns серверов ответы пока не получил ответ от сервера ответственного за запрошенную зону остальные упоминавшиеся dns серверы обрабатывали запросы нерекурсивно скорее всего не стали бы обрабатывать запросы рекурсивно даже если бы такое требование стояло запросе иногда допускается чтобы запрошенный сервер передавал рекурсивный запрос вышестоящему dns серверу дожидался готового ответа при рекурсивной обработке запросов все ответы проходят через dns сервер он получает возможность кэшировать их повторный запрос на те же имена обычно не идёт дальше кэша сервера обращения другим серверам не происходит вообще допустимое время хранения ответов кэше приходит вместе ответами поле ttl ресурсной записи рекурсивные запросы требуют больше ресурсов от сервера создают больше трафика так что обычно принимаются от известных владельцу сервера узлов например провайдер предоставляет возможность делать рекурсивные запросы только своим клиентам корпоративной сети рекурсивные запросы принимаются только из локального сегмента нерекурсивные запросы обычно принимаются ото всех узлов сети содержательный ответ даётся только на запросы зоне которая размещена на узле на dns запрос других зонах обычно возвращаются адреса других серверов обратный dns запрос dns используется первую очередь для преобразования символьных имён ip адреса но он также может выполнять обратный процесс для этого используются уже имеющиеся средства dns дело том что записью dns могут быть сопоставлены различные данные том числе какое либо символьное имя существует специальный домен in addr arpa записи котором используются для преобразования ip адресов символьные имена например для получения dns имени для адреса можно запросить dns сервера запись in addr arpa тот вернёт соответствующее символьное имя обратный порядок записи частей ip адреса объясняется тем что ip адресах старшие биты расположены начале символьных dns именах старшие находящиеся ближе корню части расположены конце записи dns записи dns или ресурсные записи англ resource records rr единицы хранения передачи информации dns каждая ресурсная запись состоит из следующих полей имя name доменное имя которому привязана или которому принадлежит данная ресурсная запись тип type ресурсной записи определяет формат назначение данной ресурсной записи класс class ресурсной записи теоретически считается что dns может использоваться не только tcp ip но другими типами сетей код поле класс определяет тип сети ttl time to live допустимое время хранения данной ресурсной записи кэше dns сервера длина поля данных rdlen поле данных rdata формат содержание которого зависит от типа записи наиболее важные типы dns записей запись address record или запись адреса связывает имя хоста адресом протокола ipv например запрос записи на имя referrals icann org вернёт его ipv адрес запись aaaa ipv address record связывает имя хоста адресом протокола ipv например запрос aaaa записи на имя root servers net вернёт его ipv адрес fd запись cname canonical name record или каноническая запись имени псевдоним используется для перенаправления на другое имя запись mx mail exchange или почтовый обменник указывает сервер обмена почтой для данного домена запись ns name server указывает на dns сервер для данного домена запись ptr pointer обратная dns запись или запись указателя связывает ip адрес хоста его каноническим именем запрос домене in addr arpa на ip адрес хоста reverse форме вернёт имя fqdn данного хоста см обратный dns запрос например на момент написания для ip адреса запрос записи ptr in addr arpa вернёт его каноническое имя referrals icann org целях уменьшения объёма нежелательной корреспонденции спама многие серверы получатели электронной почты могут проверять наличие ptr записи для хоста которого происходит отправка этом случае ptr запись для ip адреса должна соответствовать имени отправляющего почтового сервера которым он представляется процессе smtp сессии запись soa start of authority или начальная запись зоны указывает на каком сервере хранится эталонная информация данном домене содержит контактную информацию лица ответственного за данную зону тайминги параметры времени кеширования зонной информации взаимодействия dns серверов srv запись server selection указывает на серверы для сервисов используется частности для jabber active directory доменные имена документ rfc reserved top level dns names имена доменов верхнего уровня определяет названия доменов которые следует использовать качестве примеров например документации также для тестирования кроме example com example org example net эту группу также входят test invalid др доменные имена доменное имя может состоять только из ограниченного набора ascii символов позволяя набрать адрес домена независимо от языка пользователя icann утвердил основанную на punycode систему idna преобразующую любую строку кодировке unicode допустимый dns набор символов программное обеспечение dns серверы имен bind berkeley internet name domain djbdns daniel bernstein dns dnsmasq maradns nsd name server daemon powerdns opendns microsoft dns server серверных версиях операционных систем windows nt mydns см также атака каминского альтернативные корневые серверы dns opendns google public dns яндекс dns киберсквоттинг тайпсквоттинг динамический dns round robin dns распределение нагрузки между одинаковыми серверами icann dnssec dns клиент dns сервер nslookup примечания ссылки dns resources directory ресурсы посвящённые dns bind общество circleid dns повышение безопасности dns dnssec рабочий комитет ietf занимающийся разработкой расширенной спецификации dns dnsext сайт корневых dns серверов просмотр dns записей домена веб инструменты для dns каталог на сайте dmoz org статьи обзор схем типов dns атак документы rfc rfc domain names concepts and facilities rfc domain names implementation and specification rfc common dns operational and configuration errors rfc domain name system structure and delegation rfc tools for dns debugging rfc reserved top level dns names категория стандарты интернета категория tcp ip категория интернет протоколы