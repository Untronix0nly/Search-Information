генератор псевдослучайных чисел гпсч алгоритм порождающий чисел элементы которой почти независимы друг от друга подчиняются заданному распределению обычно равномерному современная информатика широко использует псевдослучайные числа самых разных приложениях от метода монте карло имитационного моделирования до криптографии при этом от качества используемых гпсч напрямую зависит качество получаемых результатов это обстоятельство подчёркивает известный афоризм математика ornl генерация случайных чисел слишком важна чтобы оставлять её на волю случая источники случайных чисел источники настоящих случайных чисел найти крайне трудно физические шумы такие как детекторы событий ионизирующей радиации дробовой шум резисторе или космическое излучение могут быть такими источниками однако применяются такие устройства приложениях сетевой безопасности редко сложности также вызывают грубые атаки на подобные устройства физических источников случайных чисел существует ряд недостатков время трудозатраты при установке настройке по сравнению программными гпсч дороговизна генерация случайных чисел происходит медленнее чем при программной реализации гпсч невозможность воспроизведения ранее сгенерированной случайных чисел то же время случайные числа получаемые из физического источника могут использоваться качестве порождающего элемента англ seed для программных гпсч такие комбинированные генераторы применяются криптографии лотереях игровых автоматах качественные требования предъявляемые гпсч достаточно длинный период гарантирующий отсутствие зацикливания пределах решаемой задачи длина периода должна быть математически доказана эффективность быстрота работы алгоритма малые затраты памяти возможность заново воспроизвести ранее сгенерированную чисел любое количество раз портируемость одинаковое на различном оборудовании операционных системах быстрота получения элемента чисел при задании элемента для любой величины это позволяет разделять на несколько потоков чисел ранние подходы формированию псч джон фон нейман считал неприемлемым использование физических генераторов случайных чисел вычислительной технике так как при возникновении необходимости проверки вычислений повтор предыдущих действий требовал бы воспроизведение случайного числа то время как генерация нового случайного числа недопустима предварительная запись хранение сгенерированных случайных чисел предполагало бы возможность их считывания механизм считывания данных являлся одним из самых слабых звеньев вычислительных машин годов джон фон нейман привёл следующий метод середины квадрата получения десятизначных псевдослучайных чисел десятизначное число возводится квадрат затем из середины квадрата числа берётся десятизначное число которое снова возводится квадрат так далее например для значных чисел начиная получем где берём средние цифры дописав ноль начале если это необходимо затем возводим полученное число квадрат так далее недостатком данного метода является ограниченность множества псч из за того что зацикливается году лемер предложил линейный конгруэнтный метод суть которого заключается задании целых чисел рекурсивной формулой где целые удовлетворяют следующим условиям недостатком данного метода является зависимость от так как также то что псч зацикливается гпсч алгоритм большинство гпсч соответствуют структуре предложенной лекуером году где это конечный набор состояний вероятностное распределение пространстве состояний используемое для выбора начального состояния англ seed функция перехода пространство выходных значений обычно состояние генератора задается рекуррентной формулой для выходное значение генератора псевдослучайных чисел так как конечно то должны существовать некоторые конечные такие что значит для всех будут выполняться условия потому что функции таким образом получается что периодическая периодом гпсч называется минимальное положительное наиболее распространены линейный конгруэнтный метод метод фибоначчи запаздываниями регистр сдвига линейной обратной связью регистр сдвига обобщённой обратной связью из современных гпсч широкое распространение также получил вихрь мерсенна предложенный году мацумото нисимурой его достоинствами являются колоссальный период равномерное распределение измерениях линейный конгруэнтный метод даёт более или менее равномерное распределение максимум измерениях быстрая генерация случайных чисел раза быстрее чем стандартные гпсч использующие линейный конгруэнтный метод однако существуют алгоритмы распознающие порождаемую вихрем мерсенна как неслучайную генератор псевдослучайных чисел включён состав многих современных процессоров например rdrand входит набор инструкций ia разновидностью гпсч являются гпсб prbg генераторы псевдо случайных бит также различных поточных шифров одноразовый блокнот альтернативным решением является создание набора из большого количества случайных чисел опубликование его некотором словаре называемом одноразовым блокнотом тем не менее такие наборы обеспечивают очень ограниченный источник чисел по сравнению тем количеством которое требуется приложениям сетевой безопасности хотя данные наборы действительно обеспечивают статистическую случайность они недостаточно безопасны так как злоумышленник может получить копию словаря недостатки гпсч никакой алгоритм не может генерировать полностью случайные числа он может только некоторые их свойства как сказал джон фон нейман всякий кто питает слабость арифметическим методам получения случайных чисел грешен вне всяких сомнений любой гпсч ограниченными ресурсами рано или поздно зацикливается начинает повторять одну ту же чисел длина циклов гпсч зависит от самого генератора составляет около где размер внутреннего состояния битах хотя линейные конгруэнтные рслос генераторы обладают максимальными циклами порядка если порождаемая гпсч сходится слишком коротким циклам то такой гпсч становится предсказуемым непригодным для практических приложений большинство простых арифметических генераторов хотя обладают большой скоростью но страдают от многих серьёзных недостатков слишком короткий период периоды значения не являются независимыми некоторые биты менее случайны чем другие неравномерное одномерное распределение обратимость частности алгоритм randu десятилетиями на мейнфреймах оказался очень плохим что вызвало сомнения достоверности результатов многих исследований использовавших этот алгоритм гпсч источником энтропии или гсч наравне существующей необходимостью генерировать легко воспроизводимые случайных чисел также существует необходимость генерировать совершенно непредсказуемые или попросту абсолютно случайные числа такие генераторы называются генераторами случайных чисел гсч так как такие генераторы чаще всего применяются для генерации уникальных симметричных асимметричных ключей для шифрования они чаще всего строятся из комбинации криптостойкого гпсч внешнего источника энтропии именно такую комбинацию теперь принято понимать под гсч почти все крупные производители микрочипов поставляют аппаратные гсч различными источниками энтропии используя различные методы для их очистки от неизбежной предсказуемости однако на данный момент скорость сбора случайных чисел всеми существующими микрочипами несколько тысяч бит секунду не соответствует быстродействию современных процессоров современных исследованиях осуществляются попытки использования измерения физических свойств объектов например температуры или даже квантовых флуктуаций вакуума качестве источника энтропии для гсч персональных компьютерах авторы программных гсч используют гораздо более быстрые источники энтропии такие как шум звуковой карты или счётчик тактов процессора сбор энтропии являлся наиболее уязвимым местом гсч эта проблема до сих пор полностью не разрешена во многих устройствах например смарт картах которые таким образом остаются уязвимыми многие гсч используют традиционные испытанные хотя медленные методы сбора энтропии вроде измерения реакции пользователя движение мыши как например pgp yarrow или взаимодействия между потоками как например java securerandom пример простейшего гсч источником энтропии если качестве источника энтропии использовать текущее время то для получения целого числа от до достаточно вычислить остаток от деления текущего времени миллисекундах на число недостатком этого гсч является то что течение одной миллисекунды он выдает одно то же число примеры гсч источников энтропии источник энтропии гпсч достоинства недостатки dev random unix linux счётчик тактов процессора однако собирается только во время аппаратных прерываний рслос хешированием выхода через sha есть во всех unix надёжный источник энтропии очень долго нагревается может надолго застревать либо работает как гпсч dev urandom yarrow от брюса шнайера традиционные методы aes sha маленького внутреннего состояния гибкий криптостойкий дизайн медленный microsoft cryptoapi текущее время размер жёсткого диска размер свободной памяти номер процесса netbios имя компьютера md хеш внутреннего состояния размером бит встроен windows не застревает сильно зависит от используемого csp java securerandom взаимодействие между потоками sha хеш внутреннего состояния бит большое внутреннее состояние медленный сбор энтропии rdrand от intel шумы токов построение псч на основе случайного битового считывания значений от токов очень быстр не застревает оригинальная разработка свойства приведены только по утверждению разработчиков гпсч криптографии одним из критериев того что гпсч стойкий является невозможность отличить выходные значения гпсч от независимой равномерно распределенной на промежутке случайной пусть существует семейство гпсч где мощность множества равно как было указано выше это конечный набор состояний вероятностное распределение пространстве состояний используемое для выбора начального состояния англ seed функция перехода пространство выходных значений обычно состояние генератора задается рекуррентной формулой для выходное значение генератора псевдослучайных чисел предположим что функции перехода выхода могут быть вычислены за полиномиальное степени время пусть класс статистических тестов которые пытаются за полиномиальное степени время отличить выходные значения гпсч от независимой равномерно распределенной на промежутке случайной семейство гпсч называется хорошим точки зрения полиномиального времени если найдется такая что для всех никакой из тестов не может отличить выходные значения гпсч от независимой равномерно распределенной на промежутке случайной вероятностью приложения используют для генерации случайных чисел алгоритмы следовательно генерируют чисел которая теоретически не может быть статистически случайной то же время если выбрать хороший алгоритм полученная численная псевдослучайных чисел будет проходить большинство тестов на случайность одной из характеристик такой является большой период повторения примерами известных криптостойких гпсч являются rc isaac seal snow совсем медленный теоретический алгоритм блюм блюма шуба также счётчики хеш функциями или криптостойкими блочными шифрами вместо функции вывода также стойким шифрам относятся генераторы несколькими регистрами сдвига генераторы мажоритарные генераторы шифрования примеры криптостойких гпсч циклическое шифрование происходит шифрование случайных чисел генератора помощью различных секретных ключей полученных на каждой стадии счетчик большим периодом используется качестве входа шифрующее устройство при использовании битного ключа des может использоваться счетчик периодом момент инициализации генерируется секретный ключ константа должен быть случайным используется только для данного генератора на каждой стадии происходит следующее псевдослучайная полученная по данной схеме имеет полный период каждое выходное значение основано на разных значениях счетчика поэтому так как ключ является секретным то любой секретный ключ не зависит от знания одного или более предыдущих секретных ключей для увеличения криптостойкости алгоритма необходимо на каждом шаге шифровать случайное число гсч ключ используемый на каждой стадии функция шифрования ключом случайное число гсч ansi гпсч из стандарта ansi используется во многих приложениях финансовой безопасности pgp основе этого гпсч лежит тройной des генератор ansi состоит из следующих частей момент инициализации генерируется секретный ключ он должен быть случайным используется только для данного генератора на каждой стадии происходит следующее значение даты времени на начало ой стадии генерации начальное значение для ой стадии генерации псевдослучайное число созданное на ой стадии генерации ключ используемый на каждой стадии функция шифрования ключом входными случайными значениями являются выходное значение вычисление из без знания не является возможным за разумное время следовательно следующее псевдослучайное значение так как для получения дополнительно выполняются три операции шифрования аппаратные гпсч кроме устаревших хорошо известных рслос генераторов широко применявшихся качестве аппаратных гпсч xx веке очень мало известно современных аппаратных гпсч так как большинство из них разработано для военных целей или запатентованы держатся секрете аппаратно реализуемые рслос генераторы toyocrypt lili были взломаны помощью алгебраических атак настоящее время известно применении аппаратных гпсч реализуемых на основе маломощных шумов электросхемах применение гсч лотереях генератор случайных чисел для лотерей аппаратно программный комплекс применяющийся розыгрышах которых необходимо угадывать комбинацию из определенного количества чисел любое из возможных чисел имеет одинаковую вероятность появления попытки создать генератор случайных чисел относятся году до связаны настольной игрой сенет сенете два игрока играют за две стороны ходы определяются помощью плоских палочек что может считаться генератором случайных чисел того времени бросают все четыре палочки сразу подсчет очков происходит следующим образом палочка упала белой стороной вверх очко дополнительный бросок очка очка дополнительный бросок одна из сторон палочки черная если все четыре палочки падали черной стороной вверх это максимальный результат очков дополнительный бросок известный генератор случайных чисел ernie применялся на протяжении многих лет для определения выигрышных номеров британской лотереи основные требования программному обеспечению оборудованию используемому для проведения розыгрышей российской федерации устанавливаются федеральным законом от фз лотереях технические характеристики лотерейного оборудования должны обеспечивать случайность распределения выигрышей при розыгрыше призового фонда тиражных лотерей не должны использоваться процедуры реализующие алгоритмы которые позволяли бы предопределять результат розыгрыша призового фонда до начала такого розыгрыша лотерейное оборудование используемое при проведении тиражной лотереи должно обеспечивать защиту информации от утраты хищения искажения действий по ее уничтожению модификации копированию иных подобных действий доступа по сети передачи данных российских государственных лотереях гослото из гослото из гослото из гослото из гослото из спортлото из для определения победителей используются лототроны трансляция розыгрышей ведется прямом эфире российских государственных лотереях рапидо кено спортлото топ всё по сто для определения победителей используется генератор случайных чисел аппаратно программный комплекс ано миц отвечающий рекомендациям фгуп вниимс аппарат формирует непрерывный поток случайных шумов которые преобразуются числа заданный момент времени из потока выхватываются текущие значения которые являются выигрышной лотерейной комбинацией году бывшему директору по безопасности us multi state lottery association после выигрыша млн долларов имевшему доступ программному обеспечению используемому при розыгрышах лотерей было предъявлено обвинение использовании специальных алгоритмов позволяющих определять выигрышную комбинацию лотереи течение нескольких дней году см также случайное простое число регистр сдвига обратной связью по переносу тестирование псевдослучайных тест на следующий бит генератор макларена марсальи рслос аппаратный генератор случайных чисел стойкий генератор псевдослучайных чисел источник энтропии алгоритм зиккурат примечания литература ссылки cryptographic random numbers theory and practice of random number generation zvi gutterman benny pinkas tzachy reinman analysis of the linux random number generator statistical test suite for random and pseudorandom number generators for cryptographic applications nist sp категория