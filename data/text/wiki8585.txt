xslt tensible tylesheet anguage ransformations язык преобразования xml документов спецификация xslt входит состав xsl является рекомендацией при применении таблицы стилей xslt состоящей из набора шаблонов xml документу исходное дерево образуется конечное дерево которое может быть сериализовано виде xml документа xhtml документа только для xslt html документа или простого текстового файла правила выбора отчасти преобразования данных из исходного дерева пишутся на языке запросов xpath xslt имеет множество различных применений основном области веб генерации отчётов одной из задач решаемых языком xslt является отделение данных от их представления как часть общей парадигмы mvc другой стандартной задачей является преобразование xml документов из одной xml схемы другую история xslt разработан рабочей группой xsl консорциума всемирной паутины версия была одобрена качестве рекомендации ноября года после выхода первой версии начались работы над версией но году они были прекращены рабочая группа xsl присоединилась рабочей группе xquery для совместной работы над xpath впоследствии xpath послужил основой при разработке xslt версии версия была одобрена качестве рекомендации января года версия была одобрена июня года процесс выполнения xslt преобразования процессе выполнения xslt преобразования задействованы один или несколько входных xml документов одна или несколько таблиц стилей xslt xslt процессор один или несколько выходных документов простейшем случае xslt процессор получает на входе два документа входной xml документ таблицу стилей xslt создаёт на их основе выходной документ xslt xpath xslt использует язык xpath для доступа отдельным частям входного xml документа для организации вычислений xslt использует xpath xslt использует xpath примеры трансформация из xml xml исходный xml документ иван иванов пётр петров таблица xslt стилей преобразования результирующий xml документ mp иван иванов pk пётр петров трансформация из xml xhtml входной xml документ www world wide web site java java info www world wide web site validator web developers who want to get it right стиль для xslt трансформации test padding px padding width background color silver td th width border px solid silver padding px td first child th first child width table width px the following host names are currently in use at host nameurlused by xhtml который мы получаем на выходе пробелы были добавлены для ясности test padding px padding width background color silver td th width border px solid silver padding px td first child th first child width table width px sun microsystems inc the following host names are currently in use at sun com host name url used by www http www sun com world wide web site java http java sun com java info the world wide web consortium the following host names are currently in use at org host name url used by www http www org world wide web site validator http validator org web developers who want to get it right на выходе не всегда получится обязательно правильный xhtml xslt это исправлено добавлен метод вывода xhtml наряду html который уже существовал xslt применение правил шаблонов язык xslt является декларативным не процедурным вместо определения исполняемых операторов этот язык определяет правила которые будут применяться во время преобразования само преобразование ведётся по фиксированному алгоритму первую очередь xslt процессор разбирает файл преобразования строит xml дерево входного файла затем он ищет шаблон который лучше всего подходит для корневого узла вычисляет содержимое найденного шаблона инструкции каждом шаблоне могут либо напрямую говорить xslt процессору создай здесь такой то тег либо говорить обработай другие узлы по тому же правилу что корневой узел более подробно этот алгоритм чём то нетривиальный описывается ниже хотя многие из его экзотических деталей опущены каждый xslt процессор должен выполнить следующие шаги для подготовки трансформации прочитать таблицу стилей xslt помощью xml парсера перевести его содержимое дерево узлов дерево таблицы стилей согласно модели данных xpath синтаксические ошибки времени компиляции определяются на этой стадии таблицы стилей могут быть модульными поэтому все включения инструкции xsl include xsl import также будут обработаны на этой стадии целью объединить все шаблонные правила иные элементы из других таблиц стилей единое дерево таблицы стилей прочитать входные данные xml помощью xml парсера перевести его содержимое дерево узлов исходное дерево согласно модели данных xpath xml документ может ссылаться на другие xml источники помощью вызова функций document эти вызовы обычно обрабатываются во время выполнения так как их расположение может являться вычисляемым вызовы соответствующих функций могут не происходить вовсе пример выше не ссылается на какие либо другие документы удалить пустые узлы из таблицы стилей xslt кроме тех которые являются потомками от элементов xsl text это позволяет исключить появление лишних пробелов удалить пустые текстовые узлы из исходного дерева если инструкции xsl strip space присутствуют исходном документе это позволяет исключить появление лишних пробелов пример выше не использует эту возможность пополнить xslt дерево тремя правилами которые предоставляют поведение по умолчанию для любых типов узлов которые могут быть встречены при обработке первое правило для обработки корневого узла оно даёт инструкцию процессору обработать каждого потомка корневого узла второе правило для любых текстовых узлов или узлов атрибутов он даёт команду процессору сделать копию этого узла результирующем дереве третье правило для всех узлов комментария узлов инструкций обработки никакой операции не производится шаблоны явно заданные xslt могут перекрывать часть или все шаблоны правила заданные по умолчанию если шаблон не содержит явных правил встроенные правила будут применены для рекурсивного обхода исходного дерева только текстовые узлы будут скопированы результирующее дерево узлы атрибутов не будут достигнуты так как они не являются детьми их родительских узлов полученный таким образом результат обычно нежелателен так как он является просто конкатенацией всех текстовых фрагментов из исходного xml документа затем процессор проделывает следующие шаги для получения сериализации результирующего дерева создаёт корневой узел результирующего дерева обрабатывает корневой узел исходного дерева процедура обработки узла описана ниже сериализует результирующее дерево если необходимо согласно подсказкам описанным инструкцией xsl output при обработке узла производятся следующие действия производится поиск наиболее подходящего шаблона правила это достигается проверкой соответствия шаблона который является выражением xpath для каждого правила указывая узлы для которых правило может быть применено каждому шаблону процессором назначается относительный приоритет старшинство для облегчения разрешения конфликтов порядок шаблонных правил таблице стилей также может помочь разрешению конфликтов между шаблонами которые соответствуют одинаковым узлам но это не оказывает влияния на порядок котором узлы будут обрабатываться template rule contents are instantiated элементы пространстве имён xslt обычно имеющие префикс xsl трактуются как инструкции имеют специальную семантику которая указывает на то как они должны одни предназначены для добавления узлов результирующее дерево другие являются управляющими конструкциями не xslt элементы текстовые узлы обнаруженные правиле копируются дословно результирующее дерево комментарии управляющие инструкции игнорируются инструкция xsl apply templates при её обработке приводит выборке обработке нового набора узлов узлы помощью выражения xpath все узлы обрабатываются том порядке котором они содержатся исходном документе xslt расширяет библиотеку функций xpath позволяет определять xpath переменные эти переменные имеют разную область видимости таблице стилей зависимости от того где они были определены их значения могут задаваться за пределами таблицы стилей значения переменных не могут быть изменены во время обработки хотя эта процедура может показаться сложной однако она делает xslt по возможностям похожей на другие языки web шаблонов если таблица стилей состоит из единственного правила для обработки корневого узла результат просто копируется всё содержимое шаблона xslt инструкции элементы xsl заменяются вычисляемым содержимым xslt предлагает даже специальный формат literal result element as stylesheet для таких простых одношаблонных трансформаций однако возможность определять отдельные шаблоны правила сильно увеличивает гибкость эффективность xslt особенно при генерации результата который очень похож на исходный документ см также schematron xml xsl xpath xquery xsl fo exslt литература ссылки xslt рекомендация xslt рекомендация xslt рекомендация учебные материалы по xslt на zvon org выдержки из книги алексея валикова технология xslt xslt introduction and reference категория xml категория языки на основе xml категория стандарты