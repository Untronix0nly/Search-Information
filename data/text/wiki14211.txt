visa virtual instrument software architecture широко используемый интерфейс ввода вывода области тестирования измерений для управления приборами персонального компьютера поддерживает интерфейсы ieee gpib vxi rs также usb для измерительных устройств реализация visa например ni visa представляет собой библиотеку функций для языков visual basic которые унифицируют доступ ко всем измерительным устройствам независимо от используемого протокола аппаратуры например независимо от модели gpib адаптера интерфейс visa предполагает общение прибором форме запрос ответ компьютер отправляет специфичную для конкретного прибора команду запрос например требование выполнить измерение физической величины ждёт ответа например отчёт состоянии или результаты измерений от прибора интерфейс также поддерживает специфичные для шины особенности например при работе gpib общение может также быть инициировано прибором помощью прерывания для rs можно конфигурировать битрейт количество битов кадре данных visa был разработан компанией national instruments середине для автоматизации измерений помощью так называемых виртуальных приборов vi используется основном таких программных продуктах компании как labview labwindows measurement studio несмотря на то что интерфейс visa наиболее часто используется проприетарная реализация от national instruments эта библиотека может быть бесплатно скачана сайта компании после регистрации есть версии для linux mac os windows комплект библиотекой включены также несколько программных инструментов например ni spy программа для обращений библиотеке ni visa pyvisa pyvisa это обёртка для библиотеки ni visa предоставляющая интерфейс для языка python авторы библиотеки torsten bronger ахен германия gregor thalhammer иннсбрук австрия издана по свободной лицензии mit библиотека позволяет использовать всё удобство гибкость языка python для быстрой разработки систем сбора обработки данных измерительного оборудования научной лаборатории pyvisa предоставляет высокоуровневые функции для опроса приборов работы массивами данных пример использования ниже приведён пример использования pyvisa для получения спектра измерения мощности лазерного излучения приходящего оптический agilent прежде всего нужно импортировать библиотеку pyvisa коде именуется visa для каждого инструмента создаётся класс instrument котором есть методы для чтения отправки данных read write ask ask_for_values import visa visa просмотр всех доступных инструментов osa visa instrument gpib instr опрос идентификация прибора использованием стандартной команды scpi idn osa ask idn вернёт модель прибора адресом gpib osa timeout ответ от прибора ожидается до секунд получение текущего спектра виде массива переменную trace osa write calc aver stat on включаем усреднение измерений osa write calc aver coun усреднение производится по ти спектрам osa ask init opc запускаем измерение ждём его окончания после чего прибор вернёт trace osa ask_for_values trace tra получаем спектр переменную trace установка маркера мощности на спектр опрос его значения osa write calc makr max устанавливаем маркер на пик спектре power osa ask calc mark считываем значение мощности лазера wl osa ask calc mark считываем длину волны лазера см также ieee high speed lan instrument protocol hislip lan extensions for instrumentation lxi примечания ссылки страница загрузки ni visa сайт проекта pyvisa руководство по pyvisa категория ввод вывод категория автоматизация