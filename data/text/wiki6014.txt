network file system nfs протокол сетевого доступа файловым системам первоначально разработан sun microsystems году за основу взят протокол вызова удалённых процедур onc rpc позволяет подключать монтировать удалённые файловые системы через сеть nfs абстрагирован от типов файловых систем как сервера так клиента существует множество реализаций nfs серверов клиентов для различных операционных систем аппаратных архитектур наиболее зрелая версия nfs поддерживающая различные средства аутентификации частности kerberos lipkey использованием протокола rpcsec gss списки контроля доступа как posix так windows типов nfs предоставляет клиентам прозрачный доступ файлам файловой системе сервера отличие от ftp протокол nfs осуществляет доступ только тем частям файла которым обратился процесс основное достоинство его том что он делает этот доступ прозрачным это означает что любое приложение клиента которое может работать локальным файлом таким же успехом может работать nfs файлом без каких либо модификаций самой программы nfs клиенты получают доступ файлам на nfs сервере путём отправки rpc запросов на сервер это может быть реализовано использованием обычных процессов именно nfs клиент может быть процессом который осуществляет конкретные rpc вызовы на сервер который так же может быть процессом важной частью последней версии стандарта nfs стала спецификация pnfs нацеленная на обеспечение реализации общего доступа файлам увеличивающая скорость передачи данных пропорционально размерам степени параллелизма системы цели разработки изначальными требованиями при разработке nfs были потенциальная поддержка различных операционных систем не только unix чтобы серверы клиенты nfs возможно было бы реализовать разных операционных системах протокол не должен зависеть от каких либо определённых аппаратных средств должны быть реализованы простые механизмы восстановления случае отказов сервера или клиента приложения должны иметь прозрачный доступ удаленным файлам без использования специальных путевых имён или библиотек без перекомпиляции для unix клиентов должна поддерживаться семантика unix nfs должна быть сравнима локальных дисков реализация не должна быть зависимой от транспортных средств компоненты nfs реализация nfs состоит из нескольких компонентов некоторые из них локализованы либо на сервере либо на клиенте некоторые используются на обеих сторонах соединения некоторые компоненты не требуются для обеспечения основных функциональных возможностей но составляют часть расширенного интерфейса nfs протокол nfs определяет набор запросов операций которые могут быть направлены клиентом серверу также набор аргументов возвращаемые значения для каждого из этих запросов версия этого протокола существовала только недрах sun microsystems никогда не была выпущена все реализации nfs том числе nfsv поддерживают версию nfs nfsv которая впервые была выпущена году sunos версия протокола была опубликована году реализована некоторыми фирмами поставщиками протокол удаленного вызова процедур rpc определяет формат всех взаимодействий между клиентом сервером каждый запрос nfs посылается как пакет rpc внешнее представление данных xdr external data representation обеспечивает машинно независимый метод кодирования данных для пересылки через сеть все запросы rpc используют кодирование xdr для передачи данных следует отметить что xdr rpc используются для реализации многих других сервисов помимо nfs программный код сервера nfs отвечает за обработку всех запросов клиента обеспечивает доступ экспортируемым файловым системам программный код клиента nfs реализует все обращения клиентской системы удаленным файлам путём посылки серверу одного или нескольких запросов rpc протокол монтирования определяет семантику монтирования размонтирования файловых систем nfs nfs использует несколько фоновых процессов демонов на сервере набор демонов nfsd ожидает запросов клиентов nfs отвечает на них демон mountd обрабатывает запросы монтирования на клиенте набор демонов biod обрабатывает асинхронный ввод вывод блоков файлов nfs менеджер блокировок сети nlm network lock manager монитор состояния сети nsm network status monitor вместе обеспечивают средства для блокировки файлов сети эти средства хотя формально не связаны nfs можно найти большинстве реализаций nfs они обеспечивают сервисы не возможные базовом протоколе nlm nsm реализуют сервера помощью демонов lockd statd соответственно версии первая версия применялась только для внутреннего использования sun целях версия nfsv выпущена марте года первоначально полностью работала по протоколу udp разработчики решили не хранить данных внутреннем состоянии внутри протокола как пример блокировка реализованная вне базового протокола люди вовлечённые создание nfs версии расти сэндберг rusty sandberg боб лайон bob lyon билл джой стив клейман steve kleiman nfsv вышла июне года ней добавлена поддержка дескрипторов файлов переменного размера до байт версии массив фиксированного размера байта снято ограничение на байта rpc вызовах чтения записи тем самым размер передаваемого блока вызовах ограничен только пределом для udp датаграммы байт реализована поддержка файлов больших размеров поддержаны асинхронные вызовы операций записи процедурам read write добавлены вызовы access проверка прав доступа файлу mknod создание специального файла unix readdirplus возвращает имена файлов директории вместе их атрибутами fsinfo возвращает статистическую информацию файловой системе fsstat возвращает динамическую информацию файловой системе pathconf возвращает posix информацию файле commit передает ранее сделанные асинхронные записи на постоянное хранение на момент введения версии отмечен рост популярности среде разработчиков протокола tcp некоторые независимые разработчики самостоятельно добавили поддержку протокола tcp для nfs версии качестве транспортного sun microsystems добавили поддержку tcp nfs одном из дополнений версии поддержкой tcp повысились практическая осуществимость использования nfs глобальных сетях nfsv выпущена декабре года под влиянием afs cifs неё включены улучшения безопасности версия стала первой версией разработанной совместно internet engineering task force ietf nfs версии была одобрена iesg январе года новая спецификация объёмом страниц стала известна как самый длинный документ одобренный ietf важным нововведением версии является спецификация pnfs parallel nfs механизма параллельного доступа nfs клиента данным множества распределенных nfs серверов наличие такого механизма стандарте сетевой файловой системы поможет строить распределённые облачные хранилища информационные системы другие модули webnfs это расширение для nfs версий которое позволяют легче интегрироваться веб браузеры дает возможность работы через брандмауэр различные сторонние протоколы стали ассоциироваться nfs том числе менеджер блокировок сети nlm network lock manager монитор состояния сети nsm network status monitor вместе обеспечивают средства для блокировки файлов сети эти средства хотя формально не связаны nfs можно найти большинстве реализаций nfs они обеспечивают сервисы невозможные базовом протоколе nlm nsm реализуют сервера помощью демонов lockd statd соответственно протокол удалённой информации квотах rquotad nfs позволяет пользователям просматривать дисковую квоту на удалённом nfs сервере платформы хотя nfs чаще всего используют unix подобных системах данный протокол можно также использовать на других операционных системах таких как mac os classic openvms microsoft windows novell netware ibm число альтернативных протоколов удаленного доступа файлам входят server message block smb также известный как cifs протокол apple filing protocol afp netware core protocol ncp под операционной системой microsoft windows smb netware core protocol ncp используется чаще чем nfs системах macintosh afp встречается чаще чем nfs типичные настройки nfs клиента nfs сервера для клиента одинаково представлены локальные nfs файлы ядро определяет когда файл открыт nfs клиент отправляет rpc запросы nfs серверу через стек tcp ip nfs обычно использует udp однако более новые реализации могут использовать tcp nfs сервер получает запросы от клиента виде udp датаграмм на порт несмотря на то что nfs может работать портов что позволяет серверу использовать динамически назначаемые порты udp порт жёстко закреплён за nfs большинстве реализаций когда nfs сервер получает запрос от клиента он передается локальной подпрограмме доступа файлу которая обеспечивает доступ локальному диску на сервере серверу может потребоваться время для того чтобы обработать запросы клиента даже доступ локальной файловой системе может занять некоторое время течение этого времени сервер не хочет блокировать запросы от других клиентов которые также должны быть обслужены чтобы справиться подобной ситуацией большинство nfs серверов запускаются несколько раз то есть внутри ядра существует несколько nfs серверов конкретные методы решения зависят от операционной системы большинстве ядер unix систем не используется несколько nfs серверов вместо этого запускается несколько процессов которые обычно называются nfsd которые осуществляют один системный вызов остаются внутри ядра качестве процесса ядра точно так же nfs клиенту требуется время чтобы обработать запрос от процесса на узле клиента rpc выдается на узел сервера после чего ожидается отклик для того чтобы процессы на узле клиента могли любой момент воспользоваться nfs существует несколько nfs клиентов запущенных внутри ядра клиента конкретная реализация также зависит от операционной системы unix система обычно использует технику напоминающую nfs сервер процесс называемый biod осуществляет один единственный системный вызов остаётся внутри ядра как процесс ядра большинство unix узлов может функционировать как nfs клиент как nfs сервер большинство мейнфреймов ibm предоставляет только функции nfs сервера см также kerberos network information service samba server message block secure shell filesystem sshfs nfs lan примечания ссылки network file system version ietf wiki linux nfs org стандарты rfc nfs network file system protocol specification march rfc nfs version protocol specification june rfc nfs url scheme rfc an agreement between the internet society the ietf and sun microsystems inc in the matter of nfs protocols rfc nfs version and version security issues and the nfs protocol use of rpcsec_gss and kerberos rfc nfs version design considerations rfc nfs version protocol rfc network file system nfs version protocol rfc network file system nfs version minor version protocol категория сетевые файловые системы категория файловые системы sun категория интернет протоколы