это оптимальный маршрут коммивояжёра через крупнейших городов германии указанный маршрут является самым коротким из всех возможных вариантов задача коммивояжёра сокращённо tsp одна из самых известных задач комбинаторной оптимизации заключающаяся поиске самого выгодного маршрута проходящего через указанные города хотя бы по одному разу последующим возвратом исходный город условиях задачи указываются критерий выгодности маршрута кратчайший самый дешёвый совокупный критерий тому подобное соответствующие матрицы расстояний стоимости тому подобного как правило указывается что маршрут должен проходить через каждый город только один раз таком случае выбор осуществляется среди гамильтоновых циклов существует несколько частных случаев общей постановки задачи частности геометрическая задача коммивояжёра также называемая планарной или евклидовой когда матрица расстояний отражает расстояния между точками на плоскости метрическая задача коммивояжёра когда на матрице стоимостей выполняется неравенство треугольника симметричная асимметричная задачи коммивояжёра также существует обобщение задачи так называемая обобщённая задача коммивояжёра оптимизационная постановка задачи относится классу np трудных задач впрочем как большинство её частных случаев версия decision problem то есть такая которой ставится вопрос существует ли маршрут не длиннее чем заданное значение относится классу np полных задач задача коммивояжёра относится числу уже при относительно небольшом числе городов более она не может быть решена методом перебора вариантов никакими теоретически мыслимыми компьютерами за время меньшее нескольких миллиардов лет история точно неизвестно когда проблему коммивояжера исследовали впервые однако известна изданная году книга названием коммивояжёр как он должен вести себя что должен делать для того чтобы доставлять товар иметь успех своих делах советы старого курьера которой описана проблема но математический аппарат для её решения не применяется зато ней предложены примеры маршрутов для некоторых регионов германии швейцарии ранним вариантом задачи может рассматриваться уильяма гамильтона века которая заключалась том чтобы найти маршруты на графе узлами первые упоминания качестве математической задачи на оптимизацию принадлежат карлу менгеру который сформулировал её на математическом коллоквиуме году так гамильтон уильям роуэн вскоре появилось известное сейчас название задача странствующего торговца которую предложил хасслер уитни из принстонского университета вместе простотой определения сравнительной простотой нахождения хороших решений задача коммивояжёра отличается тем что нахождение действительно оптимального пути является достаточно сложной задачей учитывая эти свойства начиная со второй половины xx века исследование задачи коммивояжёра имеет не столько практический смысл сколько теоретический качестве модели для разработки новых алгоритмов оптимизации многие современные методы дискретной оптимизации такие как метод отсечений ветвей границ различные варианты эвристических алгоритмов были разработаны на примере задачи коммивояжёра годы задача коммивояжёра привлекла внимание ученых сша европе важный вклад исследование задачи принадлежит джорджу данцигу делберту рею фалкерсону селмеру джонсону которые году институте rand corporation сформулировали задачу виде задачи дискретной оптимизации применили для её решения метод отсечений используя этот метод они построили путь коммивояжёра для одной частной постановки задачи городами обосновали его оптимальность годы задача изучалась многими учеными как теоретически так точки зрения её приложений информатике экономике химии биологии ричард карп году доказал np полноту задачи поиска гамильтоновых путей из чего благодаря полиномиальной сводимости вытекала np трудность задачи коммивояжёра на основе этих свойств им было приведено теоретическое обоснование сложности поиска решений задачи на практике больших успехов удалось достичь конце годах когда мартин грётчел манфред падберг джованни ринальди другие применением новых методов деления плоскостью ветвей границ вычислили решение для отдельного случая задачи городами годы дэвид аплгейт роберт биксби вашека шватал уильям кук установили рекорды по программе конкорд герхард райнельт создал tsplib набор экземпляров задачи коммивояжёра различной степени сложности для сравнения результатов работы различных групп исследователей марте года задача узлами была решена программой конкорд был вычислен путь длиной доказано отсутствие более коротких путей апреле было найдено решение для экземпляра узлами используя методы декомпозиции можно вычислить решения для случаев задачи миллионами узлов длина которых менее чем на больше оптимальной формальное определение представление виде графа симметричная задача для четырёх городов для возможности применения математического аппарата для решения проблемы её следует представить виде математической модели проблему коммивояжёра можно представить виде модели на графе то есть используя вершины ребра между ними таким образом вершины графа соответствуют городам рёбра между вершинами пути сообщения между этими городами каждому ребру можно сопоставить критерий выгодности маршрута который можно понимать как например расстояние между городами время или стоимость поездки гамильтоновым циклом называется маршрут включающий ровно по одному разу каждую вершину графа целях упрощения задачи гарантии существования маршрута обычно считается что модельный граф задачи является полностью связным то есть что между произвольной парой вершин существует ребро тех случаях когда между отдельными городами не существует сообщения этого можно достичь путём ввода рёбер максимальной длиной из за большой длины такое ребро никогда не попадет оптимальному маршруту если он существует таким образом решение задачи коммивояжёра это нахождение гамильтонова цикла минимального веса полном взвешенном графе зависимости от того какой критерий выгодности маршрута сопоставляется величине ребер различают различные варианты задачи важнейшими из которых являются симметричная метрическая задачи асимметричная симметричная задачи общем случае асимметричная задача коммивояжёра отличается тем что она моделируется ориентированным графом таким образом следует также учитывать каком направлении находятся ребра случае симметричной задачи все пары ребер между одними теми же вершинами имеют одинаковую длину то есть для ребра одинаковы длины симметричном случае количество возможных маршрутов вдвое меньше асимметричного случая симметричная задача моделируется графом см рисунок на самом деле задача коммивояжёра случае реальных городов может быть как симметричной так асимметричной зависимости от длительности или длины маршрутов от направления движения метрическая задача симметричную задачу коммивояжёра называют метрической если относительно длин ребер выполняется неравенство треугольника условно говоря таких задачах обходные пути длиннее прямых то есть ребро от вершины до вершины никогда не бывает длиннее пути через промежуточную вершину такое свойство длины ребер определяет измеримое пространство на множестве ребер меру расстояния удовлетворяющую интуитивному пониманию расстояния на практике функции расстояния являются также метриками удовлетворяют неравенству треугольника евклидово расстояние евклидовой задаче коммивояжёра манхэттенская метрика также квартальная метрика прямоугольной задачи коммивояжёра которой расстояние между вершинами на решетке равно сумме расстояний по оси ординат абсцисс максимальная метрика определяющая расстояние между вершинами решетчатого графа как максимальное значение расстояния вдоль оси ординат абсцисс две последние метрики находят применение например при сверлении отверстий печатных платах когда станок должен сделать больше отверстий за наименьшее время может перемещать сверло обоих направлениях для перехода от одного отверстия следующему манхэттенская метрика соответствует случаю когда передвижение обоих направлениях происходит последовательно максимальная случаю когда передвижение обоих направлениях происходит синхронно общее время равно максимальному времени передвижения вдоль оси ординат или абсцисс неметрическая задача коммивояжёра может возникать например случае минимизации длительности пребывания при наличии выбора транспортных средств различных направлениях таком случае обходной путь самолетом может быть короче прямого сообщения автомобилем если на практике условиях задачи разрешается посещать города несколько раз то симметричную задачу можно свести метрической для этого задачу рассматривают на так называемом графе расстояний этот граф имеет такое же множество вершин как исходный является полностью связным длина рёбер между вершинами на графе расстояний соответствует длине кратчайшего расстояния между вершинами исходном графе для определенных таким образом длин выполняется неравенство треугольника каждому маршруту на графе расстояний всегда соответствует маршрут возможными повторениями вершин исходном графе формулировка виде задачи дискретной оптимизации одним из подходов решению задачи является формулировка её виде задачи дискретной оптимизации при этом решения представляются виде переменных связи виде отношений неравенства между ними таким образом возможно несколько вариантов например симметричную задачу можно представить виде множества ребер каждому ребру сопоставляется двоичная переменная равная если ребро принадлежит маршруту противном случае произвольный маршрут можно представить виде значений множества переменных принадлежности но не каждое такое множество определяет маршрут условием того что значения множества переменных определяют маршрут являются описанные далее линейные неравенства условие кратности каждая вершина должна иметь одно входное одно выходное ребро маршрута каждая вершина должна сообщаться через пару ребер остальным вершинам то есть через входное выходное ребро сумме каждое слагаемое равно или принадлежит маршруту или не принадлежит то есть полученная сумма равна количеству ребер маршруте имеющих вершину на одном из концов она равна так как каждая вершина имеет входное выходное ребро приведенном рядом рисунке вершина показана входным выходными ребрами ребра маршрута обозначены толстыми линиями рядом ребрами указаны длины прилагаемые указанной выше сумме циклы переменные удовлетворяют условию кратности но не определяют маршрут описанные ранее условия кратности выполняются не только маршрутами но значениями переменных соответствующих отдельным циклам где каждая вершина принадлежит лишь одному циклу см рисунок чтобы избежать подобных случаев должны выполняться так называемые неравенства циклов или условия устранения подмаршрутов которые были определены данцигом фалкерсоном джонсоном году под названием условия петель этими неравенствами определялось дополнительное условие того что каждое множество вершин является либо пустым либо содержит все вершины сочетающееся остальным вершинам через минимум два ребра для всех множеств вершин где эта сумма равна сумме длин ребер маршрута между вершиной вершиной чтобы устранить лишние неравенства можно ограничиться множествами вершин минимум двумя максимум вершинами на рисунке рядом ребра длинами обозначены толстыми линиями остальные ребра имеют длину введение дополнительных условий для множества вершин состоящего из трех левых вершин будет гарантировать что сочетается через минимум два ребра маршрута тремя вершинами справа чтобы устранить оба цикла количество неравенств устранения циклов согласно данцигу фалкерсону джонсону равняется году миллер такер землин изобрели альтернативные условия устранения подмаршрутов путём введения новых переменных определяющих порядок посещенных городов требующих только дополнительных неравенств более того из за двойственности формулировках миллера такера землина задача коммивояжёра остается np сложной так каждый вектор элементами равными удовлетворяющий всем неравенствам определяет корректный маршрут который является решением задачи коммивояжёра вычислить поскольку переменные имеют значения только сумма равна общей длине ребер принадлежащих маршруту количество неравенств типа растет экспоненциально по мере увеличения количества городов поскольку почти каждое из подмножеств узлов определяет одно неравенство эту проблему можно решить применением метода отсечения плоскостью благодаря которому неравенства добавляются только когда эти неравенства действительно необходимы геометрической точки зрения линейные неравенства можно представить как гиперплоскости пространстве переменных множество векторов удовлетворяющих этим неравенствам образуют таком пространстве политоп многомерный многогранник или многомерный многоугольник точная форма определяется длинами является основном неизвестной однако можно показать что условия определяют грани фацет политопа то есть боковые поверхности политопа наивысшей размерностью поэтому они относятся самым сильным линейным неравенствам которые могут описывать маршрут также существует много разных граней определяемых неравенствами известными лишь немногих случаях хотя вместе ограничениями полностью моделируют проблему только для двоичных векторов эти неравенства могут использоваться методе ветвей границ чтобы отбросить решения методами линейной оптимизации нецелыми координатами см раздел точные методы ниже алгоритмическая сложность поскольку коммивояжёр каждом из городов встает перед выбором следующего города из тех что он ещё не посетил существует маршрутов для асимметричной маршрутов для симметричной задачи коммивояжёра таким образом размер пространства поиска зависит экспоненциально от количества городов различные варианты задачи коммивояжёра метрическая симметричная асимметричная np эквивалентны согласно но недоказанной гипотезе неравенстве классов сложности np не существует машины тьюринга способной находить решения экземпляров задачи за полиномиальное время зависимости от количества городов также известно что при условии не существует алгоритма который для некоторого полинома вычислял бы такие решения задачи коммивояжёра которые отличались бы от оптимального максимум на коэффициент на практике поиск строго оптимального маршрута требуется не всегда существуют алгоритмы поиска приближенных решений для метрической задачи за полиномиальное время нахождения маршрута максимум вдвое длиннее оптимального до сих пор не известен ни один алгоритм полиномиальным временем который бы гарантировал точность лучшую чем от оптимальной по предположению существует неизвестная константа такая что ни один алгоритм полиномиальным временем не может гарантировать точность как было показано арора для евклидовой задачи коммивояжёра существует схема полиномиального времени ptas для поиска приближённого решения кроме того данные могут иметь особенности которые могут помочь решить задачу например города расположены не случайно по рельефу местности либо даже вдоль уже давно найденного оптимального торгового маршрута дополнительная информация эвристики позволяют за приемлемое время находить приемлемые решения замкнутый незамкнутый варианты задачи замкнутом варианте задачи коммивояжёра требуется посетить все вершины графа после чего вернуться исходную вершину незамкнутый вариант отличается от замкнутого тем что нём не требуется возвращаться стартовую вершину незамкнутый вариант задачи сводится замкнутому путём замены весов дуг входящих стартовую вершину на число оптимальный замкнутый маршрут коммивояжёра таком графе соответствует оптимальному незамкнутому маршруту исходном графе чтобы свести замкнутый вариант незамкнутому нужно определить число строго превосходящее вес любого маршрута коммивояжёра заданном графе например качестве можно взять сумму максимальных по весу дуг выходящих из каждой вершины увеличенную на затем нужно добавить графу новую вершину предполагаем что вершины исходного графа пронумерованы числами от до при этом стартовая вершина имеет номер стоимости дуг выходящих входящих вершину определяются следующим образом при от до оптимальный незамкнутый маршрут коммивояжёра таком графе соответствует оптимальному замкнутому маршруту коммивояжёра исходном графе имеет стоимость на больше методы решения простейшие полный перебор случайный перебор жадные алгоритмы метод ближайшего соседа метод включения ближайшего города метод самого дешёвого включения метод минимального остовного дерева метод имитации отжига все эффективные сокращающие полный перебор методы решения задачи коммивояжёра методы эвристические большинстве эвристических методов находится не самый эффективный маршрут приближённое решение зачастую востребованы так называемые any time алгоритмы то есть постепенно улучшающие некоторое текущее приближенное решение существуют также постановки которых задача коммивояжёра становится np полной обычно такие постановки выглядят следующим образом существует ли на заданном графе такой обход что его стоимость не превышает часто на ней проводят обкатку новых подходов эвристическому сокращению полного перебора на практике применяются различные модификации более эффективных методов метод ветвей границ метод генетических алгоритмов также алгоритм муравьиной колонии метод ветвей границ можно найти точное решение задачи коммивояжёра то есть вручную вычислить длины всех возможных маршрутов выбрать маршрут наименьшей длиной однако даже для небольшого количества городов решать задачу таким способом практически невозможно для простого варианта симметричной задачи городами существует возможных маршрутов то есть для городов существует миллиарда маршрутов для городов уже триллионов то как стремительно растет вычислений можно показать на следующем примере если бы существовало устройство находящее решение для городов за час то для двух дополнительных городов требуется тысячу раз больше времени то есть более чем суток задача коммивояжёра для трех городов красная пунктирная плоскость отсекает все недопустимые решения максимум одним ребром все точки красном политопе удовлетворяют этому неравенству единственная допустимая точка это методы дискретной оптимизации частности ветвей границ позволяют находить оптимальные или приблизительные решения для достаточно больших задач геометрической интерпретации эти методы рассматривают задачу как выпуклый политоп то есть многомерный многоугольник мерном единичном кубе где равно количеству ребер графе каждое ребро этого единичного куба соответствует маршруту то есть вектору элементами что удовлетворяет описанным выше линейным неравенствам гиперплоскости описываемые этими неравенствами отсекают такие ребра единичного куба которые не соответствуют ни одному маршруту на рисунке рядом показано применение метода для задачи тремя узлами соответствие трем возможным ребрам между вершинами сопоставляются бинарные переменные этом случае существует лишь один возможный маршрут именно тот что проходит через три вершины этот маршрут удовлетворяет неравенству которое утверждает что маршрут должен проходить через минимум две вершины кроме этого маршрута что соответствует вектору неравенству удовлетворяют также все точки отмеченной красным части этого неравенства плоскости проходящие через красные линии отсекают все углы отвечающие несуществующим маршрутам максимум одним ребром именно ноль вектор единичные векторы сильное неравенство отсечет от единичного куба все кроме единственной допустимой точки этом отдельном случае тот же эффект можно получить тремя неравенствами типа для определения допустимого ребра наименьшей длиной следует решить наборы задач линейной оптимизации отсекающие секущими плоскостями ненужные части единичного куба попытаться разделить единичный куб на меньшие политопы методом ветвей границ однако этого метода для быстрого поиска маршрутов обычно недостаточно основное преимущество точных методов заключается том что имея достаточно времени они вычисляют кратчайший маршрут имея нижнюю границу для оптимальных решений можно оценить то насколько отличается найденный маршрут от оптимального например имея нижнюю границу на уровне после нахождения маршрута длиной оптимальный маршрут может находиться пределах от до так называемый интервал оптимальности или максимальное относительное расстояние между длиной оптимального маршрута кратчайшим известным маршрутом составит то есть длина найденного маршрута максимум на отличается от оптимальной когда длина вычисленного маршрута равна длине предыдущего считается что найденное решение является оптимальным для поиска маршрутов приемлемой длины точные методы могут комбинироваться эвристическими метод ветвей границ для решения задачи коммивояжёра был предложен году группой авторов дж литл мурти суини кэрол метод эластичной сети история году его использовали дурбин durbin уиллшоу willshaw указавшие аналогию механизмами установления упорядоченных нейронных связей каждый из маршрутов коммивояжёра рассматривался как отображение окружности на плоскость каждый город на плоскости отображается некоторая точка этой окружности соседние точки на окружности должны отображаться точки по возможности ближайшие на плоскости алгоритм начинается установки на плоскость небольшой окружности она неравномерно расширяется становясь кольцом проходящим практически около всех городов устанавливая таким образом искомый маршрут на каждую движущуюся точку кольца оказывает действие две составляющие перемещение точки сторону ближайшего города смещение сторону соседей точки на кольце так чтобы уменьшить его длину город итоге связывается определенным участком кольца по мере расширения по мере расширения такой эластичной сети каждый город оказывается ассоциирован определенным участком кольца вначале все города оказывают приблизительно одинаковое влияние на каждую точку маршрута последующем большие расстояния становятся менее влиятельными каждый город становится более специфичным для ближайших нему точек кольца такое постепенное увеличение специфичности которое напоминает метод обучения сети кохонена контролируется значением некоторого эффективного радиуса дурбин уиллшоу показали что для задачи городами рассмотренной хопфилдом танком метод эластичной сети генерирует наикратчайший маршрут примерно за итераций для городов найденный этим методом маршрут лишь на превосходил оптимальный муравьиный алгоритм генетический алгоритм алгоритм динамического основная идея заключается вычислении запоминании пути от исходного города до каждого из остальных городов затем суммирования этой величины путем из каждого из остальных городов до оставшихся городов преимущество данного метода перед методом полного перебора заключается существенном сокращении полного объема вычислений за счет заметного увеличения объема памяти см также граф математика оптимизация комбинаторика исследование операций математическое дискретная математика транспортная логистика проблема штейнера примечания литература категория теория графов категория комбинаторика категория np полные задачи категория гамильтоновы пути циклы категория исследование операций