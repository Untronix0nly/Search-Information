алгоритм соединения вложенными циклами nested loops join разновидность алгоритма соединения общее представление об алгоритме общем случае алгоритм получает на вход таблиц условия соединения результатом его работы является набор строк результатами соединения упрощая до двух таблиц алгоритм можно описать следующим образом для каждой строки одной из таблиц ведущей выполняется поиск другой таблице ведомой строк соответствующих условию соединения самом общем случае это постепенное построение декартова произведения исходных таблиц анализом условия соединения для каждой из комбинаций строк на псевдокоде это можно записать так для каждой строки из ведущая таблица для каждой строки из ведомая таблица если условие соединения вывести если для ведомой таблицы есть индекс применимый для выбранного условия соединения то соединение можно осуществить значительно более эффективно на псевдокоде это можно выразить так для каждой строки из ведущая таблица вывести искатьпоиндексу ведомая таблица условие соединения подробное описание алгоритма алгоритм состоит из произвольного числа вложенных итераций поиска данных каждой из соединяемых таблиц внешним циклом выполняется поиск строк ведущей таблице если часть или все ограничения для ведущей таблицы могут быть использованы для поиска по индексу то на каждой итерации цикла индексе ищутся расположения всех необходимых строк выполняется прямой доступ таблице противном случае таблица сканируется целиком оставшиеся ограничения используются для фильтрации выбранных строк для каждой оставшейся строки вызывается внутренний цикл внутренний цикл по условиям соединения данным внешнего цикла ищет строки ведомой таблице если часть или все ограничения для ведомой таблицы вместе ограничениями полученными от внешнего цикла могут быть использованы для поиска по индексу то на каждой итерации цикла индексе ищутся расположения всех необходимых строк выполняется прямой доступ ведомой таблице противном случае таблица сканируется целиком оставшиеся ограничения используются для фильтрации выбранных строк на каждой итерации самого глубокого цикла выбранные из таблиц строки конкатенируются для получения строк итогового результата общем случае циклы могут вкладываться произвольное число раз зависимости от числа таблиц участвующих соединении если некотором цикле выполняется поиск по индексу всех колонок индексе достаточно для получения итогового результата то прямой доступ таблице этом цикле не выполняется преимущества самый общий поэтому незаменимый алгоритм соединения при помощи соединения вложенными циклами можно реализовать любое условие соединения остальные алгоритмы имеют ограничения по реализуемым их помощью условиям соединения например когда условие выражается неравенством самый быстрый алгоритм если необходимо получить только первую строку результата например sql выражениях типа exists при использовании поиска по индексу алгоритм лучше всех масштабируется то есть при увеличении объёма данных соединяемых таблицах время выполнения запроса увеличивается практически линейно при тех же аппаратных ресурсах недостатки самый медленный алгоритм все остальные алгоритмы имеют преимущество скорости но только строго определённых обстоятельствах впрочем некоторые авторы указывают что проигрыш скорости на реальных системах по сравнению другими алгоритмами крайне несущественен см также оптимизация запросов план выполнения запроса ссылки craig freedman материалы статьи nested loops join категория субд